define("974a7777-0990-4136-8fa6-95d80114c2e0_1.6.0", ["@microsoft/sp-core-library","@microsoft/decorators","@microsoft/sp-diagnostics","react","@microsoft/sp-lodash-subset","@microsoft/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@microsoft/sp-component-base","react-dom","@ms/sp-telemetry","resx-strings","@ms/sp-load-themed-styles","@microsoft/sp-loader","@microsoft/sp-http","@microsoft/sp-page-context"], function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__, __WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_10__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_20__, __WEBPACK_EXTERNAL_MODULE_21__, __WEBPACK_EXTERNAL_MODULE_22__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	var parentJsonpFunction = window["webpackJsonp974a7777_0990_4136_8fa6_95d80114c2e0_1_6_0"];
/******/ 	window["webpackJsonp974a7777_0990_4136_8fa6_95d80114c2e0_1_6_0"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [], result;
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 	};
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// objects to store loaded and loading chunks
/******/ 	var installedChunks = {
/******/ 		3: 0
/******/ 	};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var installedChunkData = installedChunks[chunkId];
/******/ 		if(installedChunkData === 0) {
/******/ 			return new Promise(function(resolve) { resolve(); });
/******/ 		}
/******/
/******/ 		// a Promise means "currently loading".
/******/ 		if(installedChunkData) {
/******/ 			return installedChunkData[2];
/******/ 		}
/******/
/******/ 		// setup Promise in chunk cache
/******/ 		var promise = new Promise(function(resolve, reject) {
/******/ 			installedChunkData = installedChunks[chunkId] = [resolve, reject];
/******/ 		});
/******/ 		installedChunkData[2] = promise;
/******/
/******/ 		// start chunk loading
/******/ 		var head = document.getElementsByTagName('head')[0];
/******/ 		var script = document.createElement('script');
/******/ 		script.type = 'text/javascript';
/******/ 		script.charset = 'utf-8';
/******/ 		script.async = true;
/******/ 		script.timeout = 120000;
/******/
/******/ 		if (__webpack_require__.nc) {
/******/ 			script.setAttribute("nonce", __webpack_require__.nc);
/******/ 		}
/******/ 		script.src = __webpack_require__.p + "" + chunkId + "." + ({}[chunkId]||chunkId) + "_" + {"0":"8da54e31b48c6434786e","1":"c09b5c2977859c99a006","2":"b3c0139c37a394fdb551"}[chunkId] + ".js";
/******/ 		var timeout = setTimeout(onScriptComplete, 120000);
/******/ 		script.onerror = script.onload = onScriptComplete;
/******/ 		function onScriptComplete() {
/******/ 			// avoid mem leaks in IE.
/******/ 			script.onerror = script.onload = null;
/******/ 			clearTimeout(timeout);
/******/ 			var chunk = installedChunks[chunkId];
/******/ 			if(chunk !== 0) {
/******/ 				if(chunk) {
/******/ 					chunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));
/******/ 				}
/******/ 				installedChunks[chunkId] = undefined;
/******/ 			}
/******/ 		};
/******/ 		head.appendChild(script);
/******/
/******/ 		return promise;
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	// Set the webpack public path
/******/ 	(function () {
/******/ 	  var scripts = document.getElementsByTagName('script');
/******/ 	  var regex = (typeof spScriptNamePattern !== 'undefined') ? spScriptNamePattern : new RegExp('sp-webpart-base_?[a-zA-Z0-9-_]*.js', 'i');
/******/ 	  var publicPath;
/******/ 	
/******/ 	  if (scripts && scripts.length) {
/******/ 	    for (var i = 0; i < scripts.length; i++) {
/******/ 	      if (!scripts[i]) continue;
/******/ 	      var path = scripts[i].getAttribute('src');
/******/ 	      if (path && path.match(regex)) {
/******/ 	        publicPath = path.substring(0, path.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	
/******/ 	  if (!publicPath) {
/******/ 	    for (var global in window.__setWebpackPublicPathLoaderSrcRegistry__) {
/******/ 	      if (global && global.match(regex)) {
/******/ 	        publicPath = global.substring(0, global.lastIndexOf('/') + 1);
/******/ 	        break;
/******/ 	      }
/******/ 	    }
/******/ 	  }
/******/ 	  __webpack_require__.p = publicPath;
/******/ 	})();
/******/ 	
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 16);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["c"] = __extends;
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return __assign; });
/* harmony export (immutable) */ __webpack_exports__["d"] = __rest;
/* harmony export (immutable) */ __webpack_exports__["b"] = __decorate;
/* unused harmony export __param */
/* unused harmony export __metadata */
/* unused harmony export __awaiter */
/* unused harmony export __generator */
/* unused harmony export __exportStar */
/* unused harmony export __values */
/* unused harmony export __read */
/* unused harmony export __spread */
/* unused harmony export __await */
/* unused harmony export __asyncGenerator */
/* unused harmony export __asyncDelegator */
/* unused harmony export __asyncValues */
/* unused harmony export __makeTemplateObject */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = Object.setPrototypeOf ||
    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = Object.assign || function __assign(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = y[op[0] & 2 ? "return" : op[0] ? "throw" : "next"]) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [0, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; }; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator];
    return m ? m.call(o) : typeof __values === "function" ? __values(o) : o[Symbol.iterator]();
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};


/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PropertyPaneFieldType; });
var PropertyPaneFieldType;
(function (PropertyPaneFieldType) {
    PropertyPaneFieldType[PropertyPaneFieldType["Custom"] = 1] = "Custom";
    PropertyPaneFieldType[PropertyPaneFieldType["CheckBox"] = 2] = "CheckBox";
    PropertyPaneFieldType[PropertyPaneFieldType["TextField"] = 3] = "TextField";
    PropertyPaneFieldType[PropertyPaneFieldType["Toggle"] = 5] = "Toggle";
    PropertyPaneFieldType[PropertyPaneFieldType["Dropdown"] = 6] = "Dropdown";
    PropertyPaneFieldType[PropertyPaneFieldType["Label"] = 7] = "Label";
    PropertyPaneFieldType[PropertyPaneFieldType["Slider"] = 8] = "Slider";
    PropertyPaneFieldType[PropertyPaneFieldType["Heading"] = 9] = "Heading";
    PropertyPaneFieldType[PropertyPaneFieldType["ChoiceGroup"] = 10] = "ChoiceGroup";
    PropertyPaneFieldType[PropertyPaneFieldType["Button"] = 11] = "Button";
    PropertyPaneFieldType[PropertyPaneFieldType["HorizontalRule"] = 12] = "HorizontalRule";
    PropertyPaneFieldType[PropertyPaneFieldType["Link"] = 13] = "Link";
    PropertyPaneFieldType[PropertyPaneFieldType["DynamicField"] = 14] = "DynamicField";
    PropertyPaneFieldType[PropertyPaneFieldType["DynamicTextField"] = 15] = "DynamicTextField";
    PropertyPaneFieldType[PropertyPaneFieldType["DynamicFieldSet"] = 16] = "DynamicFieldSet";
})(PropertyPaneFieldType = PropertyPaneFieldType || (PropertyPaneFieldType = {}));


/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_4__;

/***/ }),
/* 5 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_5__;

/***/ }),
/* 6 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_6__;

/***/ }),
/* 7 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_7__;

/***/ }),
/* 8 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_8__;

/***/ }),
/* 9 */
/***/ (function(module, exports) {

/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function(useSourceMap) {
	var list = [];

	// return the list of modules as css string
	list.toString = function toString() {
		return this.map(function (item) {
			var content = cssWithMappingToString(item, useSourceMap);
			if(item[2]) {
				return "@media " + item[2] + "{" + content + "}";
			} else {
				return content;
			}
		}).join("");
	};

	// import a list of modules into the list
	list.i = function(modules, mediaQuery) {
		if(typeof modules === "string")
			modules = [[null, modules, ""]];
		var alreadyImportedModules = {};
		for(var i = 0; i < this.length; i++) {
			var id = this[i][0];
			if(typeof id === "number")
				alreadyImportedModules[id] = true;
		}
		for(i = 0; i < modules.length; i++) {
			var item = modules[i];
			// skip already imported module
			// this implementation is not 100% perfect for weird media query combinations
			//  when a module is imported multiple times with different media queries.
			//  I hope this will never occur (Hey this way we have smaller bundles)
			if(typeof item[0] !== "number" || !alreadyImportedModules[item[0]]) {
				if(mediaQuery && !item[2]) {
					item[2] = mediaQuery;
				} else if(mediaQuery) {
					item[2] = "(" + item[2] + ") and (" + mediaQuery + ")";
				}
				list.push(item);
			}
		}
	};
	return list;
};

function cssWithMappingToString(item, useSourceMap) {
	var content = item[1] || '';
	var cssMapping = item[3];
	if (!cssMapping) {
		return content;
	}

	if (useSourceMap && typeof btoa === 'function') {
		var sourceMapping = toComment(cssMapping);
		var sourceURLs = cssMapping.sources.map(function (source) {
			return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'
		});

		return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
	}

	return [content].join('\n');
}

// Adapted from convert-source-map (MIT)
function toComment(sourceMap) {
	// eslint-disable-next-line no-undef
	var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
	var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;

	return '/*# ' + data + ' */';
}


/***/ }),
/* 10 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_10__;

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_12__;

/***/ }),
/* 13 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_13__;

/***/ }),
/* 14 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
var key = '_ZRJdhh/Ht8a/UwYAwPqP9Q';
var allStrings = ( false) ?
    require("../../resx-strings/en-us.json") :
    __webpack_require__(13);
var strings = allStrings[key];
/* harmony default export */ __webpack_exports__["a"] = (strings);


/***/ }),
/* 15 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PropertyPaneButtonType; });
var PropertyPaneButtonType;
(function (PropertyPaneButtonType) {
    PropertyPaneButtonType[PropertyPaneButtonType["Normal"] = 0] = "Normal";
    PropertyPaneButtonType[PropertyPaneButtonType["Primary"] = 1] = "Primary";
    PropertyPaneButtonType[PropertyPaneButtonType["Hero"] = 2] = "Hero";
    PropertyPaneButtonType[PropertyPaneButtonType["Compound"] = 3] = "Compound";
    PropertyPaneButtonType[PropertyPaneButtonType["Command"] = 4] = "Command";
    PropertyPaneButtonType[PropertyPaneButtonType["Icon"] = 5] = "Icon";
})(PropertyPaneButtonType = PropertyPaneButtonType || (PropertyPaneButtonType = {}));


/***/ }),
/* 16 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });

// EXTERNAL MODULE: C:/agent/1/_work/5/s/common/temp/node_modules/.onedrive.pkgs.visualstudio.com/tslib/1.8.1/node_modules/tslib/tslib.es6.js
var tslib_es6 = __webpack_require__(0);

// EXTERNAL MODULE: external "@microsoft/sp-diagnostics"
var sp_diagnostics_ = __webpack_require__(4);
var sp_diagnostics__default = /*#__PURE__*/__webpack_require__.n(sp_diagnostics_);

// EXTERNAL MODULE: external "@microsoft/sp-component-base"
var sp_component_base_ = __webpack_require__(10);
var sp_component_base__default = /*#__PURE__*/__webpack_require__.n(sp_component_base_);

// EXTERNAL MODULE: external "@microsoft/sp-core-library"
var sp_core_library_ = __webpack_require__(1);
var sp_core_library__default = /*#__PURE__*/__webpack_require__.n(sp_core_library_);

// EXTERNAL MODULE: external "@microsoft/decorators"
var decorators_ = __webpack_require__(3);
var decorators__default = /*#__PURE__*/__webpack_require__.n(decorators_);

// CONCATENATED MODULE: ./lib/core/context/PropertyPaneAccessor.js



var PropertyPaneAccessor_PropertyPaneAccessor = (function () {
    function PropertyPaneAccessor(openProperytPane, refresh, isRenderedByWebPart, isPropertyPaneOpen) {
        this._open = openProperytPane;
        this._refresh = refresh;
        this._isRenderedByWebPart = isRenderedByWebPart;
        this._isPropertyPaneOpen = isPropertyPaneOpen;
        this.open = this.open.bind(this);
        this.refresh = this.refresh.bind(this);
        this.isRenderedByWebPart = this.isRenderedByWebPart.bind(this);
    }
    PropertyPaneAccessor.prototype.open = function () {
        this._open();
    };
    PropertyPaneAccessor.prototype.refresh = function () {
        this._refresh();
    };
    PropertyPaneAccessor.prototype.isRenderedByWebPart = function () {
        return this._isRenderedByWebPart();
    };
    PropertyPaneAccessor.prototype.isPropertyPaneOpen = function () {
        return this._isPropertyPaneOpen();
    };
    PropertyPaneAccessor = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], PropertyPaneAccessor);
    return PropertyPaneAccessor;
}());
/* harmony default export */ var context_PropertyPaneAccessor = (PropertyPaneAccessor_PropertyPaneAccessor);

// CONCATENATED MODULE: ./lib/core/BaseWebPartContext.js





var BaseWebPartContext_BaseWebPartContext = (function (_super) {
    tslib_es6["c" /* __extends */](BaseWebPartContext, _super);
    function BaseWebPartContext(parameters) {
        var _this = _super.call(this, parameters) || this;
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters, 'webpart context');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.instanceId, 'webpart context instanceId');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.webPartTag, 'webpart context webPartTag');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.eventAggregator, 'webpart context eventAggregator');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.host, 'webpart context host');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.isPropertyPaneRenderedByWebPart, 'webpart context isPropertyPaneRenderedByWebPart');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.isPropertyPaneOpen, 'webpart context isPropertyPaneOpen');
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.requestPropertyPaneAction, 'webpart context requestPropertyPaneAction');
        _this._webPartTag = parameters.webPartTag;
        _this._host = parameters.host;
        _this._eventAggregator = parameters.eventAggregator;
        _this._requestPropertyPaneAction = parameters.requestPropertyPaneAction;
        _this._isPropertyPaneRenderedByWebPart = parameters.isPropertyPaneRenderedByWebPart;
        _this._isPropertyPaneOpen = parameters.isPropertyPaneOpen;
        _this._privateDataUpdatedEvent = parameters._dataUpdatedEvent;
        _this._propertyPaneAccessor = new context_PropertyPaneAccessor(function () { _this._requestPropertyPaneAction(_this.instanceId, 1 , true); }, function () { _this._requestPropertyPaneAction(_this.instanceId, 5 ); }, function () { return _this._isPropertyPaneRenderedByWebPart(); }, function () { return _this._isPropertyPaneOpen(); });
        return _this;
    }
    Object.defineProperty(BaseWebPartContext.prototype, "webPartTag", {
        get: function () { return this._webPartTag; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPartContext.prototype, "eventAggregator", {
        get: function () {
            if (false) {
                _TraceLogger.logVerbose(this._logSource, 'EventAggregator is not supported for OnPrem.');
            }
            return this._eventAggregator;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPartContext.prototype, "propertyPane", {
        get: function () { return this._propertyPaneAccessor; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPartContext.prototype, "host", {
        get: function () { return this._host; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPartContext.prototype, "_dataUpdatedEvent", {
        get: function () { return this._privateDataUpdatedEvent; },
        enumerable: true,
        configurable: true
    });
    return BaseWebPartContext;
}(sp_component_base_["BaseComponentContext"]));
/* harmony default export */ var core_BaseWebPartContext = (BaseWebPartContext_BaseWebPartContext);

// CONCATENATED MODULE: ./lib/core/WebPartContext.js




var WebPartContext_WebPartContext = (function (_super) {
    tslib_es6["c" /* __extends */](WebPartContext, _super);
    function WebPartContext(parameters) {
        var _this = _super.call(this, parameters) || this;
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.domElement, "webpart context domElement");
        sp_core_library_["Validate"].isNotNullOrUndefined(parameters.statusRenderer, 'webpart context statusRenderer');
        _this._domElement = parameters.domElement;
        _this._statusRenderer = parameters.statusRenderer;
        return _this;
    }
    Object.defineProperty(WebPartContext.prototype, "domElement", {
        get: function () { return this._domElement; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebPartContext.prototype, "statusRenderer", {
        get: function () { return this._statusRenderer; },
        enumerable: true,
        configurable: true
    });
    WebPartContext = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], WebPartContext);
    return WebPartContext;
}(core_BaseWebPartContext));
/* harmony default export */ var core_WebPartContext = (WebPartContext_WebPartContext);

// CONCATENATED MODULE: ./lib/core/IWebPartData.js
var WebPartIsolationLevel;
(function (WebPartIsolationLevel) {
    WebPartIsolationLevel["None"] = "None";
    WebPartIsolationLevel["DomIsolation"] = "DomIsolation";
})(WebPartIsolationLevel = WebPartIsolationLevel || (WebPartIsolationLevel = {}));

// EXTERNAL MODULE: external "@microsoft/sp-lodash-subset"
var sp_lodash_subset_ = __webpack_require__(6);
var sp_lodash_subset__default = /*#__PURE__*/__webpack_require__.n(sp_lodash_subset_);

// EXTERNAL MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneField/IPropertyPaneField.js
var IPropertyPaneField = __webpack_require__(2);

// CONCATENATED MODULE: ./lib/core/loc/Strings.resx.js
var Strings_resx_key = '_cUY5i3OR5M46pep9mRCR0g';
var allStrings = ( false) ?
    require("../../resx-strings/en-us.json") :
    __webpack_require__(13);
var strings = allStrings[Strings_resx_key];
/* harmony default export */ var Strings_resx = (strings);

// CONCATENATED MODULE: ./lib/core/error/SPWebPartError.js




var SPWebPartErrorCode;
(function (SPWebPartErrorCode) {
    SPWebPartErrorCode[SPWebPartErrorCode["ModuleUndefined"] = 0] = "ModuleUndefined";
    SPWebPartErrorCode[SPWebPartErrorCode["ModuleNotLoaded"] = 1] = "ModuleNotLoaded";
    SPWebPartErrorCode[SPWebPartErrorCode["IncorrectBoostrapModule"] = 2] = "IncorrectBoostrapModule";
    SPWebPartErrorCode[SPWebPartErrorCode["MissingExpectedWebPartMemberError"] = 3] = "MissingExpectedWebPartMemberError";
    SPWebPartErrorCode[SPWebPartErrorCode["NonBaseWebPart"] = 4] = "NonBaseWebPart";
    SPWebPartErrorCode[SPWebPartErrorCode["ScriptLoadError"] = 5] = "ScriptLoadError";
    SPWebPartErrorCode[SPWebPartErrorCode["ManifestNull"] = 6] = "ManifestNull";
    SPWebPartErrorCode[SPWebPartErrorCode["ManifestInvalid"] = 7] = "ManifestInvalid";
    SPWebPartErrorCode[SPWebPartErrorCode["BaseConstructError"] = 8] = "BaseConstructError";
    SPWebPartErrorCode[SPWebPartErrorCode["MustOverrideRender"] = 9] = "MustOverrideRender";
    SPWebPartErrorCode[SPWebPartErrorCode["NotInitializedError"] = 10] = "NotInitializedError";
    SPWebPartErrorCode[SPWebPartErrorCode["PropertyBagNull"] = 11] = "PropertyBagNull";
    SPWebPartErrorCode[SPWebPartErrorCode["OnAfterDeserializeReturnedNull"] = 12] = "OnAfterDeserializeReturnedNull";
    SPWebPartErrorCode[SPWebPartErrorCode["OnInitReturnedNullPromise"] = 13] = "OnInitReturnedNullPromise";
    SPWebPartErrorCode[SPWebPartErrorCode["ReadOnlyProperty"] = 14] = "ReadOnlyProperty";
    SPWebPartErrorCode[SPWebPartErrorCode["SerializationFailed"] = 15] = "SerializationFailed";
    SPWebPartErrorCode[SPWebPartErrorCode["FirstTimeRenderCalledMoreThanOnce"] = 16] = "FirstTimeRenderCalledMoreThanOnce";
    SPWebPartErrorCode[SPWebPartErrorCode["RenderCompletedCallNotCalled"] = 17] = "RenderCompletedCallNotCalled";
    SPWebPartErrorCode[SPWebPartErrorCode["InvalidSPLinkAttributeFormat"] = 18] = "InvalidSPLinkAttributeFormat";
    SPWebPartErrorCode[SPWebPartErrorCode["InvalidSPLinkIndex"] = 19] = "InvalidSPLinkIndex";
    SPWebPartErrorCode[SPWebPartErrorCode["GetDataReturnedNullPromise"] = 20] = "GetDataReturnedNullPromise";
    SPWebPartErrorCode[SPWebPartErrorCode["RenderPromiseUndefined"] = 21] = "RenderPromiseUndefined";
})(SPWebPartErrorCode = SPWebPartErrorCode || (SPWebPartErrorCode = {}));
var SPWebPartError_SPWebPartError = (function (_super) {
    tslib_es6["c" /* __extends */](SPWebPartError, _super);
    function SPWebPartError(errorCode, logProperties) {
        var params = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            params[_i - 2] = arguments[_i];
        }
        var _this = _super.call(this, SPWebPartErrorCode[errorCode], sp_core_library_["Text"].format(SPWebPartError_1._errorCodeToMessageMap.get(errorCode), params), logProperties) || this;
        _this.__proto__ = SPWebPartError_1.prototype; 
        _this._id = errorCode;
        return _this;
    }
    SPWebPartError_1 = SPWebPartError;
    Object.defineProperty(SPWebPartError.prototype, "id", {
        get: function () {
            return this._id;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SPWebPartError.prototype, "category", {
        get: function () {
            return 'SPWebPartErrorCode';
        },
        enumerable: true,
        configurable: true
    });
    SPWebPartError.create = function (errorCode) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        return new SPWebPartError_1(errorCode, undefined, params);
    };
    SPWebPartError.createWithLogProperties = function (errorCode, logProperties) {
        var params = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            params[_i - 2] = arguments[_i];
        }
        return new SPWebPartError_1(errorCode, logProperties, params);
    };
    SPWebPartError._errorCodeToMessageMap = new Map([
        [SPWebPartErrorCode.ModuleUndefined, Strings_resx.UndefinedModuleError],
        [SPWebPartErrorCode.ModuleNotLoaded, Strings_resx.ModuleNotLoadedError],
        [SPWebPartErrorCode.IncorrectBoostrapModule, Strings_resx.IncorrectBoostrapModuleError],
        [SPWebPartErrorCode.MissingExpectedWebPartMemberError, Strings_resx.MissingExpectedWebPartMemberError],
        [SPWebPartErrorCode.NonBaseWebPart, Strings_resx.NonBaseWebPartError],
        [SPWebPartErrorCode.ScriptLoadError, Strings_resx.ScriptLoadErrorTemplate],
        [SPWebPartErrorCode.ManifestNull, Strings_resx.ManifestNullError],
        [SPWebPartErrorCode.ManifestInvalid, Strings_resx.ManifestInvalidError],
        [SPWebPartErrorCode.BaseConstructError, Strings_resx.BaseConstructError],
        [SPWebPartErrorCode.MustOverrideRender, Strings_resx.MustOverrideRenderError],
        [SPWebPartErrorCode.NotInitializedError, Strings_resx.NotIntializedError],
        [SPWebPartErrorCode.PropertyBagNull, Strings_resx.PropertyBagNullError],
        [SPWebPartErrorCode.OnAfterDeserializeReturnedNull, Strings_resx.OnAfterDeserializeReturnedNull],
        [SPWebPartErrorCode.OnInitReturnedNullPromise, Strings_resx.OnInitReturnedNullPromise],
        [SPWebPartErrorCode.ReadOnlyProperty, Strings_resx.ReadOnlyPropertyError],
        [SPWebPartErrorCode.SerializationFailed, Strings_resx.SerializationFailedError],
        [SPWebPartErrorCode.FirstTimeRenderCalledMoreThanOnce, Strings_resx.FirstTimeRenderCalledMoreThanOnceError],
        [SPWebPartErrorCode.RenderCompletedCallNotCalled, Strings_resx.RenderCompletedCallNotCalledError],
        [SPWebPartErrorCode.InvalidSPLinkAttributeFormat, Strings_resx.InvalidSPLinkAttributeFormatError],
        [SPWebPartErrorCode.InvalidSPLinkIndex, Strings_resx.InvalidSPLinkIndexError],
        [SPWebPartErrorCode.RenderPromiseUndefined, Strings_resx.RenderPromiseUndefinedError]
    ] );
    SPWebPartError = SPWebPartError_1 = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], SPWebPartError);
    return SPWebPartError;
    var SPWebPartError_1;
}(sp_core_library_["SPError"]));


// CONCATENATED MODULE: ./lib/utils/Object.js

function deepFreeze(obj) {
    if (!obj) {
        return undefined;
    }
    if (!Object.isFrozen(obj)) {
        Object.freeze(obj);
    }
    var depth = 0;
    var func = function (o) {
        if (++depth > 5) {
            return;
        }
        var propNames = Object.getOwnPropertyNames(o);
        propNames.forEach(function (name) {
            var prop = o[name];
            if (typeof prop === 'object' && !!prop && !sp_lodash_subset_["isElement"](prop) && !Object.isFrozen(prop)) {
                func(prop);
            }
        });
    };
    func(obj);
    return obj;
}

// CONCATENATED MODULE: ./lib/utils/ExecuteAndReThrow.js


function executeAndReThrow(method, errorToThrow, logSource) {
    sp_core_library_["Validate"].isNotNullOrUndefined(method, 'method');
    try {
        method();
    }
    catch (e) {
        if (logSource) {
            sp_diagnostics_["_TraceLogger"].logError(logSource, new Error('Error: ' + e));
        }
        errorToThrow.innerError = e;
        throw errorToThrow;
    }
}

// CONCATENATED MODULE: ./lib/common/KillSwitches.js

var KillSwitches_KillSwitches = (function () {
    function KillSwitches() {
    }
    KillSwitches.isPropertyPaneControllerFromServiceScopeKillSwitchActivated = function () {
        return sp_core_library_["_SPKillSwitch"].isActivated(sp_core_library_["Guid"].tryParse('6b3ca2d8-871e-41cb-9de1-11ed1fc90bf9'), '05/31/2018', 'ConsumePropertyPaneControllerFromServiceScope');
    };
    KillSwitches.isPropertyPaneDefaultActionUsingFalseResetKillSwitchActivated = function () {
        return sp_core_library_["_SPKillSwitch"].isActivated(sp_core_library_["Guid"].parse('45e808ec-d503-4e5e-be2e-d172ce79bdd5'), '07/13/2018', 'PropertyPaneDefaultActionUsingFalseReset');
    };
    KillSwitches.isPropertiesCloningUsingDeepCloneWithKillSwitchActivated = function () {
        return sp_core_library_["_SPKillSwitch"].isActivated(sp_core_library_["Guid"].parse('54a56fa6-4d6a-4bb3-b121-f87560316b17'), '07/27/2018', 'Web part properties serialization using lodash.cloneDeepWith to support dynamic properties.');
    };
    return KillSwitches;
}());
/* harmony default export */ var common_KillSwitches = (KillSwitches_KillSwitches);

// CONCATENATED MODULE: ./lib/core/BaseWebPart.js













var BaseWebPart_BaseWebPart = (function (_super) {
    tslib_es6["c" /* __extends */](BaseWebPart, _super);
    function BaseWebPart() {
        var _this = _super.call(this) || this;
        _this._initialized = false;
        _this._baseLogSource = sp_diagnostics_["_LogSource"].create('BaseWebPart');
        _this._hasEditLogged = false;
        _this._emptyResolvedPromise = Promise.resolve();
        if (_this.constructor['name'] === 'BaseWebPart') {
            throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.BaseConstructError);
        }
        return _this;
    }
    Object.defineProperty(BaseWebPart.prototype, "dataVersion", {
        get: function () {
            return sp_core_library_["Version"].parse('1.0');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "displayMode", {
        get: function () { return this._displayMode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "properties", {
        get: function () {
            if (this._initialized) {
                return this._properties;
            }
            else {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.NotInitializedError);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "propertiesMetadata", {
        get: function () { return undefined; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "disableReactivePropertyChanges", {
        get: function () { return false; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "previewImageUrl", {
        get: function () { return undefined; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "accessibleTitle", {
        get: function () { return this._getDefaultAccessibleTitle(); },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "title", {
        get: function () { return this._title; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "description", {
        get: function () { return this._description; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseWebPart.prototype, "persistedProperties", {
        get: function () {
            return this._backupProperties ? this._backupProperties : this.properties;
        },
        enumerable: true,
        configurable: true
    });
    BaseWebPart.prototype._getPropertyPaneData = function () {
        var _this = this;
        return this._loadPropertyPaneResources().then(function () {
            var configuration = _this.getPropertyPaneConfiguration();
            _this._fixUpDynamicDataConfiguration(configuration);
            return {
                webPartId: _this.context.instanceId,
                title: _this.title,
                isReactive: !_this.disableReactivePropertyChanges,
                configuration: configuration,
                properties: _this._cloneProperties(_this.properties),
                onPropertyPaneFieldChanged: undefined,
                onConfigurationEvent: undefined,
                onRendered: _this.onPropertyPaneRendered,
                dynamicConfiguration: {
                    defaultCallback: (function () { _this._dynamicPropertyRefresh(); }).bind(_this),
                    dynamicDataProvider: _this.context.dynamicDataProvider
                }
            };
        });
    };
    BaseWebPart.prototype._loadPropertyPaneResources = function () {
        if (!this._loadPropertyPaneResourcesPromise) {
            this._loadPropertyPaneResourcesPromise = this.loadPropertyPaneResources();
        }
        return this._loadPropertyPaneResourcesPromise;
    };
    BaseWebPart.prototype._onPropertyPaneFieldChanged = function (propertyPath, newValue) {
        if (this.disableReactivePropertyChanges && !this._backupProperties) {
            this._backupProperties = this._cloneProperties(this.properties);
        }
        var oldValue = sp_lodash_subset_["get"](this._properties, propertyPath); 
        this._updateProperty(propertyPath, newValue);
        this.onPropertyPaneFieldChanged(propertyPath, oldValue, newValue);
        this._afterPropertyUpdated(!this.disableReactivePropertyChanges);
    };
    BaseWebPart.prototype._onPropertyPaneLifeCycleEvent = function (event) {
        var _this = this;
        if (this.context.host.propertyPaneLifeCycleEventCallback) {
            this.context.host.propertyPaneLifeCycleEventCallback(event, this._internalSerialize());
        }
        switch (event) {
            case 1 :
                this._loadPropertyPaneResources().then(function () { return _this.onPropertyPaneConfigurationStart(); });
                break;
            case 2 :
                if (this.disableReactivePropertyChanges && this._backupProperties) {
                    this._properties = this._backupProperties;
                    this._backupProperties = undefined;
                }
                this.onPropertyPaneConfigurationComplete();
                break;
            case 5 :
                this._backupProperties = this.properties;
                this.onAfterPropertyPaneChangesApplied();
                this._afterPropertyUpdated(true);
                break;
        }
    };
    BaseWebPart.prototype._isPropertyPaneReactive = function () {
        return !this.disableReactivePropertyChanges;
    };
    BaseWebPart.prototype._internalSerialize = function () {
        var _this = this;
        var data; 
        executeAndReThrow(function () {
            _this.onBeforeSerialize();
            var propertiesJson = JSON.stringify(_this.properties);
            if (!_this._hasEditLogged && _this._initPropertiesSnapshot !== propertiesJson) {
                var isInternal = !!_this.context.manifest.isInternal;
                var logEntry = new sp_diagnostics_["_LogEntry"](_this._baseLogSource.id, 'WebPartEdited', sp_diagnostics_["_LogType"].Event, {
                    'alias': _this.context.manifest.alias,
                    'isInternal': isInternal.toString()
                });
                sp_diagnostics_["_EngagementLogger"].logEventWithLogEntry(logEntry);
                _this._hasEditLogged = true;
            }
            var serializedData = _this._serialize();
            sp_core_library_["Validate"].isNotNullOrUndefined(serializedData.dataVersion, 'serialized data version');
            if (propertiesJson && propertiesJson.indexOf(sp_component_base_["DynamicProperty"]._TYPE_NAME) !== -1) {
                _this._serializeDynamicData(serializedData);
            }
            data = {
                id: _this.context.manifest.id,
                instanceId: _this.context.instanceId,
                title: _this.title,
                description: _this.description,
                serverProcessedContent: serializedData.serverProcessedContent,
                dynamicDataPaths: serializedData.dynamicDataPaths,
                dynamicDataValues: serializedData.dynamicDataValues,
                dataVersion: serializedData.dataVersion.toString(),
                properties: serializedData.properties
            };
        }, SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.SerializationFailed, this.context.webPartTag), this._baseLogSource);
        return data;
    };
    BaseWebPart.prototype._internalDispose = function () {
        sp_diagnostics_["_TraceLogger"].logVerbose(this._baseLogSource, sp_core_library_["Text"].format(Strings_resx.DisposeLog, this.context.webPartTag));
        _super.prototype.dispose.call(this);
    };
    BaseWebPart.prototype._internalOnAfterResize = function () {
    };
    BaseWebPart.prototype.onInit = function () {
        return Promise.resolve(undefined);
    };
    BaseWebPart.prototype.onDisplayModeChanged = function (oldDisplayMode) {
    };
    BaseWebPart.prototype.onBeforeSerialize = function () {
    };
    BaseWebPart.prototype.onAfterDeserialize = function (deserializedObject, dataVersion) {
        return deserializedObject;
    };
    BaseWebPart.prototype.onEvent = function (eventName, eventObject) {
    };
    BaseWebPart.prototype.loadPropertyPaneResources = function () {
        return this._emptyResolvedPromise;
    };
    BaseWebPart.prototype.getPropertyPaneConfiguration = function () {
        return {
            pages: []
        };
    };
    BaseWebPart.prototype.onDispose = function () {
    };
    BaseWebPart.prototype.onPropertyPaneFieldChanged = function (propertyPath, oldValue, newValue) {
    };
    BaseWebPart.prototype.onPropertyPaneConfigurationStart = function () {
    };
    BaseWebPart.prototype.onPropertyPaneConfigurationComplete = function () {
    };
    BaseWebPart.prototype.onAfterPropertyPaneChangesApplied = function () {
    };
    BaseWebPart.prototype.onPropertyPaneRendered = function () {
    };
    BaseWebPart.prototype._internalInitialize = function (webPartContext, addedFromPersistedData, mode) {
        sp_core_library_["Validate"].isNotNullOrUndefined(webPartContext, 'webPartContext');
        deepFreeze(webPartContext.manifest);
        _super.prototype._initializeContext.call(this, webPartContext);
        sp_diagnostics_["_TraceLogger"].logVerbose(this._baseLogSource, sp_core_library_["Text"].format(Strings_resx.ConstructLog, webPartContext.webPartTag));
        this.onDispose = this.onDispose.bind(this);
        this.onPropertyPaneRendered = this.onPropertyPaneRendered.bind(this);
        this._initialized = true;
        this._displayMode = mode;
        this._renderedFromPersistedData = addedFromPersistedData;
        if (!this._renderedFromPersistedData) {
            var isInternal = this.context.manifest.isInternal || false;
            var logEntry = new sp_diagnostics_["_LogEntry"](this._baseLogSource.id, 'WebPartAdded', sp_diagnostics_["_LogType"].Event, {
                'alias': this.context.manifest.alias,
                'isInternal': isInternal.toString()
            });
            sp_diagnostics_["_EngagementLogger"].logEventWithLogEntry(logEntry);
        }
    };
    BaseWebPart.prototype._internalGetData = function () {
        return this._emptyResolvedPromise;
    };
    BaseWebPart.prototype._internalSetDisplayMode = function (newDisplayMode) {
        if (this._displayMode !== newDisplayMode) {
            var oldDisplayMode = this._displayMode;
            this._displayMode = newDisplayMode;
            this.onDisplayModeChanged(oldDisplayMode);
        }
    };
    BaseWebPart.prototype._internalSetDirtyBit = function () {
        if (this.displayMode === sp_core_library_["DisplayMode"].Read) {
            return;
        }
        var serializedState = this._internalSerialize();
        var newState = JSON.stringify(serializedState);
        if (!this._previousState) {
            this._previousState = newState;
        }
        else if (this._previousState !== newState && this.context.host.setDirty) {
            this.context.host.setDirty(this.context.instanceId, serializedState);
            this._previousState = newState;
        }
    };
    BaseWebPart.prototype._getDefaultAccessibleTitle = function () {
        return sp_core_library_["Text"].format(Strings_resx.GenericAccessibleLabelTemplate, this.title);
    };
    BaseWebPart.prototype._reInstateServerProcessedData = function (deserializedProperties, serverProcessedContent) {
        var _this = this;
        if (!deserializedProperties) {
            return {};
        }
        var fixedProperties = deserializedProperties;
        if (!this._renderedFromPersistedData) {
            return fixedProperties;
        }
        this._forEachPropertyWithMetaData(function (propPath, metadata) {
            if (_this.context.manifest.id !== 'b7dd04e1-19ce-4b24-9132-b60a1c2b910d'
                && metadata.isHtmlString) {
                sp_lodash_subset_["set"](fixedProperties, propPath, undefined);
            }
        }, fixedProperties);
        if (serverProcessedContent) {
            var htmlMaps = [
                serverProcessedContent.htmlStrings,
                serverProcessedContent.searchablePlainTexts,
                serverProcessedContent.imageSources,
                serverProcessedContent.links,
                serverProcessedContent.componentDependencies
            ];
            for (var _i = 0, htmlMaps_1 = htmlMaps; _i < htmlMaps_1.length; _i++) {
                var htmlMap = htmlMaps_1[_i];
                if (htmlMap) {
                    for (var propPath in htmlMap) {
                        var value = htmlMap[propPath];
                        if (typeof value === 'string') {
                            sp_lodash_subset_["set"](fixedProperties, propPath, value);
                        }
                    }
                }
            }
        }
        return fixedProperties;
    };
    BaseWebPart.prototype._forEachPropertyWithMetaData = function (metadataProcessor, properties ) {
        if (this.propertiesMetadata) {
            var _loop_1 = function (propPath) {
                var metadata = this_1.propertiesMetadata[propPath];
                this_1._validateAndIteratePath(propPath, properties || this_1.properties, function (fixedPropPath, index) {
                    metadataProcessor(fixedPropPath, metadata, index);
                });
            };
            var this_1 = this;
            for (var propPath in this.propertiesMetadata) {
                _loop_1(propPath);
            }
        }
    };
    BaseWebPart.prototype._validateAndIteratePath = function (propPath, properties,  propertyPathHandler) {
        var wildcardCount = (propPath.match(/\*/g) || []).length;
        if (wildcardCount > 1) {
            console.warn("Invalid property path: Multiple wildcards are not supported in property paths.\nEntry with path '" + propPath + "' got ignored in the properties metadata.");
            return;
        }
        else if (wildcardCount === 1) {
            var index = propPath.indexOf('[*]');
            if (index < -1) {
                console.warn("Invalid property path: Wildcards are only supported inside brackets to select array\nindices as in 'foo[*].bar'. Entry with path '" + propPath + "' got ignored in the properties metadata.");
                return;
            }
            else {
                var arrayPath = propPath.substr(0, index);
                var arrayInstance = sp_lodash_subset_["get"](properties, arrayPath);
                if (!arrayInstance) {
                    console.warn("Invalid property path: Could not find an array named '" + arrayPath + "' in the properties.\nEntry with path '" + propPath + "' got ignored in the properties metadata.");
                    return;
                }
                else {
                    for (var i = 0; i < arrayInstance.length; i++) {
                        var fixedPropPath = propPath.replace('*', "" + i);
                        propertyPathHandler(fixedPropPath, i);
                    }
                }
            }
        }
        else {
            propertyPathHandler(propPath);
        }
    };
    BaseWebPart.prototype._foreachCustomMetadata = function (metadata, iteration, customMetadataProcessor, properties ) {
        if (metadata && metadata.customMetadata) {
            var _loop_2 = function (propName) {
                var propPath = metadata.customMetadata[propName];
                if (iteration !== undefined && propPath.indexOf('*') !== -1) {
                    propPath = propPath.replace('*', iteration.toString());
                }
                this_2._validateAndIteratePath(propPath, properties || this_2.properties, function (fixedPropPath, customIteration) {
                    if (customIteration === undefined && metadata.customMetadata) {
                        customMetadataProcessor(fixedPropPath, propName);
                    }
                });
            };
            var this_2 = this;
            for (var propName in metadata.customMetadata) {
                _loop_2(propName);
            }
        }
    };
    BaseWebPart.prototype._internalDeserialize = function (data) {
        if (data) {
            if (data.title) {
                this._title = data.title;
            }
            if (data.description) {
                this._description = data.description;
            }
            if (typeof data.dataVersion !== 'string') {
                data.dataVersion = '1.0';
            }
            var deserializedData = {
                properties: data.properties,
                serverProcessedContent: data.serverProcessedContent,
                dynamicDataPaths: data.dynamicDataPaths,
                dynamicDataValues: data.dynamicDataValues,
                dataVersion: sp_core_library_["Version"].tryParse(data.dataVersion)
            };
            this._deserializeDynamicData(deserializedData);
            var deserializedPropsObject = this._reInstateServerProcessedData(deserializedData.properties, deserializedData.serverProcessedContent);
            var fixedProps = this.onAfterDeserialize(deserializedPropsObject, deserializedData.dataVersion);
            this._initPropertiesSnapshot = JSON.stringify(deserializedPropsObject);
            if (!fixedProps) {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.OnAfterDeserializeReturnedNull, this.context.webPartTag);
            }
            this._properties = fixedProps;
        }
    };
    BaseWebPart.prototype._afterPropertyUpdated = function (shouldRefresh) {
        if (this.context.host.setDirty) {
            this.context.host.setDirty(this.context.instanceId, this.properties);
        }
        if (shouldRefresh) {
            this._refresh();
        }
    };
    BaseWebPart.prototype._internalSetWebPartData = function (webPartData) {
        this._internalDeserialize(webPartData);
        this._refresh();
    };
    BaseWebPart.prototype._fixUpDynamicDataConfiguration = function (configuration) {
        var _this = this;
        configuration.pages.forEach(function (page) {
            page.groups.forEach(function (group) {
                group.groupFields.forEach(function (field) {
                    if (field.type === IPropertyPaneField["a" /* PropertyPaneFieldType */].DynamicTextField) {
                        var props = field.properties;
                        props.dynamicDataProvider = _this.context.dynamicDataProvider;
                        props.changeCallback = (function () { _this._dynamicPropertyRefresh(); }).bind(_this);
                    }
                });
            });
        });
    };
    BaseWebPart.prototype._serialize = function () {
        var _this = this;
        var serverProcessedContent = {
            htmlStrings: {},
            searchablePlainTexts: {},
            imageSources: {},
            links: {}
        };
        var properties = this._cloneProperties(this.persistedProperties);
        this._forEachPropertyWithMetaData(function (propPath, metadata, iteration) {
            if (metadata.shouldNotPersist) {
                sp_lodash_subset_["set"](properties, propPath, undefined);
            }
            var key = propPath;
            var value = sp_lodash_subset_["get"](properties, propPath);
            if (serverProcessedContent && typeof value === 'string' && value !== undefined) {
                if (serverProcessedContent.htmlStrings && metadata.isHtmlString) {
                    serverProcessedContent.htmlStrings[key] = value;
                }
                else if (serverProcessedContent.searchablePlainTexts && metadata.isSearchablePlainText) {
                    serverProcessedContent.searchablePlainTexts[key] = value;
                }
                else if (serverProcessedContent.links && metadata.isLink) {
                    serverProcessedContent.links[key] = value;
                }
                else if (serverProcessedContent.imageSources && metadata.isImageSource) {
                    serverProcessedContent.imageSources[key] = value;
                }
                else if (metadata.isComponentDependency) {
                    if (!serverProcessedContent.componentDependencies) {
                        serverProcessedContent.componentDependencies = {};
                    }
                    serverProcessedContent.componentDependencies[key] = value;
                }
                if (metadata.customMetadata) {
                    _this._internalSerializeCustomMetadata(key, metadata, properties, serverProcessedContent, iteration);
                }
                sp_lodash_subset_["set"](properties, propPath, undefined);
            }
        });
        return {
            dataVersion: this.dataVersion,
            properties: properties,
            serverProcessedContent: serverProcessedContent
        };
    };
    BaseWebPart.prototype._internalSerializeCustomMetadata = function (propertyPath, metadata, properties, serverProcessedContent, iteration) {
        var customMetadata = {};
        this._foreachCustomMetadata(metadata, iteration, function (customPropertyPath, customPropertyName) {
            var customValue = sp_lodash_subset_["get"](properties, customPropertyPath);
            if (serverProcessedContent && customValue !== undefined) {
                customMetadata[customPropertyName] = customValue;
            }
        });
        if (!serverProcessedContent.customMetadata) {
            serverProcessedContent.customMetadata = {};
        }
        serverProcessedContent.customMetadata[propertyPath] = customMetadata;
    };
    BaseWebPart.prototype._serializeDynamicData = function (serializedData) {
        var props = serializedData.properties; 
        var dynamicDataPaths = {};
        var dynamicDataValues = {}; 
        var key = sp_lodash_subset_["findKey"](props, { __type: sp_component_base_["DynamicProperty"]._TYPE_NAME });
        while (key) {
            var dynamicDataReference = sp_lodash_subset_["get"](props, key + '.reference');
            var dynamicDataValue = sp_lodash_subset_["get"](props, key + '.value');
            if (dynamicDataReference) {
                dynamicDataPaths[key] = dynamicDataReference;
                sp_lodash_subset_["unset"](props, key);
            }
            else if (dynamicDataValue !== undefined) {
                dynamicDataValues[key] = dynamicDataValue;
                sp_lodash_subset_["unset"](props, key);
            }
            else {
                throw new Error('Dynamic Data is misconfigured');
            }
            key = sp_lodash_subset_["findKey"](props, { __type: sp_component_base_["DynamicProperty"]._TYPE_NAME });
        }
        serializedData.dynamicDataPaths = dynamicDataPaths;
        serializedData.dynamicDataValues = dynamicDataValues;
    };
    BaseWebPart.prototype._deserializeDynamicData = function (data) {
        var _this = this;
        if (data.dynamicDataPaths) {
            for (var path in data.dynamicDataPaths) {
                if (data.dynamicDataPaths.hasOwnProperty(path)) {
                    var dynamicProperty = new sp_component_base_["DynamicProperty"](
                    this.context.dynamicDataProvider, (function () { _this._dynamicPropertyRefresh(); }).bind(this));
                    dynamicProperty.setReference(data.dynamicDataPaths[path]);
                    sp_lodash_subset_["set"](data.properties, path, dynamicProperty);
                }
            }
        }
        if (data.dynamicDataValues) {
            for (var path in data.dynamicDataValues) {
                if (data.dynamicDataValues.hasOwnProperty(path)) {
                    var dynamicProperty = new sp_component_base_["DynamicProperty"](
                    this.context.dynamicDataProvider, (function () { _this._dynamicPropertyRefresh(); }).bind(this));
                    dynamicProperty.setValue(data.dynamicDataValues[path]);
                    sp_lodash_subset_["set"](data.properties, path, dynamicProperty);
                }
            }
        }
    };
    BaseWebPart.prototype._updateProperty = function (propertyPath, newValue) {
        sp_lodash_subset_["update"](this.properties, propertyPath, function () { return newValue; });
    };
    BaseWebPart.prototype._cloneProperties = function (propertiesToClone) {
        if (!common_KillSwitches.isPropertiesCloningUsingDeepCloneWithKillSwitchActivated()) {
            return sp_lodash_subset_["cloneDeepWith"](propertiesToClone, function (prop) {
                if (prop instanceof sp_component_base_["DynamicProperty"]) {
                    return prop._cloneDeep(prop); 
                }
            });
        }
        else {
            return sp_lodash_subset_["cloneDeep"](propertiesToClone);
        }
    };
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "propertiesMetadata", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "disableReactivePropertyChanges", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "previewImageUrl", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "accessibleTitle", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onInit", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onDisplayModeChanged", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onBeforeSerialize", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onAfterDeserialize", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "loadPropertyPaneResources", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "getPropertyPaneConfiguration", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onDispose", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onPropertyPaneFieldChanged", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onPropertyPaneConfigurationStart", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onPropertyPaneConfigurationComplete", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onAfterPropertyPaneChangesApplied", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseWebPart.prototype, "onPropertyPaneRendered", null);
    return BaseWebPart;
}(sp_component_base_["BaseComponent"]));
/* harmony default export */ var core_BaseWebPart = (BaseWebPart_BaseWebPart);

// EXTERNAL MODULE: external "@ms/sp-telemetry"
var sp_telemetry_ = __webpack_require__(12);
var sp_telemetry__default = /*#__PURE__*/__webpack_require__.n(sp_telemetry_);

// CONCATENATED MODULE: ./lib/core/classicPages/ClassicPageUtils.js


var ClassicPageUtils_ClassicPageUtils = (function () {
    function ClassicPageUtils() {
    }
    ClassicPageUtils.disableAutomaticPostbacks = function (domElement, env) {
        sp_core_library_["Validate"].isNotNullOrUndefined(domElement, 'domElement');
        if (env === sp_core_library_["EnvironmentType"].ClassicSharePoint) {
            domElement.addEventListener('click', function (event) {
                event.preventDefault ? event.preventDefault() : (event.returnValue = false);
            }, true );
            domElement.addEventListener('keydown', function (event) {
                if (event.keyCode === 13) {
                    event.preventDefault ? event.preventDefault() : (event.returnValue = false);
                }
            }, true );
        }
    };
    ClassicPageUtils.removeFabricLinks = function () {
        var links = document.getElementsByTagName('link');
        if (links && links.length) {
            for (var i = 0; i < links.length; i++) {
                if (links[i] && links[i].href.indexOf('fabric.min.css') !== -1) {
                    var parentNode = links[i].parentNode;
                    if (parentNode) {
                        parentNode.removeChild(links[i]);
                    }
                }
            }
        }
    };
    return ClassicPageUtils;
}());
/* harmony default export */ var classicPages_ClassicPageUtils = (ClassicPageUtils_ClassicPageUtils);

// CONCATENATED MODULE: ./lib/core/WebPartMetrics.js
var WebPartMetrics = (function () {
    function WebPartMetrics() {
    }
    WebPartMetrics.webParts = 'WebParts';
    WebPartMetrics.webPartsCountedInViewport = 'WebPartsCountedInViewport';
    WebPartMetrics.webPartsLoadedNotInViewport = 'WebPartsLoadedNotInViewport';
    WebPartMetrics.webPartsLoadedForViewport = 'WebPartsLoadedForViewport';
    WebPartMetrics.webPartsLoadedByScroll = 'WebPartsLoadedByScroll';
    WebPartMetrics.webPartsLoadedBeforeScroll = 'WebPartsLoadedBeforeScroll';
    return WebPartMetrics;
}());
/* harmony default export */ var core_WebPartMetrics = (WebPartMetrics);

// CONCATENATED MODULE: ./lib/core/ViewportLoader.js






var WebPartLoadSource;
(function (WebPartLoadSource) {
    WebPartLoadSource[WebPartLoadSource["viewport"] = 1] = "viewport";
    WebPartLoadSource[WebPartLoadSource["scroll"] = 2] = "scroll";
    WebPartLoadSource[WebPartLoadSource["loadOutsideViewport"] = 3] = "loadOutsideViewport";
})(WebPartLoadSource || (WebPartLoadSource = {}));
var ViewportLoader_ViewportLoader = (function () {
    function ViewportLoader() {
        this._webparts = new Set();
        this._lazyLoadedTrackerAttribute = 'data-sp-webpart-lazycount';
        this.SCROLL = 'scroll';
        this.RESIZE = 'resize';
        this._isInitialized = false;
        this._logSource = sp_diagnostics_["_LogSource"].create('ViewportLoader');
        this._isListeningWindow = false;
        this._offsetWebpartsToLoad = [];
        this._bind();
    }
    Object.defineProperty(ViewportLoader, "instance", {
        get: function () {
            if (ViewportLoader._instance === undefined) {
                ViewportLoader._instance = new ViewportLoader();
            }
            return ViewportLoader._instance;
        },
        enumerable: true,
        configurable: true
    });
    ViewportLoader.isInIntialViewport = function (webpart) {
        sp_core_library_["Validate"].isNotNullOrUndefined(webpart, 'webpart');
        var viewportHeight = window.innerHeight || document.documentElement.clientHeight;
        var top = webpart.domElement && webpart.domElement.getBoundingClientRect().top;
        var euplViewportOffset = Math.floor(viewportHeight * 0.1);
        if ((window.pageYOffset + top) < (viewportHeight - euplViewportOffset)) {
            return true;
        }
        return false;
    };
    ViewportLoader.prototype.register = function (webpart, scrollableParent) {
        var _this = this;
        sp_core_library_["Validate"].isNotNullOrUndefined(webpart, 'webpart');
        webpart._internalIsInViewport = false;
        if (!this._isInitialized) {
            this._initialize();
        }
        this._checkVisibilityAndRender(webpart, WebPartLoadSource.viewport);
        if (webpart._internalIsInViewport) {
            return;
        }
        var parents = scrollableParent ? [scrollableParent] : this._findScrollableParents(webpart.domElement);
        parents.forEach(function (parent, index, allPatents) {
            var count = _this._updateRegisteredChildren(parent, 1);
            if (count === 1) {
                _this._listenEvents(parent);
            }
        });
        this._listenEvents(window);
        this._webparts.add(webpart);
        if (!!this._noMoreLazy) {
            sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, 'Web part to load after no more lazy state');
            this._noMoreLazy = false;
            this._loadOutsideViewPort();
        }
    };
    ViewportLoader.prototype.unregister = function (webpart) {
        var _this = this;
        sp_core_library_["Validate"].isNotNullOrUndefined(webpart, 'unregister Web part');
        if (!this._webparts.has(webpart)) {
            return;
        }
        this._webparts.delete(webpart);
        var parents = this._findScrollableParents(webpart.domElement);
        parents.forEach(function (parent, index, allParents) {
            var count = _this._updateRegisteredChildren(parent, -1);
            if (count <= 0) {
                _this._unlistenEvents(parent);
            }
        });
        if (this._webparts.size === 0 && !!this._noMoreLazy) {
            this._unlistenEvents(window);
            this._dispose();
        }
    };
    ViewportLoader.prototype.loadOutsideViewPort = function () {
        sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, "loadOutsideViewPort is called to load rest of the " + this._webparts.size + " web parts");
        this._loadOutsideViewPort();
        sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, "loadOutsideViewPort is completed");
    };
    ViewportLoader.prototype._bind = function () {
        this.register = this.register.bind(this);
        this.unregister = this.unregister.bind(this);
        this._checkVisibilityAndRender = this._checkVisibilityAndRender.bind(this);
        this._dispose = this._dispose.bind(this);
        this._findScrollableParent = this._findScrollableParent.bind(this);
        this._findScrollableParents = this._findScrollableParents.bind(this);
        this._initialize = this._initialize.bind(this);
        this._isCloseToViewport = this._isCloseToViewport.bind(this);
        this._renderWebpartInViewport = this._renderWebpartInViewport.bind(this);
        this._unlistenEvents = this._unlistenEvents.bind(this);
        this._updateRegisteredChildren = this._updateRegisteredChildren.bind(this);
        this._loadOutsideViewPort = this._loadOutsideViewPort.bind(this);
    };
    ViewportLoader.prototype._lazyLoaderEventHandler = function () {
        this._loadWebPartsInViewport(WebPartLoadSource.scroll);
    };
    ViewportLoader.prototype._loadWebPartsInViewport = function (loadSource) {
        var _this = this;
        if (!this._webparts || this._webparts.size === 0) {
            sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, Strings_resx.LazyEventOnNoLazyWebpart, 'InViewportHandler');
            return;
        }
        this._webparts.forEach(function (value, index, theSet) {
            _this._checkVisibilityAndRender(value, loadSource);
        });
    };
    ViewportLoader.prototype._checkVisibilityAndRender = function (webPart, loadSource) {
        if (webPart._internalIsInViewport) {
            this.unregister(webPart);
            return;
        }
        if (this._isCloseToViewport(webPart.domElement)) {
            this._renderWebpartInViewport(webPart, loadSource);
            this.unregister(webPart);
        }
    };
    ViewportLoader.prototype._isCloseToViewport = function (webpartNode) {
        try {
            var parent_1 = this._findScrollableParent(webpartNode);
            var _a = webpartNode.getBoundingClientRect(), top_1 = _a.top, height = _a.height;
            var documentHeight = window.innerHeight || document.documentElement.clientHeight;
            if (!parent_1) {
                var topInOrAboveViewport = (top_1 - this._offset) <= documentHeight;
                var bottomNotAboveViewport = (top_1 + height + this._offset) >= 0;
                return topInOrAboveViewport && bottomNotAboveViewport;
            }
            var _b = parent_1.getBoundingClientRect(), parentTop = _b.top, parentHeight = _b.height;
            var parentIntersectionTop = Math.max(0, parentTop);
            var parentIntersectionHeight = Math.min(parentTop + parentHeight, documentHeight) - parentIntersectionTop;
            var offsetTop = top_1 - parentIntersectionTop;
            var parentTopInOrAboveViewport = (offsetTop - this._offset) <= parentIntersectionHeight;
            var parentBottomNotAboveViewport = (offsetTop + height + this._offset) >= 0;
            return parentTopInOrAboveViewport && parentBottomNotAboveViewport;
        }
        catch (error) {
            sp_diagnostics_["_TraceLogger"].logError(this._logSource, error);
            return true;
        }
    };
    ViewportLoader.prototype._findScrollableParents = function (startingElement) {
        var parents = [];
        var parent = startingElement;
        while (parent) {
            parent = this._findScrollableParent(parent);
            if (parent) {
                parents.push(parent);
                parent = parent.parentElement;
            }
        }
        return parents;
    };
    ViewportLoader.prototype._findScrollableParent = function (startingElement) {
        var DATA_IS_SCROLLABLE_ATTRIBUTE = 'data-is-scrollable';
        var el = startingElement;
        var body = document.body;
        while (el && el !== body) {
            if (el.getAttribute(DATA_IS_SCROLLABLE_ATTRIBUTE) === 'true') {
                return el;
            }
            el = el.parentElement;
        }
        el = startingElement;
        while (el && el !== body) {
            if (el.getAttribute(DATA_IS_SCROLLABLE_ATTRIBUTE) !== 'false') {
                var styles = getComputedStyle(el);
                if (styles) {
                    var overflowY = styles.getPropertyValue('overflow-y');
                    if (overflowY && (overflowY === this.SCROLL || overflowY === 'auto')) {
                        return el;
                    }
                }
            }
            el = el.parentElement;
        }
        if (!el || el === body) {
            el = undefined;
        }
        return el;
    };
    ViewportLoader.prototype._initialize = function () {
        this._offset = 0;
        this._initTime = new Date();
        this._lazyHandler = sp_lodash_subset_["throttle"](this._lazyLoaderEventHandler, 100).bind(this);
        sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, 'ViewportLoader is Initialized');
        this._isInitialized = true;
    };
    ViewportLoader.prototype._dispose = function () {
        sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, 'ViewportLoader is disposed');
        var timeSpent = (new Date()).getTime() - this._initTime.getTime();
        sp_diagnostics_["_EngagementLogger"].logEvent('Webpart.ViewportLoad.Completed', timeSpent.toString());
        this._isInitialized = false;
        this._initTime = undefined;
    };
    ViewportLoader.prototype._listenEvents = function (parent) {
        if (!parent) {
            return;
        }
        var isWindow = parent === window;
        if (!isWindow || (isWindow && !this._isListeningWindow)) {
            this._addEventListerer(parent);
            if (isWindow) {
                this._isListeningWindow = true;
            }
        }
    };
    ViewportLoader.prototype._addEventListerer = function (element) {
        element.addEventListener(this.SCROLL, this._lazyHandler, false);
        element.addEventListener(this.RESIZE, this._lazyHandler, false);
    };
    ViewportLoader.prototype._unlistenEvents = function (parent) {
        if (!parent) {
            return;
        }
        var isWindow = parent === window;
        if (!isWindow || (isWindow && this._isListeningWindow)) {
            this._removeEventListener(parent);
            if (isWindow) {
                this._isListeningWindow = false;
            }
        }
    };
    ViewportLoader.prototype._removeEventListener = function (element) {
        element.removeEventListener(this.SCROLL, this._lazyHandler);
        element.removeEventListener(this.RESIZE, this._lazyHandler);
    };
    ViewportLoader.prototype._updateRegisteredChildren = function (element, count) {
        var lazyChilds = count + Number(element.getAttribute(this._lazyLoadedTrackerAttribute));
        if (count !== 0) {
            element.setAttribute(this._lazyLoadedTrackerAttribute, lazyChilds.toString());
        }
        return lazyChilds;
    };
    ViewportLoader.prototype._renderWebpartInViewport = function (webpart, loadSource) {
        if (webpart && !webpart._internalIsInViewport) {
            webpart._internalRenderInViewPort();
            switch (loadSource) {
                case WebPartLoadSource.viewport:
                    webpart._internalIsInViewport = true;
                    sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webPartsLoadedForViewport);
                    sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, 'Web part is loaded in initial viewport.');
                    break;
                case WebPartLoadSource.scroll:
                    sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webPartsLoadedByScroll);
                    break;
                case WebPartLoadSource.loadOutsideViewport:
                    sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webPartsLoadedBeforeScroll);
                    break;
            }
        }
    };
    ViewportLoader.prototype._loadOutsideViewPort = function () {
        var _this = this;
        if (!this._webparts || this._webparts.size === 0) {
            this._noMoreLazy = true;
            return;
        }
        for (var index = 0; this._offsetWebpartsToLoad && index < this._offsetWebpartsToLoad.length; index++) {
            if (!this._offsetWebpartsToLoad[index]._renderedOnce) {
                window.setTimeout(this._loadOutsideViewPort, 100);
                return;
            }
        }
        this._offsetWebpartsToLoad = [];
        var documentHeight = window.innerHeight || document.documentElement.clientHeight;
        this._offset = this._offset + documentHeight * 2;
        this._webparts.forEach(function (webpart, index, theSet) {
            if (_this._isCloseToViewport(webpart.domElement)) {
                _this._offsetWebpartsToLoad.push(webpart);
            }
        });
        this._loadWebPartsInViewport(WebPartLoadSource.loadOutsideViewport);
        if (this._webparts.size > 0) {
            this._loadOutsideViewPort();
        }
        else {
            this._noMoreLazy = true;
        }
    };
    return ViewportLoader;
}());
/* harmony default export */ var core_ViewportLoader = (ViewportLoader_ViewportLoader);

// CONCATENATED MODULE: ./lib/core/styles/cswp-base.module.scss.js
__webpack_require__(17);
var styles = {
    errorBox: 'errorBox_f6e55647',
    errorBoxText: 'errorBoxText_f6e55647',
    detailsButton: 'detailsButton_f6e55647',
    somethingWentWrongText: 'somethingWentWrongText_f6e55647',
    siteAdminText: 'siteAdminText_f6e55647',
    screenReaderOnly: 'screenReaderOnly_f6e55647',
};
/* harmony default export */ var cswp_base_module_scss = (styles);

// CONCATENATED MODULE: ./lib/core/BaseClientSideWebPart.js












var BaseClientSideWebPart_BaseClientSideWebPart = (function (_super) {
    tslib_es6["c" /* __extends */](BaseClientSideWebPart, _super);
    function BaseClientSideWebPart() {
        var _this = _super.call(this) || this;
        _this._logSource = sp_diagnostics_["_LogSource"].create('BaseClientSideWebPart');
        _this._internalIsInViewport = false;
        _this._asyncRenderQosMonitor = new sp_diagnostics_["_QosMonitor"]("WebPartAsyncRender");
        if (_this.constructor['name'] === 'BaseClientSideWebPart') {
            throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.BaseConstructError);
        }
        _this._firstTimeRenderPromises = [];
        return _this;
    }
    Object.defineProperty(BaseClientSideWebPart.prototype, "domElement", {
        get: function () { return this.context.domElement; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseClientSideWebPart.prototype, "width", {
        get: function () {
            if (this._width === undefined) {
                var width = window.getComputedStyle(this.domElement).width;
                this._width = width ? parseFloat(width) : 0;
            }
            return this._width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseClientSideWebPart.prototype, "renderedOnce", {
        get: function () { return this._renderedOnce; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseClientSideWebPart.prototype, "renderedFromPersistedData", {
        get: function () { return this._renderedFromPersistedData; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseClientSideWebPart.prototype, "canOpenPopupOnRender", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseClientSideWebPart.prototype, "isRenderAsync", {
        get: function () { return false; },
        enumerable: true,
        configurable: true
    });
    BaseClientSideWebPart.prototype._internalOnAfterResize = function () {
        this._width = undefined;
        this.onAfterResize(this.width);
    };
    BaseClientSideWebPart.prototype._calculateMinimumHeight = function () {
        if (this.context && this.context.manifest && this.context.manifest.isInternal) {
            sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, "Web part " + this.context.webPartTag + " should override _calculateMinimumHeight()");
        }
        return undefined;
    };
    BaseClientSideWebPart.prototype.renderCompleted = function () {
        this._renderCompleted();
    };
    BaseClientSideWebPart.prototype.onDisplayModeChanged = function (oldDisplayMode) {
        var _this = this;
        _super.prototype.onDisplayModeChanged.call(this, oldDisplayMode);
        if (oldDisplayMode === this.displayMode) {
            return;
        }
        if (!sp_core_library_["_SPKillSwitch"].isActivated(sp_core_library_["Guid"].parse('222961df-4439-412b-9e41-2e659ae18ab6'), '5/11/2018', 'FirstRenderPromises')) {
            Promise.all(this._firstTimeRenderPromises).then(function () { _this._renderWithAccessibleTitle(); });
        }
        else {
            this._renderWithAccessibleTitle();
        }
    };
    BaseClientSideWebPart.prototype.onDispose = function () {
        if (!this.context.host.isViewportLoadingDisabled && !this._internalIsInViewport) {
            core_ViewportLoader.instance.unregister(this);
        }
    };
    BaseClientSideWebPart.prototype.onAfterResize = function (newWidth) {
    };
    BaseClientSideWebPart.prototype.renderError = function (error) {
        this.context.statusRenderer.clearLoadingIndicator(this.domElement);
        this.context.statusRenderer.renderError(this.domElement, error);
        sp_diagnostics_["_TraceLogger"].logError(this._logSource, error);
    };
    BaseClientSideWebPart.prototype.clearError = function () {
        this.context.statusRenderer.clearError(this.domElement);
    };
    BaseClientSideWebPart.prototype._refresh = function () {
        this._renderWithAccessibleTitle();
    };
    BaseClientSideWebPart.prototype._dynamicPropertyRefresh = function () {
        if (this.renderedOnce) {
            this.render();
        }
    };
    BaseClientSideWebPart.prototype._internalSetDisplayMode = function (newDisplayMode) {
        if (this.displayMode !== newDisplayMode) {
            this._width = undefined;
        }
        _super.prototype._internalSetDisplayMode.call(this, newDisplayMode);
    };
    BaseClientSideWebPart.prototype._internalInitialize = function (webPartContext, addedFromPersistedData, mode) {
        _super.prototype._internalInitialize.call(this, webPartContext, addedFromPersistedData, mode);
        this._renderedOnce = false;
        this['__type'] = 'BaseClientSideWebPart'; 
        this.render = this.render.bind(this);
        this.onDispose = this.onDispose.bind(this);
        this.renderError = this.renderError.bind(this);
        this.clearError = this.clearError.bind(this);
        this.renderCompleted = this.renderCompleted.bind(this);
    };
    BaseClientSideWebPart.prototype._internalFirstTimeRender = function (scrollableParent, qosMonitor) {
        var _this = this;
        if (this._renderPromiseResolver) {
            throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.FirstTimeRenderCalledMoreThanOnce, this.context.webPartTag);
        }
        sp_diagnostics_["_TraceLogger"].logVerboseData({
            source: this._logSource,
            message: sp_core_library_["Text"].format(Strings_resx.StartedFirstTimeRender, this.context.webPartTag),
            serviceScope: this.context.serviceScope
        });
        return new Promise(function (resolve, reject) {
            if (!_this.properties && qosMonitor) {
                qosMonitor.writeUnexpectedFailure('PropertyBagNull');
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.PropertyBagNull, _this.context.webPartTag);
            }
            var minHeight = _this._calculateMinimumHeight();
            if (minHeight) {
                _this.domElement.style.minHeight = minHeight + "px";
            }
            _this._renderPromiseResolver = resolve;
            _this._renderPromiseRejecter = reject;
            if (!_this.context.host.isViewportLoadingDisabled) {
                sp_telemetry_["_PerformanceLogger"].markComponent(_this.context.webPartTag, 'loadingDelayed');
                _this._internalDelayedRender(scrollableParent);
            }
            else {
                _this._internalRenderInViewPort();
            }
        });
    };
    BaseClientSideWebPart.prototype._internalDelayedRender = function (scrollableParent) {
        core_ViewportLoader.instance.register(this, scrollableParent);
        if (!this._internalIsInViewport) {
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: this._logSource,
                message: "Web part " + this.context.webPartTag + " is not in initial viewport, rendering delayed.",
                serviceScope: this.context.serviceScope
            });
        }
    };
    BaseClientSideWebPart.prototype._internalRenderInViewPort = function () {
        var _this = this;
        if (!this.context.host.isViewportLoadingDisabled) {
            sp_telemetry_["_PerformanceLogger"].markComponent(this.context.webPartTag, 'inViewportLoading');
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: this._logSource,
                message: "Actually started first time render for web part " + this.context.webPartTag + ".",
                serviceScope: this.context.serviceScope
            });
        }
        if (!this._renderPromiseResolver || !this._renderPromiseRejecter) {
            throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.RenderPromiseUndefined, this.context.webPartTag);
        }
        var initPromise = this.onInit();
        if (!initPromise) {
            var error = SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.OnInitReturnedNullPromise, this.context.webPartTag);
            this._renderPromiseRejecter(error);
            this._clearRenderPromises();
            return;
        }
        this._firstTimeRenderPromises.push(initPromise);
        initPromise.then(function () {
            var minHeight = _this._calculateMinimumHeight();
            if (minHeight && _this.context.host.setElementMinHeight) {
                _this.context.host.setElementMinHeight(minHeight);
            }
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: _this._logSource,
                message: sp_core_library_["Text"].format(Strings_resx.OnInitCompleted, _this.context.webPartTag),
                serviceScope: _this.context.serviceScope
            });
            sp_telemetry_["_PerformanceLogger"].markComponent(_this.context.webPartTag, 'init');
            var getDataPromise = Promise.resolve();
            getDataPromise = _this._internalGetData();
            if (!getDataPromise) {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.GetDataReturnedNullPromise, _this.context.webPartTag);
            }
            _this._firstTimeRenderPromises.push(getDataPromise);
            getDataPromise.then(function () {
                sp_telemetry_["_PerformanceLogger"].markComponent(_this.context.webPartTag, 'getDataComplete');
                _this.context.statusRenderer.clearLoadingIndicator(_this.domElement);
                _this._renderWithAccessibleTitle();
                sp_telemetry_["_PerformanceLogger"].markComponent(_this.context.webPartTag, 'syncRender');
                if (!_this.isRenderAsync) {
                    _this._resolveOnRenderPromise();
                }
                else {
                    _this._startAsyncRenderGuardTimer();
                }
            });
        }).catch(function (e) {
            if (_this._renderPromiseRejecter) {
                _this._renderPromiseRejecter(e);
                _this._clearRenderPromises();
            }
        });
    };
    BaseClientSideWebPart.prototype._renderWithAccessibleTitle = function () {
        sp_telemetry_["_PerformanceLogger"].devMark("webpart(" + this.context.webPartTag + ")._renderWithAccessibleTitle");
        this.render();
        if (this.displayMode === sp_core_library_["DisplayMode"].Edit) {
            var accessibleContext = this.accessibleTitle || this._getDefaultAccessibleTitle();
            if (accessibleContext) {
                var contextualLabelId = "cswpAccessibleLabelContextual_" + this.context.instanceId;
                var accessibleDiv = this.domElement.querySelector("#" + contextualLabelId);
                var isNewLabelElement = !accessibleDiv;
                if (isNewLabelElement) {
                    accessibleDiv = document.createElement('div');
                    accessibleDiv.id = contextualLabelId;
                    accessibleDiv.className = cswp_base_module_scss.screenReaderOnly;
                }
                accessibleDiv.textContent = accessibleContext;
                if (isNewLabelElement) {
                    this.domElement.appendChild(accessibleDiv);
                }
            }
            classicPages_ClassicPageUtils.disableAutomaticPostbacks(this.domElement, sp_core_library_["Environment"].type);
        }
        this.domElement.style.minHeight = null; 
    };
    BaseClientSideWebPart.prototype._startAsyncRenderGuardTimer = function () {
        var _this = this;
        this._clearAsyncRenderGuardTimer();
        this._asyncRenderGuardTimer = window.setTimeout(function () {
            _this._asyncRenderTimeout();
        }, 25000);
    };
    BaseClientSideWebPart.prototype._renderCompleted = function () {
        if (this._asyncRenderGuardTimer) {
            this._clearAsyncRenderGuardTimer();
            this._asyncRenderQosMonitor.writeSuccess({
                'alias': this.context.manifest.alias,
                'webPartId': this.context.manifest.id
            });
            this._resolveOnRenderPromise();
        }
    };
    BaseClientSideWebPart.prototype._asyncRenderTimeout = function () {
        if (this._asyncRenderGuardTimer) {
            this._clearAsyncRenderGuardTimer();
            var error = SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.RenderCompletedCallNotCalled, this.context.webPartTag);
            sp_diagnostics_["_TraceLogger"].logErrorData({
                source: this._logSource,
                error: error,
                serviceScope: this.context.serviceScope
            });
            this._asyncRenderQosMonitor.writeUnexpectedFailure('Timeout', error, {
                'alias': this.context.manifest.alias,
                'webPartId': this.context.manifest.id,
                'instanceId': this.instanceId
            });
            this._resolveOnRenderPromise();
        }
    };
    BaseClientSideWebPart.prototype._clearAsyncRenderGuardTimer = function () {
        if (this._asyncRenderGuardTimer) {
            window.clearTimeout(this._asyncRenderGuardTimer);
            this._asyncRenderGuardTimer = undefined;
        }
    };
    BaseClientSideWebPart.prototype._resolveOnRenderPromise = function () {
        this._renderedOnce = true;
        var message = sp_core_library_["Text"].format(this.isRenderAsync ? Strings_resx.CompletedAsyncRender : Strings_resx.CompletedSyncRender, this.context.webPartTag);
        sp_diagnostics_["_TraceLogger"].logVerboseData({
            source: this._logSource,
            message: message,
            serviceScope: this.context.serviceScope
        });
        sp_telemetry_["_PerformanceLogger"].devMark("webpart(" + this.context.webPartTag + ").complete");
        if (this._renderPromiseResolver) {
            this._renderPromiseResolver();
        }
        this._clearRenderPromises();
    };
    BaseClientSideWebPart.prototype._clearRenderPromises = function () {
        this._renderPromiseResolver = undefined;
        this._renderPromiseRejecter = undefined;
    };
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseClientSideWebPart.prototype, "isRenderAsync", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseClientSideWebPart.prototype, "_calculateMinimumHeight", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseClientSideWebPart.prototype, "onDisplayModeChanged", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseClientSideWebPart.prototype, "onDispose", null);
    tslib_es6["b" /* __decorate */]([
        decorators_["virtual"]
    ], BaseClientSideWebPart.prototype, "onAfterResize", null);
    return BaseClientSideWebPart;
}(core_BaseWebPart));
/* harmony default export */ var core_BaseClientSideWebPart = (BaseClientSideWebPart_BaseClientSideWebPart);

// EXTERNAL MODULE: external "@ms/sp-load-themed-styles"
var sp_load_themed_styles_ = __webpack_require__(19);
var sp_load_themed_styles__default = /*#__PURE__*/__webpack_require__.n(sp_load_themed_styles_);

// EXTERNAL MODULE: external "@microsoft/sp-loader"
var sp_loader_ = __webpack_require__(20);
var sp_loader__default = /*#__PURE__*/__webpack_require__.n(sp_loader_);

// EXTERNAL MODULE: external "@microsoft/sp-http"
var sp_http_ = __webpack_require__(21);
var sp_http__default = /*#__PURE__*/__webpack_require__.n(sp_http_);

// EXTERNAL MODULE: external "@microsoft/sp-page-context"
var sp_page_context_ = __webpack_require__(22);
var sp_page_context__default = /*#__PURE__*/__webpack_require__.n(sp_page_context_);

// EXTERNAL MODULE: external "react-dom"
var external__react_dom_ = __webpack_require__(11);
var external__react_dom__default = /*#__PURE__*/__webpack_require__.n(external__react_dom_);

// EXTERNAL MODULE: external "react"
var external__react_ = __webpack_require__(5);
var external__react__default = /*#__PURE__*/__webpack_require__.n(external__react_);

// EXTERNAL MODULE: external "@microsoft/office-ui-fabric-react-bundle"
var office_ui_fabric_react_bundle_ = __webpack_require__(7);
var office_ui_fabric_react_bundle__default = /*#__PURE__*/__webpack_require__.n(office_ui_fabric_react_bundle_);

// EXTERNAL MODULE: ./lib/components/placeHolder/Placeholder.scss.js
var Placeholder_scss = __webpack_require__(23);
var Placeholder_scss_default = /*#__PURE__*/__webpack_require__.n(Placeholder_scss);

// CONCATENATED MODULE: ./lib/components/placeHolder/PlaceholderSpinner.js





var PlaceholderSpinner_PlaceholderSpinner = (function (_super) {
    tslib_es6["c" /* __extends */](PlaceholderSpinner, _super);
    function PlaceholderSpinner(props) {
        var _this = _super.call(this, props) || this;
        _this.showSpinner = _this.showSpinner.bind(_this);
        _this.state = { showSpinner: !props.hideSpinner };
        return _this;
    }
    PlaceholderSpinner.prototype.componentDidMount = function () {
        this._isMounted = true;
    };
    PlaceholderSpinner.prototype.render = function () {
        if (this.state.removePlaceholder) {
            return null; 
        }
        return (external__react_["createElement"](office_ui_fabric_react_bundle_["Overlay"], { className: 'Placeholder-overlay' },
            external__react_["createElement"]("div", { className: 'Placeholder-spinnerContainer' }, this.state.showSpinner && external__react_["createElement"](office_ui_fabric_react_bundle_["Spinner"], { type: office_ui_fabric_react_bundle_["SpinnerType"].large, label: this.props.label }))));
    };
    PlaceholderSpinner.prototype.componentWillUnmount = function () {
        this._isMounted = false;
    };
    PlaceholderSpinner.prototype.showSpinner = function (showSpinner) {
        if (this._isMounted) {
            this.setState({ showSpinner: showSpinner });
        }
    };
    PlaceholderSpinner.prototype.clearPlaceholder = function () {
        if (this._isMounted) {
            this.setState({ removePlaceholder: true });
        }
    };
    PlaceholderSpinner = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], PlaceholderSpinner);
    return PlaceholderSpinner;
}(external__react_["Component"]));
/* harmony default export */ var placeHolder_PlaceholderSpinner = (PlaceholderSpinner_PlaceholderSpinner);

// CONCATENATED MODULE: ./lib/core/ErrorMessage.js



var ErrorMessage_ErrorMessage = (function (_super) {
    tslib_es6["c" /* __extends */](ErrorMessage, _super);
    function ErrorMessage(props) {
        return _super.call(this, props) || this;
    }
    ErrorMessage.prototype.render = function () {
        return (external__react_["createElement"]("div", { className: cswp_base_module_scss.errorBox, role: 'alert', "aria-live": 'assertive' },
            external__react_["createElement"]("span", { className: cswp_base_module_scss.errorBoxText }, this.props.errorMessage)));
    };
    return ErrorMessage;
}(external__react_["Component"]));
/* harmony default export */ var core_ErrorMessage = (ErrorMessage_ErrorMessage);

// CONCATENATED MODULE: ./lib/core/FriendlyErrorMessage.js





var FriendlyErrorMessage_FriendlyErrorMessage = (function (_super) {
    tslib_es6["c" /* __extends */](FriendlyErrorMessage, _super);
    function FriendlyErrorMessage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isExpanded: false
        };
        _this._toggleExpandedDetails = _this._toggleExpandedDetails.bind(_this);
        return _this;
    }
    FriendlyErrorMessage.prototype.render = function () {
        var isExpanded = this.state.isExpanded;
        return (external__react_["createElement"]("div", { className: cswp_base_module_scss.errorBox },
            external__react_["createElement"]("div", null,
                external__react_["createElement"]("h2", { className: cswp_base_module_scss.somethingWentWrongText }, Strings_resx.WebpartErrorSomethingWentWrong)),
            external__react_["createElement"]("div", null,
                external__react_["createElement"]("span", { className: cswp_base_module_scss.siteAdminText }, Strings_resx.WebpartErrorSiteAdminAdvice)),
            external__react_["createElement"]("div", null,
                external__react_["createElement"]("button", { onClick: this._toggleExpandedDetails, className: cswp_base_module_scss.detailsButton }, Strings_resx.WebpartErrorTechnicalDetails)),
            isExpanded &&
                external__react_["createElement"](core_ErrorMessage, { errorMessage: this.props.errorMessage })));
    };
    FriendlyErrorMessage.prototype._toggleExpandedDetails = function () {
        this.setState({ isExpanded: !this.state.isExpanded });
    };
    return FriendlyErrorMessage;
}(external__react_["Component"]));
/* harmony default export */ var core_FriendlyErrorMessage = (FriendlyErrorMessage_FriendlyErrorMessage);

// CONCATENATED MODULE: ./lib/core/ClientSideWebPartStatusRenderer.js












var ClientSideWebPartStatusRenderer_ClientSideWebPartStatusRenderer = (function () {
    function ClientSideWebPartStatusRenderer() {
        this._errorId = 'cswp-error';
        this._logSource = sp_diagnostics_["_LogSource"].create('ClientSideWebPartStatusRenderer');
        this._activeIndicatorCache = new Map();
    }
    ClientSideWebPartStatusRenderer.prototype.displayLoadingIndicator = function (domElement, loadingMessage, timeout) {
        var _this = this;
        sp_core_library_["Validate"].isNotNullOrUndefined(domElement, 'domElement');
        if (!timeout || (timeout && isNaN(timeout))) {
            timeout = 1500; 
        }
        var cacheEntry = this._getCacheEntry(domElement);
        if (cacheEntry.loadingTimer) {
            window.clearTimeout(cacheEntry.loadingTimer);
        }
        this._renderSpinner(domElement, loadingMessage, false);
        cacheEntry.loadingTimer =
            window.setTimeout(function () { _this._renderSpinner(domElement, loadingMessage, true); }, timeout);
    };
    ClientSideWebPartStatusRenderer.prototype.clearLoadingIndicator = function (domElement) {
        sp_core_library_["Validate"].isNotNullOrUndefined(domElement, 'domElement');
        if (this._activeIndicatorCache.has(domElement)) {
            var cacheEntry = this._getCacheEntry(domElement);
            sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, Strings_resx.ClearLoadingIndicator);
            if (cacheEntry.loadingTimer) {
                window.clearTimeout(cacheEntry.loadingTimer);
            }
            if (cacheEntry.placeholder) {
                cacheEntry.placeholder.clearPlaceholder();
                external__react_dom_["unmountComponentAtNode"](domElement);
            }
            this._activeIndicatorCache.delete(domElement);
        }
    };
    ClientSideWebPartStatusRenderer.prototype.renderError = function (domElement, error) {
        sp_core_library_["Validate"].isNotNullOrUndefined(domElement, 'domElement');
        sp_core_library_["Validate"].isNotNullOrUndefined(error, 'error');
        var errorText = '';
        if (error instanceof sp_core_library_["SPError"]) {
            errorText = error.toStringForUI();
        }
        else {
            var vanillaError = error;
            var stack = vanillaError.stack;
            var newLineSeparator = '\r\n';
            var callStack = stack ? sp_core_library_["Text"].format(Strings_resx.WebpartErrorCallStackText, newLineSeparator, stack) : '';
            errorText = sp_core_library_["Text"].format(Strings_resx.WebpartErrorErrorText, newLineSeparator, "" + (vanillaError.message || error), callStack);
        }
        var cacheEntry = this._getCacheEntry(domElement);
        cacheEntry.isErrorBeingRendered = true;
        var errorComponent;
        if (false) {
            errorComponent = FriendlyErrorMessage;
        }
        else {
            errorComponent = core_ErrorMessage;
        }
        var divErr = domElement.querySelector("div[data-sp-id='" + this._errorId + "']");
        if (divErr) {
            divErr.style.display = 'block';
        }
        else {
            divErr = document.createElement('div');
            divErr.setAttribute('data-sp-id', this._errorId);
            domElement.appendChild(divErr);
            classicPages_ClassicPageUtils.disableAutomaticPostbacks(domElement, sp_core_library_["Environment"].type);
        }
        divErr.setAttribute('data-automation-id', 'webPartError');
        var el = external__react_["createElement"](errorComponent, { errorMessage: errorText });
        external__react_dom_["render"](el, divErr);
    };
    ClientSideWebPartStatusRenderer.prototype.clearError = function (domElement) {
        sp_core_library_["Validate"].isNotNullOrUndefined(domElement, 'domElement');
        if (!this._activeIndicatorCache.has(domElement)) {
            return;
        }
        var cacheEntry = this._activeIndicatorCache.get(domElement);
        if (cacheEntry && cacheEntry.isErrorBeingRendered) {
            cacheEntry.isErrorBeingRendered = false;
            var divErr = domElement.querySelector("div[data-sp-id='" + this._errorId + "']");
            if (divErr) {
                divErr.style.display = 'none';
                divErr.removeAttribute('data-automation-id');
            }
        }
    };
    ClientSideWebPartStatusRenderer.prototype._renderSpinner = function (domElement, loadingMessage, showSpinner) {
        if (!this._activeIndicatorCache.has(domElement)) {
            return;
        }
        var cacheEntry = this._getCacheEntry(domElement);
        if (cacheEntry.isErrorBeingRendered) {
            return;
        }
        sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, Strings_resx.DisplayLoadingIndicator);
        if (!cacheEntry.placeholder) {
            var el = external__react_["createElement"](placeHolder_PlaceholderSpinner, { hideSpinner: !showSpinner, label: sp_core_library_["Text"].format(Strings_resx.LoadingStatus, loadingMessage) });
            cacheEntry.placeholder = external__react_dom_["render"](el, domElement);
        }
        else {
            cacheEntry.placeholder.showSpinner(showSpinner);
        }
    };
    ClientSideWebPartStatusRenderer.prototype._getCacheEntry = function (domElement) {
        if (this._activeIndicatorCache.has(domElement)) {
            return this._activeIndicatorCache.get(domElement);
        }
        var cacheEntry = {
            loadingTimer: undefined,
            placeholder: undefined,
            isErrorBeingRendered: false
        };
        this._activeIndicatorCache.set(domElement, cacheEntry);
        return cacheEntry;
    };
    ClientSideWebPartStatusRenderer = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], ClientSideWebPartStatusRenderer);
    return ClientSideWebPartStatusRenderer;
}());
/* harmony default export */ var core_ClientSideWebPartStatusRenderer = (ClientSideWebPartStatusRenderer_ClientSideWebPartStatusRenderer);

// CONCATENATED MODULE: ./lib/core/events/ReservedEventNames.js
var ReservedEventNames = (function () {
    function ReservedEventNames() {
    }
    ReservedEventNames.delimitor = ':';
    ReservedEventNames.configure = 'configure';
    ReservedEventNames.start = 'start';
    ReservedEventNames.end = 'end';
    ReservedEventNames.configureStart = ReservedEventNames.configure
        + ReservedEventNames.delimitor + ReservedEventNames.start;
    ReservedEventNames.configureEnd = ReservedEventNames.configure
        + ReservedEventNames.delimitor + ReservedEventNames.end;
    ReservedEventNames.classicToolpane = 'ClassicToolpane';
    ReservedEventNames.classicToolpaneId = '121ff297-293c-4d66-a24b-916156760cab';
    return ReservedEventNames;
}());
/* harmony default export */ var events_ReservedEventNames = (ReservedEventNames);

// CONCATENATED MODULE: ./lib/core/events/EventAggregator.js




var EventAggregator_EventAggregator = (function () {
    function EventAggregator() {
        this._events = new Map();
        this._sources = new Map();
    }
    EventAggregator.prototype.subscribeByEventName = function (eventName, subscriberId, callback) {
        sp_core_library_["Validate"].isNotNullOrUndefined(eventName, 'eventName');
        this._validateEvent(eventName);
        this._setSubscription(eventName, subscriberId, callback, this._events);
    };
    EventAggregator.prototype.subscribeBySourceId = function (sourceId, subscriberId, callback) {
        sp_core_library_["Validate"].isNotNullOrUndefined(sourceId, 'sourceId');
        this._setSubscription(sourceId, subscriberId, callback, this._sources);
    };
    EventAggregator.prototype.raiseEvent = function (eventName, eventObject) {
        sp_core_library_["Validate"].isNotNullOrUndefined(eventName, 'eventName');
        sp_core_library_["Validate"].isNotNullOrUndefined(eventObject, 'eventObject');
        sp_core_library_["Validate"].isNotNullOrUndefined(eventObject.sourceId, 'eventObject.sourceId');
        var targets = {};
        this._validateEvent(eventName);
        this._processEvent(eventName, eventObject, targets, this._events.get(eventName));
        this._processEvent(eventName, eventObject, targets, this._sources.get(eventObject.sourceId));
    };
    EventAggregator.prototype._validateEvent = function (eventName) {
        var e = eventName.split(events_ReservedEventNames.delimitor);
        if (e.length !== 2) {
            throw new Error('Event ' + eventName + ' not in eventName:action format');
        }
    };
    EventAggregator.prototype._processEvent = function (eventName, eventObject, targets, map) {
        if (map) {
            map.forEach(function (callback, targetId) {
                if (!targets[targetId]) {
                    targets[targetId] = true;
                    callback(eventName, eventObject);
                }
            });
        }
    };
    EventAggregator.prototype._setSubscription = function (id, subscriberId, callback, eventBucket) {
        sp_core_library_["Validate"].isNotNullOrUndefined(subscriberId, 'subscriberId');
        sp_core_library_["Validate"].isNotNullOrUndefined(callback, 'callback');
        if (!eventBucket.get(id)) {
            eventBucket.set(id, new Map());
        }
        var map = eventBucket.get(id);
        map.set(subscriberId, callback);
    };
    EventAggregator = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], EventAggregator);
    return EventAggregator;
}());
/* harmony default export */ var events_EventAggregator = (EventAggregator_EventAggregator);

// CONCATENATED MODULE: ./lib/utils/ExecuteWithoutFailing.js


function executeWithoutFailing(method, logSource) {
    sp_core_library_["Validate"].isNotNullOrUndefined(method, 'method');
    try {
        method();
    }
    catch (e) {
        if (logSource) {
            sp_diagnostics_["_TraceLogger"].logError(logSource, new Error('Error: ' + e));
        }
    }
}

// EXTERNAL MODULE: ./lib/propertyPane/loc/Strings.resx.js
var loc_Strings_resx = __webpack_require__(14);

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneController/PropertyPaneController.module.scss.js
__webpack_require__(26);
var PropertyPaneController_module_scss_styles = {
    showPane: 'showPane_60798c51',
    spPropertyPaneContainer: 'spPropertyPaneContainer_60798c51',
    shrinkContent: 'shrinkContent_60798c51',
};
/* harmony default export */ var PropertyPaneController_module_scss = (PropertyPaneController_module_scss_styles);

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneController/PropertyPaneController.js








var PropertyPaneController_PropertyPaneController = (function () {
    function PropertyPaneController(getConsumer, callback) {
        this._logSource = sp_diagnostics_["_LogSource"].create('PropertyPaneController');
        this._consumers = new Map();
        this._getConsumer = getConsumer;
        this._lifeCycleEventCallback = callback;
        this._constructor();
    }
    PropertyPaneController._create = function (serviceScope) {
        return new PropertyPaneController();
    };
    PropertyPaneController.prototype.registerConsumer = function (instanceId, consumer) {
        sp_core_library_["Validate"].isNonemptyString(instanceId, 'instanceId');
        sp_core_library_["Validate"].isNotNullOrUndefined(consumer, 'consumer');
        this._consumers.set(instanceId, consumer);
    };
    PropertyPaneController.prototype.isConsumerRegistered = function (instanceId) {
        return this._consumers.has(instanceId);
    };
    Object.defineProperty(PropertyPaneController.prototype, "currentlyConfiguredConsumerId", {
        get: function () { return this._currentlyConfiguredConsumerId; },
        enumerable: true,
        configurable: true
    });
    PropertyPaneController.prototype.requestAction = function (toBeConfiguredConsumerId, propertyPaneAction, renderedByWebPart) {
        if (propertyPaneAction === void 0) { propertyPaneAction = 4 ; }
        var noOp = renderedByWebPart &&
            propertyPaneAction === 5  &&
            toBeConfiguredConsumerId !== this._currentlyConfiguredConsumerId;
        if (!noOp) {
            var toBeConfiguredConsumer = this._tryGetConsumer(toBeConfiguredConsumerId);
            this._setPropertyPaneDOMElements();
            var paneWillOpen = !this._isOpen &&
                (propertyPaneAction === 1  || propertyPaneAction === 3 );
            var activeComponentChanged = false;
            if (toBeConfiguredConsumerId &&
                this._currentlyConfiguredConsumerId &&
                (toBeConfiguredConsumerId !== this._currentlyConfiguredConsumerId || paneWillOpen)) {
                activeComponentChanged = true;
                if (toBeConfiguredConsumer && (this._isOpen || paneWillOpen)) {
                    toBeConfiguredConsumer._loadPropertyPaneResources();
                }
                this._fireConfigurationEvent(toBeConfiguredConsumerId, 7 );
            }
            if (propertyPaneAction !== 5 ) {
                if (propertyPaneAction === 3 ) {
                    var internalToOverallComponentEdit = !!this._isPaneRenderedByWebPart !== !!renderedByWebPart;
                    if (!activeComponentChanged && internalToOverallComponentEdit) {
                        propertyPaneAction = 5 ;
                    }
                }
                this._isPaneRenderedByWebPart = !!renderedByWebPart;
            }
            this._executeAction(toBeConfiguredConsumer, toBeConfiguredConsumerId, propertyPaneAction);
            this._currentlyConfiguredConsumerId = toBeConfiguredConsumerId;
        }
        else {
            sp_diagnostics_["_TraceLogger"].logVerbose(this._logSource, sp_core_library_["Text"].format(loc_Strings_resx["a" /* default */].NoOpOnRefreshPropertyPaneText, toBeConfiguredConsumerId));
        }
    };
    PropertyPaneController.prototype.isRenderedByConsumer = function () {
        return this._isPaneRenderedByWebPart;
    };
    PropertyPaneController.prototype.isOpen = function () {
        return this._isOpen;
    };
    PropertyPaneController.prototype.onConsumerDelete = function (id) {
        sp_core_library_["Validate"].isNonemptyString(id, 'id');
        if (id === this._currentlyConfiguredConsumerId) {
            if (this._isOpen) {
                this._renderPropertyPane(undefined, true);
            }
            this._currentlyConfiguredConsumerId = undefined;
        }
    };
    PropertyPaneController.prototype._constructor = function () {
        this._propertyPaneContainerId = sp_core_library_["Environment"].type !== sp_core_library_["EnvironmentType"].ClassicSharePoint ?
            PropertyPaneController.PROPERTY_PANE_CONTAINER_ID :
            PropertyPaneController.PROPERTY_PANE_CONTAINER_NOFLEXBOX_ID;
        this._onPropertyPaneFieldChanged = this._onPropertyPaneFieldChanged.bind(this);
        this._onConfigurationEvent = this._onConfigurationEvent.bind(this);
        this._fireConfigurationEvent = this._fireConfigurationEvent.bind(this);
    };
    PropertyPaneController.prototype._executeAction = function (toBeConfiguredConsumer, toBeConfiguredConsumerInstanceId, propertyPaneAction) {
        switch (propertyPaneAction) {
            case 1 :
                var paneOpenBeforeRender = this._isOpen;
                this._renderPropertyPane(toBeConfiguredConsumer, true, true);
                this._showPropertyPane();
                if (paneOpenBeforeRender) {
                    this._fireNoToggleConfigurationEvents(toBeConfiguredConsumerInstanceId);
                }
                else {
                    this._firePostToggleConfigurationEvents();
                }
                break;
            case 2 :
                if (this._isOpen) {
                    this._hidePropertyPane();
                    this._firePostToggleConfigurationEvents();
                }
                break;
            case 3 :
                if (this._isOpen) {
                    this._hidePropertyPane();
                }
                else {
                    this._renderPropertyPane(toBeConfiguredConsumer, true, true);
                    this._showPropertyPane();
                }
                this._firePostToggleConfigurationEvents();
                break;
            case 4 :
                if (this._isOpen) {
                    this._fireNoToggleConfigurationEvents(toBeConfiguredConsumerInstanceId);
                    var reset = false;
                    if (common_KillSwitches.isPropertyPaneDefaultActionUsingFalseResetKillSwitchActivated()) {
                        reset = true;
                    }
                    if (this._isCurrentlyConfiguredPropertyPaneReactive) {
                        this._renderPropertyPane(toBeConfiguredConsumer, true, reset);
                    }
                    else {
                        this._renderPropertyPane(toBeConfiguredConsumer, true, reset);
                    }
                }
                break;
            case 5 :
                if (this._isOpen) {
                    this._renderPropertyPane(toBeConfiguredConsumer, true, false);
                }
                break;
        }
        if (this._isOpen !== false && toBeConfiguredConsumer) {
            var wpContext = toBeConfiguredConsumer.context; 
            var wpAlias = wpContext && wpContext._manifest && wpContext._manifest.alias;
            var isInternal = wpContext && wpContext._manifest && wpContext._manifest.isInternal || false;
            var logEntry = new sp_diagnostics_["_LogEntry"](this._logSource.id, 'PropertyPaneOpened', sp_diagnostics_["_LogType"].Event, {
                'alias': wpAlias,
                'isInternal': isInternal.toString()
            });
            sp_diagnostics_["_EngagementLogger"].logEventWithLogEntry(logEntry);
        }
    };
    PropertyPaneController.prototype._showPropertyPane = function () {
        if (this._pageContentElement) {
            this._pageContentElement.classList.add(PropertyPaneController_module_scss.shrinkContent);
        }
        else {
            this._propertyPaneContainer.style.top = '50px';
            this._propertyPaneContainer.style.zIndex = '999';
        }
        if (this._workbenchCommandBarElement) {
            this._workbenchCommandBarElement.classList.add(PropertyPaneController_module_scss.shrinkContent);
        }
        this._propertyPaneContainer.classList.add(PropertyPaneController_module_scss.showPane);
        this._isOpen = true;
    };
    PropertyPaneController.prototype._hidePropertyPane = function () {
        if (this._pageContentElement) {
            this._pageContentElement.classList.remove(PropertyPaneController_module_scss.shrinkContent);
        }
        else {
            external__react_dom_["unmountComponentAtNode"](this._propertyPaneElement);
        }
        if (this._workbenchCommandBarElement) {
            this._workbenchCommandBarElement.classList.remove(PropertyPaneController_module_scss.shrinkContent);
        }
        this._propertyPaneContainer.classList.remove(PropertyPaneController_module_scss.showPane);
        this._isOpen = false;
    };
    PropertyPaneController.prototype._renderPropertyPane = function (currentConsumer, recreatePropertyPane, reset) {
        var _this = this;
        var qosMonitor = new sp_diagnostics_["_QosMonitor"]('PropertyPaneController.renderPropertyPane');
        if (currentConsumer) {
            currentConsumer._getPropertyPaneData().then(function (data) {
                if (_this._currentlyConfiguredConsumerId === data.webPartId) {
                    _this._buildAndLoadPropertyPane(data, reset);
                }
            }).catch(function (error) {
                sp_diagnostics_["_TraceLogger"].logErrorData({
                    source: _this._logSource,
                    error: error
                });
                qosMonitor.writeUnexpectedFailure('UnhandledError', error);
                throw error;
            });
        }
        else {
            this._currentPropertyPaneData = this._getEmptyPropertyPaneData();
            this._loadPropertyPaneComponent(recreatePropertyPane);
        }
    };
    PropertyPaneController.prototype._buildAndLoadPropertyPane = function (propertyPaneData, reset) {
        var _this = this;
        this._currentPropertyPaneData = propertyPaneData;
        propertyPaneData.onPropertyPaneFieldChanged = this._onPropertyPaneFieldChanged;
        propertyPaneData.onConfigurationEvent = this._onConfigurationEvent;
        propertyPaneData.render = function () { _this._reRender(); };
        propertyPaneData.shouldResetState = reset;
        if (propertyPaneData.configuration &&
            propertyPaneData.configuration.showLoadingIndicator) {
            var delay = propertyPaneData.configuration.loadingIndicatorDelayTime === undefined ?
                500 : propertyPaneData.configuration.loadingIndicatorDelayTime;
            setTimeout(function () {
                if (propertyPaneData.configuration.showLoadingIndicator) {
                    _this._loadPropertyPaneComponent(true);
                }
            }, delay);
        }
        else {
            this._loadPropertyPaneComponent(true);
        }
    };
    PropertyPaneController.prototype._loadPropertyPaneComponent = function (recreatePropertyPane) {
        var _this = this;
        __webpack_require__.e/* import() */(0).then(__webpack_require__.bind(null, 136))
            .then(function (propertyPane) {
            var insertIntoDom = false;
            if (recreatePropertyPane) {
                if (!_this._propertyPaneElement) {
                    _this._propertyPaneElement = document.createElement('div');
                    insertIntoDom = true;
                }
            }
            _this._propertyPaneElement.className = _this._currentPropertyPaneData.webPartId;
            var el = external__react_["createElement"](propertyPane.default, { data: _this._currentPropertyPaneData });
            external__react_dom_["render"](el, _this._propertyPaneElement);
            if (_this._propertyPaneContainer) {
                if (insertIntoDom) {
                    _this._clearPropertyPaneContainer();
                    _this._propertyPaneContainer.appendChild(_this._propertyPaneElement);
                }
            }
            else {
                if (insertIntoDom && document.body.lastChild) {
                    document.body.insertBefore(_this._propertyPaneElement, document.body.lastChild.nextSibling);
                }
            }
        });
    };
    PropertyPaneController.prototype._reRender = function () {
        var consumer = this._tryGetConsumer(this._currentPropertyPaneData.webPartId);
        if (consumer) {
            this._renderPropertyPane(consumer);
        }
    };
    PropertyPaneController.prototype._onPropertyPaneFieldChanged = function (propertyName, newValue) {
        sp_core_library_["Validate"].isNonemptyString(propertyName, 'propertyName');
        if (!this._currentPropertyPaneData.webPartId) {
            throw new Error('onPropertyPaneFieldChanged event is not expected when no consumer is being configured');
        }
        var consumer = this._tryGetConsumer(this._currentPropertyPaneData.webPartId);
        if (consumer) {
            consumer._onPropertyPaneFieldChanged(propertyName, newValue);
            this._renderPropertyPane(consumer);
        }
        if (this._isCurrentlyConfiguredPropertyPaneReactive()) {
            this._resetConfigurationCompleteTimeout();
        }
    };
    PropertyPaneController.prototype._onConfigurationEvent = function (configurationEvent) {
        switch (configurationEvent) {
            case 4 :
                this._hidePropertyPane();
                this._firePostToggleConfigurationEvents();
                break;
            case 5 :
            case 6 :
                this._fireConfigurationEvent(this._currentlyConfiguredConsumerId, configurationEvent);
                this._fireConfigurationEvent(this._currentlyConfiguredConsumerId, 2 );
                break;
        }
    };
    PropertyPaneController.prototype._firePostToggleConfigurationEvents = function () {
        var _this = this;
        if (this._isOpen) {
            window.setTimeout(function () {
                _this._fireConfigurationEvent(_this._currentlyConfiguredConsumerId, 3 );
                _this._fireConfigurationEvent(_this._currentlyConfiguredConsumerId, 1 );
                window.postMessage('Property pane toggled', window.location.origin);
            }, PropertyPaneController.ANIMATION_TIMEOUT);
        }
        else {
            this._fireConfigurationEvent(this._currentlyConfiguredConsumerId, 2 );
            window.setTimeout(function () {
                _this._fireConfigurationEvent(_this._currentlyConfiguredConsumerId, 4 );
                window.postMessage('Property pane toggled', window.location.origin);
            }, PropertyPaneController.ANIMATION_TIMEOUT);
        }
    };
    PropertyPaneController.prototype._fireNoToggleConfigurationEvents = function (id) {
        this._fireConfigurationEvent(this._currentlyConfiguredConsumerId, 2 );
        this._fireConfigurationEvent(id, 1 );
    };
    PropertyPaneController.prototype._fireConfigurationEvent = function (componentId, configurationEvent) {
        this._clearConfigurationCompleteTimeout();
        var consumer = this._tryGetConsumer(componentId);
        if (consumer) {
            if (this._lifeCycleEventCallback) {
                this._lifeCycleEventCallback(configurationEvent, componentId);
            }
            consumer._onPropertyPaneLifeCycleEvent(configurationEvent);
        }
    };
    PropertyPaneController.prototype._setPropertyPaneDOMElements = function () {
        var workbenchElement = document.getElementById('workbenchPageContent');
        if (workbenchElement) {
            this._pageContentElement = workbenchElement;
            this._workbenchCommandBarElement = document.getElementById('workbenchCommandBar');
        }
        else {
            this._pageContentElement = document.getElementById('spPageChromeAppDiv');
        }
        if (!this._pageContentElement) {
            if (!this._propertyPaneContainer) {
                this._propertyPaneContainer = document.createElement('div');
                this._propertyPaneContainer.id = this._propertyPaneContainerId;
                this._propertyPaneContainer.className = this._propertyPaneContainerId;
                document.body.appendChild(this._propertyPaneContainer);
            }
        }
        else {
            this._propertyPaneContainer = document.getElementById(this._propertyPaneContainerId) ||
                document.getElementById(PropertyPaneController.PROPERTY_PANE_CONTAINER_NOFLEXBOX_ID);
        }
    };
    PropertyPaneController.prototype._clearPropertyPaneContainer = function () {
        while (this._propertyPaneContainer && this._propertyPaneContainer.firstChild) {
            this._propertyPaneContainer.removeChild(this._propertyPaneContainer.firstChild);
        }
    };
    PropertyPaneController.prototype._resetConfigurationCompleteTimeout = function () {
        this._clearConfigurationCompleteTimeout();
        this._configurationCompletionTimeout = window.setTimeout(this._fireConfigurationEvent, PropertyPaneController.CONFIGURATION_COMPLETE_TIMEOUT, this._currentlyConfiguredConsumerId, 2 );
    };
    PropertyPaneController.prototype._clearConfigurationCompleteTimeout = function () {
        if (this._configurationCompletionTimeout) {
            window.clearTimeout(this._configurationCompletionTimeout);
            this._configurationCompletionTimeout = undefined;
        }
    };
    PropertyPaneController.prototype._isCurrentlyConfiguredPropertyPaneReactive = function () {
        if (this._currentlyConfiguredConsumerId) {
            var consumer = this._tryGetConsumer(this._currentlyConfiguredConsumerId);
            var isReactive = this._currentPropertyPaneData ?
                this._currentPropertyPaneData.isReactive :
                consumer && !consumer._isPropertyPaneReactive();
            return !!isReactive;
        }
        return false;
    };
    PropertyPaneController.prototype._tryGetConsumer = function (id) {
        var consumer;
        if (!common_KillSwitches.isPropertyPaneControllerFromServiceScopeKillSwitchActivated()) {
            consumer = this._consumers.get(id);
        }
        else {
            consumer = this._getConsumer(id);
        }
        return consumer;
    };
    PropertyPaneController.prototype._getEmptyPropertyPaneData = function () {
        return {
            webPartId: undefined,
            title: undefined,
            shouldResetState: true,
            onPropertyPaneFieldChanged: undefined,
            onConfigurationEvent: this._onConfigurationEvent,
            onRendered: undefined,
            properties: undefined,
            configuration: undefined,
            dynamicConfiguration: undefined
        };
    };
    PropertyPaneController.serviceKey = sp_core_library_["ServiceKey"].createCustom('sp-property-pane:PropertyPaneController', PropertyPaneController._create);
    PropertyPaneController.ANIMATION_TIMEOUT = 400;
    PropertyPaneController.CONFIGURATION_COMPLETE_TIMEOUT = 5000;
    PropertyPaneController.PROPERTY_PANE_CONTAINER_ID = 'spPropertyPaneContainer';
    PropertyPaneController.PROPERTY_PANE_CONTAINER_NOFLEXBOX_ID = 'spPropertyPaneContainerNoFlexbox';
    return PropertyPaneController;
}());
/* harmony default export */ var propertyPaneController_PropertyPaneController = (PropertyPaneController_PropertyPaneController);

// CONCATENATED MODULE: ./lib/core/loaders/sp-webpart-base-IframedWebPartController.js
function IframedWebPartControllerLoader() {
    return __webpack_require__.e/* import() */(2).then(__webpack_require__.bind(null, 137)).then(function (iframedWebPartControllerModule) { return iframedWebPartControllerModule.default; });
}

// CONCATENATED MODULE: ./lib/core/ClientSideWebPartManager.js
























var THUMBNAIL_MAX_URL_LENGTH = 255; 
var SPPPLAT_IFRAMED_WEBPART_CONTROLLER_FLIGHT_ID = 3289;
var ClientSideWebPartManager_ClientSideWebPartManager = (function () {
    function ClientSideWebPartManager(host) {
        this._webparts = new Map();
        this._logSource = sp_diagnostics_["_LogSource"].create('ClientSideWebPartManager');
        this._eventAggregator = new events_EventAggregator();
        this._loadWebPartRequests = 0;
        this._statusRenderer = new core_ClientSideWebPartStatusRenderer();
        this._iframedWebpartInstanceIds = new Set();
        sp_core_library_["Validate"].isNotNullOrUndefined(host, 'host');
        this._host = host;
        this._pageContext = host.serviceScope.consume(sp_page_context_["PageContext"].serviceKey);
        this._propertyPaneController =
            host.serviceScope.consume(propertyPaneController_PropertyPaneController.serviceKey);
        this._onContainerResize = this._onContainerResize.bind(this);
        this._onPropertyPaneToggled = this._onPropertyPaneToggled.bind(this);
        this.requestPropertyPaneAction = this.requestPropertyPaneAction.bind(this);
        this.isPropertyPaneRenderedByWebPart = this.isPropertyPaneRenderedByWebPart.bind(this);
        this.isPropertyPaneOpen = this.isPropertyPaneOpen.bind(this);
        this._instantiateWebPart = this._instantiateWebPart.bind(this);
        this._handleErrorLoadingWebpart = this._handleErrorLoadingWebpart.bind(this);
        this._handleModulePromiseRejection = this._handleModulePromiseRejection.bind(this);
        this._onFirstTimeWebpartRender = this._onFirstTimeWebpartRender.bind(this);
        this._getViewportRenderedEndTime = this._getViewportRenderedEndTime.bind(this);
        this._onAllWebpartsAdded = this._onAllWebpartsAdded.bind(this);
        if (ClientSideWebPartManager._webPartManagerList.length === 0) {
            this._initialzeOnResizeEventHandler();
        }
        ClientSideWebPartManager._webPartManagerList.push(this);
    }
    ClientSideWebPartManager._shouldLoadDynamicDependencies = function () {
        return sp_core_library_["_SPFlight"].isEnabled(77 );
    };
    ClientSideWebPartManager._addPerfEUPLBreakdown = function (key, value, addToExistingValue) {
        if (addToExistingValue === void 0) { addToExistingValue = false; }
        if (addToExistingValue) {
            var previousValue = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(key);
            if (previousValue && !isNaN(previousValue)) {
                value = value + previousValue;
            }
        }
        sp_telemetry_["_PerformanceLogger"].addEUPLBreakdown(key, { data: value, needFlatten: true });
    };
    Object.defineProperty(ClientSideWebPartManager, "isMaintenanceMode", {
        get: function () {
            var urlParams = new sp_core_library_["UrlQueryParameterCollection"](window.location.href);
            return urlParams.getValue('maintenanceMode') === 'true';
        },
        enumerable: true,
        configurable: true
    });
    ClientSideWebPartManager.prototype.loadWebPart = function (context) {
        var _this = this;
        this._loadWebPartRequests++;
        var instanceRequestCount = this._loadWebPartRequests;
        var loadModulePromise = undefined;
        var loadWebPartPromise = new Promise(function (resolve, reject) {
            _this._validateInput(context);
            if (sp_core_library_["_SPFlight"].isEnabled(SPPPLAT_IFRAMED_WEBPART_CONTROLLER_FLIGHT_ID) &&
                context.webpartLoadExtraLogInfo.pageLayoutType &&
                context.webpartLoadExtraLogInfo.pageLayoutType !== 'MinimalWebPartContainer' &&
                context.manifest.isolationLevel === WebPartIsolationLevel.DomIsolation) {
                _this._iframedWebpartInstanceIds.add(context.webPartData.instanceId);
                return IframedWebPartControllerLoader().then(function (iframedWebPartControllerModule) {
                    _this._iframedWebPartController = new iframedWebPartControllerModule();
                    resolve(_this._iframedWebPartController.loadWebPart(_this._pageContext.site.absoluteUrl, _this._pageContext.list.id, _this._pageContext.listItem.id, context.instanceId, context.domElement));
                });
            }
            else {
                var qosMonitor_1 = _this._createLoadQosMonitor(context.manifest);
                var webPartTag_1 = _this._createWebPartTag(context.manifest, context.instanceId);
                sp_diagnostics_["_TraceLogger"].logVerboseData({
                    source: _this._logSource,
                    message: sp_core_library_["Text"].format(Strings_resx.LoadWebpartCalled, _this._loadWebPartRequests, context.totalWebparts, context.manifest.alias + "." + context.instanceId),
                    serviceScope: _this._host.serviceScope
                });
                sp_telemetry_["_PerformanceLogger"].devMark("ClientSideWebPartManager.loadWebPart(" + webPartTag_1 + ").start");
                if (context.displayMode === undefined) {
                    context.displayMode = sp_core_library_["DisplayMode"].Read;
                }
                sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webParts);
                var webpartLoadExtraData = context.webpartLoadExtraLogInfo;
                webpartLoadExtraData.alias = _this._createWebPartTag(context.manifest, context.manifest.id);
                var logEntry = new sp_diagnostics_["_LogEntry"]('ClientSideWebPartManager', 'WebPartLoad', sp_diagnostics_["_LogType"].Event, webpartLoadExtraData);
                sp_diagnostics_["_EngagementLogger"].logEventWithLogEntry(logEntry);
                if (!_this._validateManifest(context.manifest, context.displayMode, webPartTag_1)) {
                    _this.renderError(context.domElement, SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.ManifestInvalid, webPartTag_1));
                    return;
                }
                var manifest_1 = context.manifest; 
                var instanceId_1 = context.instanceId;
                var domElement_1 = context.domElement;
                var title = context.webPartData && context.webPartData.title
                    ? context.webPartData.title
                    : (manifest_1.title && manifest_1.title.default 
                        ? manifest_1.title.default 
                        : manifest_1.preconfiguredEntries[0].title.default);
                _this._statusRenderer.displayLoadingIndicator(domElement_1, title);
                sp_telemetry_["_PerformanceLogger"].startMarkForComponent(webPartTag_1);
                loadModulePromise = _this._loadWebPartModules(context, webPartTag_1, qosMonitor_1);
                loadModulePromise.then(function (baseComponent) {
                    sp_telemetry_["_PerformanceLogger"].devMark("ClientSideWebPartManager.loadWebPart(" + webPartTag_1 + ").end");
                    try {
                        _this._initializeWebPart({
                            context: context,
                            moduleLibrary: baseComponent,
                            webPartTag: webPartTag_1,
                            qosMonitor: qosMonitor_1
                        });
                    }
                    catch (error) {
                        reject(error);
                        return;
                    }
                    return _this._renderWebPart({
                        context: context,
                        webPartTag: webPartTag_1,
                        qosMonitor: qosMonitor_1,
                        instanceRequestCount: instanceRequestCount
                    })
                        .then(function () {
                        sp_telemetry_["_PerformanceLogger"].endMarkForComponent(webPartTag_1);
                        _this._onFirstTimeWebpartRender(manifest_1, webPartTag_1, qosMonitor_1);
                        resolve();
                    }).catch(reject); 
                })
                    .then(function () {
                    return sp_component_base_["_LegacyThirdPartyFabricCoreLoader"].load(context.manifest.isInternal)
                        .then(resolve)
                        .catch(function (error) {
                        sp_diagnostics_["_TraceLogger"].logErrorData({
                            source: _this._logSource,
                            error: error,
                            serviceScope: _this._host.serviceScope
                        });
                        qosMonitor_1.writeUnexpectedFailure('Error loading legacy-third-party-fabric-core.', error);
                        reject(error);
                    });
                })
                    .catch(function (err) {
                    _this._handleModulePromiseRejection(manifest_1, instanceId_1, domElement_1, webPartTag_1, err, qosMonitor_1);
                    reject(err);
                });
            }
        });
        if (sp_core_library_["Environment"].type !== sp_core_library_["EnvironmentType"].ClassicSharePoint &&
            context.totalWebparts &&
            context.totalWebparts === instanceRequestCount) {
            var addedPromise = loadModulePromise ||
                Promise.reject('No module promise');
            addedPromise.then(function () {
                sp_diagnostics_["_TraceLogger"].logVerboseData({
                    source: _this._logSource,
                    message: "All " + context.totalWebparts + " web parts requested to load, has been processed",
                    serviceScope: _this._host.serviceScope
                });
                ClientSideWebPartManager._addPerfEUPLBreakdown('allWebPartsAdded', sp_telemetry_["_PerformanceLogger"].now());
                _this._onAllWebpartsAdded(context);
            }, function () { return _this._onAllWebpartsAdded(context || { totalWebparts: 1 }); });
        }
        return loadWebPartPromise;
    };
    ClientSideWebPartManager.prototype.setPropertyPaneConsumer = function (id, control) {
        sp_core_library_["Validate"].isNonemptyString(id, 'id');
        sp_core_library_["Validate"].isNotNullOrUndefined(control, 'control');
        this._webparts.set(id, control);
        this._registerWebPartAsPropertyPaneConsumer(id);
    };
    ClientSideWebPartManager.prototype.fetchWebPartManifests = function () {
        var _this = this;
        if (!this._toolboxManifestsPromise && (
        !this._pageContext.web ||
            !this._pageContext.web.serverRelativeUrl ||
            sp_core_library_["Environment"].type === sp_core_library_["EnvironmentType"].Local ||
            sp_core_library_["Environment"].type === sp_core_library_["EnvironmentType"].Test)) {
            this._toolboxManifestsPromise = Promise.resolve();
        }
        if (!this._toolboxManifestsPromise) {
            var requestCorrelationId_1;
            var qosMonitor_2 = new sp_diagnostics_["_QosMonitor"]('ClientSideWebPartManager.FetchWebParts');
            var requestUrl_1 = sp_core_library_["UrlUtilities"].removeEndSlash(this._pageContext.web.serverRelativeUrl) + "/_api/web/GetClientSideWebParts";
            this._host.serviceScope.whenFinished(function () {
                var httpClient = _this._host.serviceScope.consume(sp_http_["SPHttpClient"].serviceKey);
                _this._toolboxManifestsPromise = httpClient.get(requestUrl_1, sp_http_["SPHttpClient"].configurations.v1)
                    .then(function (response) {
                    requestCorrelationId_1 = response.correlationId ? response.correlationId.toString() : undefined;
                    return response.json();
                })
                    .then(function (value) {
                    var manifests = value.value.map(function (manifestObject) { return JSON.parse(manifestObject.Manifest); });
                    _this._disambiguateWebPartManifestLocales(manifests);
                    sp_loader_["SPComponentLoader"].registerManifests(manifests);
                    sp_diagnostics_["_TraceLogger"].logVerboseData({
                        source: _this._logSource,
                        message: Strings_resx.CompletedLoadingWebPartManifests,
                        serviceScope: _this._host.serviceScope
                    });
                    qosMonitor_2.writeSuccess();
                })
                    .catch(function (error) {
                    _this._toolboxManifestsPromise = undefined;
                    sp_diagnostics_["_TraceLogger"].logErrorData({
                        source: _this._logSource,
                        error: error,
                        serviceScope: _this._host.serviceScope
                    });
                    qosMonitor_2.writeUnexpectedFailure('Rejected', error, {
                        correlationId: requestCorrelationId_1
                    });
                    throw error;
                });
            });
        }
        return this._toolboxManifestsPromise;
    };
    ClientSideWebPartManager.prototype.getWebPartManifests = function () {
        var manifests = sp_loader_["SPComponentLoader"].getManifests();
        var result = []; 
        if (manifests) {
            for (var _i = 0, manifests_1 = manifests; _i < manifests_1.length; _i++) {
                var manifest = manifests_1[_i];
                if (manifest && manifest.componentType === 'WebPart') {
                    result.push(manifest); 
                }
            }
        }
        return result;
    };
    ClientSideWebPartManager.prototype.setDisplayMode = function (displayMode, instanceId) {
        this._executeForIdsOrAll(this._getArrayOrUndefined(instanceId), function (wp) {
            wp._internalSetDisplayMode(displayMode);
        });
        this._startDirtyBitTimer(displayMode);
    };
    ClientSideWebPartManager.prototype.serialize = function (instanceId) {
        var sd = new Map();
        this._executeForIdsOrAll(this._getArrayOrUndefined(instanceId), function (wp, _instanceId) {
            sd.set(_instanceId, wp._internalSerialize());
        });
        return sd;
    };
    ClientSideWebPartManager.prototype.setWebPartData = function (webPartData, instanceId) {
        sp_core_library_["Validate"].isNotNullOrUndefined(webPartData, 'web part data');
        sp_core_library_["Validate"].isNonemptyString(instanceId, 'web part instance id');
        var wp = this._webparts.get(instanceId);
        if (wp) {
            wp._internalSetWebPartData(webPartData);
            sp_core_library_["_SPEventManager"].instance.raiseEvent(this._getDataUpdatedEventName(webPartData.instanceId), {});
        }
    };
    ClientSideWebPartManager.prototype.dispose = function () {
        this.disposeWebparts();
        var currentIdx = ClientSideWebPartManager._webPartManagerList.indexOf(this);
        if (currentIdx >= 0) {
            ClientSideWebPartManager._webPartManagerList.splice(currentIdx, 1);
        }
    };
    ClientSideWebPartManager.prototype.disposeWebparts = function (instanceId) {
        var _this = this;
        this._executeForIdsOrAll(this._getArrayOrUndefined(instanceId), function (wp, _instanceId) {
            _this._deleteWebPart(_instanceId);
            executeWithoutFailing(function () { wp._internalDispose(); }, _this._logSource);
        });
    };
    ClientSideWebPartManager.prototype.tryGeneratePreviewImageUrl = function (instanceIds) {
        var _this = this;
        var previewImageUrl = undefined;
        var previewFromAlias = undefined;
        this._executeForIdsOrAll(instanceIds, function (wp, id) {
            if (!previewImageUrl) {
                var webParthThumbnail = wp.previewImageUrl;
                if (webParthThumbnail) {
                    previewFromAlias = wp.context.manifest.alias;
                    if (webParthThumbnail.length < THUMBNAIL_MAX_URL_LENGTH) {
                        previewImageUrl = wp.previewImageUrl;
                    }
                    else {
                        sp_diagnostics_["_TraceLogger"].logVerboseData({
                            source: _this._logSource,
                            eventName: 'tryGeneratePreviewImageUrl',
                            message: previewFromAlias + " attempted preview URL of " + wp.previewImageUrl.length + " chars."
                        });
                    }
                }
            }
        });
        if (!previewImageUrl && previewFromAlias) {
            var pathLengthError = new Error('tryGeneratePreviewImageUrl PathLengthError.');
            sp_diagnostics_["_TraceLogger"].logError(this._logSource, pathLengthError);
            throw pathLengthError;
        }
        return previewImageUrl;
    };
    ClientSideWebPartManager.prototype.requestPropertyPaneAction = function (instanceId, propertyPaneAction, renderedByWebPart) {
        if (propertyPaneAction === void 0) { propertyPaneAction = 4 ; }
        if (this._iframedWebpartInstanceIds.has(instanceId)) {
            if (this._propertyPaneController &&
                this._propertyPaneController.isOpen()) {
                this._propertyPaneController.requestAction(instanceId, 2 , renderedByWebPart);
            }
            this._iframedWebPartController.requestPropertyPaneAction(instanceId, propertyPaneAction);
        }
        else {
            if (this._iframedWebPartController) {
                this._iframedWebPartController.requestPropertyPaneAction(instanceId, 2 );
            }
            if (!common_KillSwitches.isPropertyPaneControllerFromServiceScopeKillSwitchActivated()) {
                this._propertyPaneController.requestAction(instanceId, propertyPaneAction, renderedByWebPart);
            }
            else {
                if (!ClientSideWebPartManager._legacyPropertyPaneController) {
                    ClientSideWebPartManager._legacyPropertyPaneController =
                        new propertyPaneController_PropertyPaneController(function (wpId) {
                            var wp = undefined;
                            for (var i = 0; i < ClientSideWebPartManager._webPartManagerList.length; i++) {
                                wp = ClientSideWebPartManager._webPartManagerList[i]._webparts.get(wpId);
                                if (wp) {
                                    break;
                                }
                            }
                            return wp;
                        }, this._propertyPaneLifeCycleEventCallback);
                }
                ClientSideWebPartManager._legacyPropertyPaneController.requestAction(instanceId, propertyPaneAction, renderedByWebPart);
            }
        }
    };
    ClientSideWebPartManager.prototype.isPropertyPaneRenderedByWebPart = function () {
        return this._propertyPaneController.isRenderedByConsumer();
    };
    ClientSideWebPartManager.prototype.isPropertyPaneOpen = function () {
        return this._propertyPaneController.isOpen();
    };
    ClientSideWebPartManager.prototype.onWebPartDelete = function (instanceId) {
        this.disposeWebparts(instanceId);
    };
    ClientSideWebPartManager.prototype.renderError = function (domElement, error) {
        var _this = this;
        executeWithoutFailing(function () {
            _this._statusRenderer.renderError(domElement, error);
            sp_diagnostics_["_TraceLogger"].logErrorData({
                source: _this._logSource,
                error: error,
                serviceScope: _this._host.serviceScope
            });
        }, this._logSource);
    };
    ClientSideWebPartManager.prototype.notifyWebPartContainerResize = function (instanceId) {
        this._executeForIdsOrAll(this._getArrayOrUndefined(instanceId), function (wp, _instanceId) {
            wp._internalOnAfterResize();
        });
    };
    ClientSideWebPartManager.prototype._getWebPartContext = function (context) {
        var webPartTag = this._createWebPartTag(context.manifest, context.instanceId);
        var parameters = {
            parentServiceScope: context.serviceScope || this._host.serviceScope,
            manifest: this._getManifestInstance(context),
            instanceId: context.instanceId,
            webPartTag: webPartTag,
            domElement: context.domElement,
            statusRenderer: this._statusRenderer,
            eventAggregator: this._eventAggregator,
            isPropertyPaneRenderedByWebPart: this.isPropertyPaneRenderedByWebPart,
            isPropertyPaneOpen: this.isPropertyPaneOpen,
            host: this._host,
            requestPropertyPaneAction: this.requestPropertyPaneAction,
            loggingTag: webPartTag,
            _dataUpdatedEvent: new sp_core_library_["SPEvent"](this._getDataUpdatedEventName(context.instanceId))
        };
        var webPartContext = new core_WebPartContext(parameters);
        return webPartContext;
    };
    ClientSideWebPartManager.prototype._loadWebPartModules = function (context, webPartTag, qosMonitor) {
        sp_diagnostics_["_TraceLogger"].logVerboseData({
            source: this._logSource,
            message: sp_core_library_["Text"].format(Strings_resx.StartedLoadingWebPart, webPartTag),
            serviceScope: this._host.serviceScope
        });
        var modulePromise = sp_loader_["SPComponentLoader"].loadComponent(context.manifest);
        var moduleLoadPromises = [];
        moduleLoadPromises.push(modulePromise);
        this._loadDynamicComponentDependencies(context.webPartData, webPartTag, moduleLoadPromises);
        return Promise.all(moduleLoadPromises)
            .then(function (moduleLibraries) {
            sp_telemetry_["_PerformanceLogger"].devMark("ClientSideWebPartManager.loadWebPart(" + webPartTag + ").end");
            return Promise.resolve(moduleLibraries[0]);
        })
            .catch(function (error) {
            return modulePromise;
        });
    };
    ClientSideWebPartManager.prototype._disambiguateWebPartManifestLocales = function (manifests) {
        var currentLocale = this._pageContext.cultureInfo.currentUICultureName
            ? this._pageContext.cultureInfo.currentUICultureName.toLowerCase()
            : undefined;
        if (currentLocale) {
            var disambiguateLocale_1 = function (values) {
                var foundMatch = undefined;
                for (var locale in values) {
                    if (locale && locale.toLowerCase() === currentLocale && values[locale]) {
                        foundMatch = values[locale];
                        break;
                    }
                }
                return {
                    default: foundMatch || values.default
                };
            };
            manifests.forEach(function (manifest) {
                if (manifest.componentType === 'WebPart') {
                    var wpManifest = manifest;
                    wpManifest.preconfiguredEntries.forEach(function (entry) {
                        entry.title = disambiguateLocale_1(entry.title);
                        entry.description = disambiguateLocale_1(entry.description);
                        if (entry.group) {
                            entry.group = disambiguateLocale_1(entry.group);
                        }
                    });
                }
            });
        }
    };
    ClientSideWebPartManager.prototype._validateInput = function (context) {
        sp_core_library_["Validate"].isNotNullOrUndefined(context, 'web part manager context');
        sp_core_library_["Validate"].isNotNullOrUndefined(context.domElement, 'web part element');
        sp_core_library_["Validate"].isNotNullOrUndefined(context.instanceId, 'web part instanceId');
        sp_core_library_["Validate"].isNotNullOrUndefined(context.manifest, 'web part manifest');
        sp_core_library_["Validate"].isTrue(!this._webparts.get(context.instanceId), "Duplicate web part instanceId is not allowed: " + context.instanceId);
    };
    ClientSideWebPartManager.prototype._validateManifest = function (manifest,  mode, webPartTag) {
        if (!manifest) {
            if (mode === sp_core_library_["DisplayMode"].Read) {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.ManifestNull, webPartTag);
            }
            else {
                return false;
            }
        }
        var cm = sp_lodash_subset_["cloneDeep"](manifest);
        sp_core_library_["Validate"].isTrue(cm.manifestVersion == 2, 'Only version 2 manifests are currently supported');
        sp_core_library_["Validate"].isTrue(!!cm.id, 'web part id cannot be null or undefined');
        sp_core_library_["Validate"].isNotNullOrUndefined(sp_core_library_["Guid"].tryParse(cm.id), 'web part id has to be a GUID');
        sp_core_library_["Validate"].isTrue(!!cm.version, 'webp art version cannot be null or undefined');
        return true;
    };
    ClientSideWebPartManager.prototype._executeForIdsOrAll = function (instanceIds, cb) {
        var _this = this;
        if (instanceIds) {
            instanceIds.forEach(function (id) {
                var wp = _this._webparts.get(id);
                if (wp) {
                    cb(wp, id);
                }
            });
        }
        else {
            this._webparts.forEach(function (wp, id) {
                if (_this._instanceOfBase(wp)) {
                    cb(wp, id);
                }
            });
        }
    };
    ClientSideWebPartManager.prototype._instanceOfBase = function (wpi) {
        return wpi && (wpi instanceof core_BaseClientSideWebPart || wpi['__type'] === 'BaseClientSideWebPart');
    };
    ClientSideWebPartManager.prototype._getLoadedModuleList = function (moduleLibrary) {
        var loadedModulesString = '';
        for (var m in moduleLibrary) {
            if (moduleLibrary.hasOwnProperty(m)) {
                if (loadedModulesString) {
                    loadedModulesString += ',';
                }
                loadedModulesString += "" + m;
            }
        }
        return loadedModulesString;
    };
    ClientSideWebPartManager.prototype._startDirtyBitTimer = function (mode) {
        var _this = this;
        if (mode === sp_core_library_["DisplayMode"].Read) {
            if (this._dirtyBitTimer && sp_core_library_["Environment"].type !== sp_core_library_["EnvironmentType"].ClassicSharePoint) {
                window.clearInterval(this._dirtyBitTimer);
                this._dirtyBitTimer = undefined;
            }
        }
        else if (!this._dirtyBitTimer) {
            this._dirtyBitTimer = window.setInterval(function () {
                _this._executeForIdsOrAll(undefined, function (wp) {
                    wp._internalSetDirtyBit();
                });
            }, 1000);
        }
    };
    ClientSideWebPartManager.prototype._createSuccessExtraData = function (alias, isInternal, manifestId, moduleLoadTime, initTime, renderTime) {
        var successExtraData = {
            alias: alias,
            isInternal: isInternal,
            manifestId: manifestId,
            moduleLoadTime: moduleLoadTime,
            initTime: initTime,
            renderTime: renderTime
        };
        return successExtraData;
    };
    ClientSideWebPartManager.prototype._createUnexpectedFailureExtraData = function (alias, instanceId, isInternal, manifestId) {
        var unexpectedFailureExtraData = {
            alias: alias,
            instanceId: instanceId,
            isInternal: isInternal,
            manifestId: manifestId
        };
        return unexpectedFailureExtraData;
    };
    ClientSideWebPartManager.prototype._createLoadQosMonitor = function (manifest) {
        return new sp_diagnostics_["_QosMonitor"]("WebPart.Load", true);
    };
    ClientSideWebPartManager.prototype._createWebPartTag = function (manifest, instanceId) {
        return "WebPart." + manifest.alias + "." + instanceId;
    };
    ClientSideWebPartManager.prototype._deleteWebPart = function (id) {
        sp_core_library_["Validate"].isNotNullOrUndefined(id, 'id');
        this._propertyPaneController.onConsumerDelete(id);
        var wpi = this._webparts.get(id);
        if (wpi && this._instanceOfBase(wpi)) {
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: this._logSource,
                message: sp_core_library_["Text"].format(Strings_resx.WebpartDeleteRequested, wpi.context.webPartTag),
                serviceScope: this._host.serviceScope
            });
            this._loadWebPartRequests--;
            if (this._loadWebPartRequests < 0) {
                sp_diagnostics_["_TraceLogger"].logErrorData({
                    source: this._logSource,
                    error: new Error(Strings_resx.UnexpectedLoadRequestNegativeCount),
                    serviceScope: this._host.serviceScope
                });
            }
        }
        this._webparts.delete(id);
    };
    ClientSideWebPartManager.prototype._getManifestInstance = function (context) {
        var manifest = context.manifest;
        var manifestClone = sp_lodash_subset_["cloneDeep"](manifest);
        delete manifestClone.preconfiguredEntries;
        return manifestClone;
    };
    ClientSideWebPartManager.prototype._getArrayOrUndefined = function (instanceId) {
        return instanceId ? [instanceId] : undefined;
    };
    ClientSideWebPartManager.prototype._initialzeOnResizeEventHandler = function () {
        window.addEventListener('resize', sp_lodash_subset_["debounce"](this._onContainerResize, 1000));
        window.addEventListener('message', this._onPropertyPaneToggled);
    };
    ClientSideWebPartManager.prototype._onContainerResize = function () {
        ClientSideWebPartManager._webPartManagerList.forEach(function (wpm) {
            wpm._webparts.forEach(function (wp) { wp._internalOnAfterResize(); });
        });
    };
    ClientSideWebPartManager.prototype._onPropertyPaneToggled = function (event) {
        if (event && event.origin === window.location.origin && event.data === 'Property pane toggled') {
            this._onContainerResize();
        }
    };
    ClientSideWebPartManager.prototype._propertyPaneLifeCycleEventCallback = function (event, webpartInstanceId) {
        ClientSideWebPartManager._webPartManagerList.forEach(function (wpm) {
            if (wpm._host.propertyPaneLifeCycleEventCallback &&
                (ClientSideWebPartManager._legacyPropertyPaneController.currentlyConfiguredConsumerId &&
                    wpm._webparts.get(ClientSideWebPartManager._legacyPropertyPaneController.currentlyConfiguredConsumerId) ||
                    event === 7 )) {
                var webpart = wpm._webparts.get(webpartInstanceId);
                var webPartData = webpart ? webpart._internalSerialize() : undefined;
                wpm._host.propertyPaneLifeCycleEventCallback(event, webPartData);
            }
        });
    };
    ClientSideWebPartManager.prototype._onAllWebpartsAdded = function (context) {
        var _this = this;
        var endTime = this._getViewportRenderedEndTime();
        if (endTime) {
            window.setTimeout(function () { _this._onViewportWebpartsLoaded(context, endTime); }, 0);
        }
        else {
            window.setTimeout(function () { _this._onAllWebpartsAdded(context); }, 100);
        }
    };
    ClientSideWebPartManager.prototype._onViewportWebpartsLoaded = function (context, endTime) {
        sp_core_library_["Validate"].isNotNullOrUndefined(endTime, 'endTime');
        if (sp_core_library_["Environment"].type !== sp_core_library_["EnvironmentType"].ClassicSharePoint) {
            this._registerWebpartsInViewport();
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: this._logSource,
                message: 'All Web parts in the viewports are rendered at ' + endTime,
                serviceScope: this._host.serviceScope
            });
        }
        if (context.onViewportWebPartsRendered) {
            context.onViewportWebPartsRendered(endTime);
        }
        if (context.totalWebparts || sp_core_library_["Environment"].type === sp_core_library_["EnvironmentType"].ClassicSharePoint) {
            core_ViewportLoader.instance.loadOutsideViewPort();
        }
    };
    ClientSideWebPartManager.prototype._getViewportRenderedEndTime = function () {
        var _this = this;
        var isAllInViewportRendered = true;
        var endTime = undefined;
        var noWebPartInInitialViewport = true;
        this._webparts.forEach(function (wpi) {
            if (_this._instanceOfBase(wpi)
                && !sp_telemetry_["_PerformanceLogger"].shouldSkipComponent(wpi.context.webPartTag)
                && core_ViewportLoader.isInIntialViewport(wpi)) {
                noWebPartInInitialViewport = false;
                isAllInViewportRendered = isAllInViewportRendered ? wpi._renderedOnce : isAllInViewportRendered;
                if (isAllInViewportRendered) {
                    var curEndTime = sp_telemetry_["_PerformanceLogger"].getComponentEndTime(wpi.context.webPartTag);
                    if (curEndTime && (!endTime || curEndTime > endTime)) {
                        endTime = curEndTime;
                    }
                }
            }
        });
        if (noWebPartInInitialViewport) {
            return sp_telemetry_["_PerformanceLogger"].now();
        }
        else {
            return isAllInViewportRendered ? endTime : undefined;
        }
    };
    ClientSideWebPartManager.prototype._registerWebpartsInViewport = function () {
        var _this = this;
        var externalWebpartsInViewport = 0; 
        var internalWebpartsInViewport = 0; 
        var totalInternalWebParts = 0; 
        var totalExternalWebParts = 0; 
        this._webparts.forEach(function (wpi) {
            if (_this._instanceOfBase(wpi)) {
                wpi.context.manifest.isInternal ? totalInternalWebParts++ : totalExternalWebParts++;
                if (core_ViewportLoader.isInIntialViewport(wpi)) {
                    sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webPartsCountedInViewport);
                    sp_telemetry_["_PerformanceLogger"].addComponent(wpi.context.webPartTag);
                    wpi.context.manifest.isInternal ? internalWebpartsInViewport++ : externalWebpartsInViewport++;
                    sp_diagnostics_["_TraceLogger"].logVerboseData({
                        source: _this._logSource,
                        message: "Web part " + wpi.context.webPartTag + " is added into EUPL calculation.",
                        serviceScope: _this._host.serviceScope
                    });
                }
                else if (wpi._internalIsInViewport) {
                    sp_telemetry_["_PageMetricsLogger"].recordMetric(core_WebPartMetrics.webPartsLoadedNotInViewport);
                }
            }
        });
        var sumCount = true;
        ClientSideWebPartManager._addPerfEUPLBreakdown('totalInternalWebParts', totalInternalWebParts, sumCount);
        ClientSideWebPartManager._addPerfEUPLBreakdown('totalExternalWebParts', totalExternalWebParts, sumCount);
        ClientSideWebPartManager._addPerfEUPLBreakdown('externalWebPartsInViewport', externalWebpartsInViewport, sumCount);
        ClientSideWebPartManager._addPerfEUPLBreakdown('internalWebPartsInViewport', internalWebpartsInViewport, sumCount);
    };
    ClientSideWebPartManager.prototype._instantiateWebPart = function (moduleLibrary, webPartTag) {
        var wp = moduleLibrary; 
        if (wp && wp.default) {
            wp = wp.default;
        }
        if (!wp) {
            throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.ModuleNotLoaded, webPartTag, this._getLoadedModuleList(moduleLibrary));
        }
        if (typeof (wp) !== 'function' && wp.default) {
            wp = wp.default;
        }
        if (typeof (wp) !== 'function') {
            throw SPWebPartError_SPWebPartError.createWithLogProperties(SPWebPartErrorCode.IncorrectBoostrapModule, { actualType: typeof (wp), wp: wp }, webPartTag);
        }
        var typedWebPartClass = wp;
        var wpi = new typedWebPartClass();
        if (!wpi._internalInitialize) {
            throw SPWebPartError_SPWebPartError.createWithLogProperties(SPWebPartErrorCode.MissingExpectedWebPartMemberError, { actualType: typeof (wp), wp: wp }, webPartTag, '_internalInitialize');
        }
        return wpi;
    };
    ClientSideWebPartManager.prototype._handleErrorLoadingWebpart = function (manifest,  instanceId, domElement, ex, qosMonitor) {
        var _this = this;
        var wpi = this._webparts.get(instanceId);
        if (wpi) {
            executeWithoutFailing(function () { _this._statusRenderer.clearLoadingIndicator(domElement); }, this._logSource);
            executeWithoutFailing(function () { wpi._internalDispose(); }, this._logSource);
            executeWithoutFailing(function () { _this._webparts.delete(instanceId); }, this._logSource);
        }
        executeWithoutFailing(function () {
            var extraData = _this._createUnexpectedFailureExtraData(manifest.alias, instanceId, manifest.isInternal, manifest.id);
            qosMonitor.writeUnexpectedFailure('UnhandledLoadError', ex, extraData);
        }, this._logSource);
        this.renderError(domElement, ex);
    };
    ClientSideWebPartManager.prototype._handleModulePromiseRejection = function (manifest,  instanceId, domElement, webPartTag, error, qosMonitor) {
        var _this = this;
        executeWithoutFailing(function () {
            var extraData = _this._createUnexpectedFailureExtraData(manifest.alias, instanceId, manifest.isInternal, manifest.id);
            qosMonitor.writeUnexpectedFailure('ScriptLoad', error, extraData);
        }, this._logSource);
        this.renderError(domElement, error);
    };
    ClientSideWebPartManager.prototype._onFirstTimeWebpartRender = function (manifest,  webPartTag, qosMonitor) {
        var start = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(webPartTag + ".start");
        var moduleLoaded = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(webPartTag + ".modulesLoaded");
        var inViewportLoaded = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(webPartTag + ".inViewportLoading");
        var initialized = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(webPartTag + ".init");
        var end = sp_telemetry_["_PerformanceLogger"].readEUPLBreakdown(webPartTag + ".end");
        var extraData = this._createSuccessExtraData(manifest.alias, manifest.isInternal, manifest.id, moduleLoaded - start, initialized - inViewportLoaded, end - initialized);
        qosMonitor.writeSuccess(extraData);
        classicPages_ClassicPageUtils.removeFabricLinks();
        sp_diagnostics_["_TraceLogger"].logVerboseData({
            source: this._logSource,
            message: sp_core_library_["Text"].format(Strings_resx.ModulesLoadedForWebPart, webPartTag),
            serviceScope: this._host.serviceScope
        });
    };
    ClientSideWebPartManager.prototype._getDataUpdatedEventName = function (webPartInstanceId) {
        return "WebPart_" + webPartInstanceId + "_dataUpdated";
    };
    ClientSideWebPartManager.prototype._initializeWebPart = function (options) {
        var context = options.context, moduleLibrary = options.moduleLibrary, webPartTag = options.webPartTag, qosMonitor = options.qosMonitor;
        try {
            sp_telemetry_["_PerformanceLogger"].markComponentModuleLoaded(webPartTag);
            sp_diagnostics_["_TraceLogger"].logVerboseData({
                source: this._logSource,
                message: sp_core_library_["Text"].format(Strings_resx.ModulesLoadedForWebPart, webPartTag),
                serviceScope: this._host.serviceScope
            });
            if (!moduleLibrary) {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.ModuleUndefined, webPartTag);
            }
            var wpi = this._instantiateWebPart(moduleLibrary, webPartTag);
            wpi._internalInitialize(this._getWebPartContext(context), 
            context.addedFromPersistedData, context.displayMode);
            if (!this._instanceOfBase(wpi)) {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.NonBaseWebPart, webPartTag);
            }
            this._webparts.set(context.instanceId, wpi);
            this._registerWebPartAsPropertyPaneConsumer(context.instanceId);
            this._startDirtyBitTimer(context.displayMode);
            var webPartData = sp_lodash_subset_["cloneDeep"](context.webPartData);
            if (webPartData) {
                wpi._internalDeserialize(webPartData);
            }
        }
        catch (error) {
            this._handleErrorLoadingWebpart(context.manifest, context.instanceId, context.domElement, error, qosMonitor);
            throw error;
        }
    };
    ClientSideWebPartManager.prototype._renderWebPart = function (options) {
        var context = options.context, webPartTag = options.webPartTag, qosMonitor = options.qosMonitor, instanceRequestCount = options.instanceRequestCount;
        try {
            var wpi = this._webparts.get(context.instanceId);
            sp_load_themed_styles_["flush"]();
            var webpartFirstRenderPromise = wpi._internalFirstTimeRender(
            context.scrollableParent, qosMonitor);
            if ((sp_core_library_["Environment"].type === sp_core_library_["EnvironmentType"].ClassicSharePoint) && core_ViewportLoader.isInIntialViewport(wpi)) {
                sp_telemetry_["_PerformanceLogger"].addComponent(webPartTag);
                sp_diagnostics_["_TraceLogger"].logVerboseData({
                    source: this._logSource,
                    message: "Web part " + webPartTag + " is added into EUPL calculation.",
                    serviceScope: this._host.serviceScope
                });
            }
            if (instanceRequestCount === 1 &&
                sp_core_library_["Environment"].type === sp_core_library_["EnvironmentType"].ClassicSharePoint &&
                !this._host.isViewportLoadingDisabled) {
                this._onAllWebpartsAdded(context);
            }
            return webpartFirstRenderPromise;
        }
        catch (ex) {
            this._handleErrorLoadingWebpart(context.manifest, context.instanceId, context.domElement, ex, qosMonitor);
            return Promise.reject(ex);
        }
    };
    ClientSideWebPartManager.prototype._loadDynamicComponentDependencies = function (webPartData, webPartTag, moduleLoadPromises) {
        if (ClientSideWebPartManager._shouldLoadDynamicDependencies()
            && webPartData
            && webPartData.serverProcessedContent
            && webPartData.serverProcessedContent.componentDependencies) {
            var componentDependencies = webPartData.serverProcessedContent.componentDependencies;
            if (componentDependencies) {
                for (var compDependency in componentDependencies) {
                    if (compDependency && componentDependencies[compDependency]) {
                        var componentId = componentDependencies[compDependency];
                        if (!sp_core_library_["Guid"].tryParse(componentId)) {
                            var error = new Error("Web part (" + webPartTag + ") dynamic dependency " + componentId + " is not a valid guid");
                            sp_diagnostics_["_TraceLogger"].logErrorData({ source: this._logSource, error: error, serviceScope: this._host.serviceScope });
                        }
                        else {
                            moduleLoadPromises.push(sp_loader_["SPComponentLoader"].loadComponentById(componentId));
                            sp_diagnostics_["_TraceLogger"].logVerboseData({
                                source: this._logSource,
                                message: "Web part (" + webPartTag + ") loading dynamic dependency " + componentId + " started.",
                                serviceScope: this._host.serviceScope
                            });
                        }
                    }
                }
            }
        }
    };
    ClientSideWebPartManager.prototype._registerWebPartAsPropertyPaneConsumer = function (instanceId) {
        if (instanceId) {
            var wp = undefined;
            for (var _i = 0, _a = ClientSideWebPartManager._webPartManagerList; _i < _a.length; _i++) {
                var manager = _a[_i];
                wp = manager._webparts.get(instanceId);
                if (wp) {
                    this._propertyPaneController.registerConsumer(instanceId, wp);
                    break;
                }
            }
        }
    };
    ClientSideWebPartManager._webPartManagerList = [];
    return ClientSideWebPartManager;
}());
/* harmony default export */ var core_ClientSideWebPartManager = (ClientSideWebPartManager_ClientSideWebPartManager);

// CONCATENATED MODULE: ./lib/maintenanceMode/MaintenanceModeRenderer.js




var MaintenanceModeRenderer_MaintenanceModeRenderer = (function () {
    function MaintenanceModeRenderer() {
    }
    MaintenanceModeRenderer.render = function (context, data) {
        return __webpack_require__.e/* import() */(1).then(__webpack_require__.bind(null, 138))
            .then(function (maintenanceMode) {
            var el = external__react_["createElement"](maintenanceMode.default, { context: context, data: data });
            external__react_dom_["render"](el, context.domElement);
        });
    };
    MaintenanceModeRenderer = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], MaintenanceModeRenderer);
    return MaintenanceModeRenderer;
}());
/* harmony default export */ var maintenanceMode_MaintenanceModeRenderer = (MaintenanceModeRenderer_MaintenanceModeRenderer);

// CONCATENATED MODULE: ./lib/core/ClientSideWebPartMaintenanceModeManager.js







var ClientSideWebPartMaintenanceModeManager_ClientSideWebPartMaintenanceModeManager = (function (_super) {
    tslib_es6["c" /* __extends */](ClientSideWebPartMaintenanceModeManager, _super);
    function ClientSideWebPartMaintenanceModeManager(host) {
        var _this = _super.call(this, host) || this;
        _this._wpMaintenanceModeData = new Map();
        return _this;
    }
    ClientSideWebPartMaintenanceModeManager.prototype.loadWebPart = function (context) {
        this._loadWebPartInMaintenanceMode(context);
        this._wpMaintenanceModeData.set(context.instanceId, context.webPartData);
        return Promise.resolve();
    };
    ClientSideWebPartMaintenanceModeManager.prototype.serialize = function (instanceId) {
        return this._wpMaintenanceModeData;
    };
    ClientSideWebPartMaintenanceModeManager.prototype.dispose = function (instanceId) {
        if (instanceId) {
            this._wpMaintenanceModeData.delete(instanceId);
        }
        else {
            this._wpMaintenanceModeData = new Map();
        }
    };
    ClientSideWebPartMaintenanceModeManager.prototype._loadWebPartInMaintenanceMode = function (context) {
        var webPartContext = this._getWebPartContext(context);
        webPartContext.serviceScope.finish();
        maintenanceMode_MaintenanceModeRenderer.render(webPartContext, context.webPartData).then(function () {
            classicPages_ClassicPageUtils.disableAutomaticPostbacks(context.domElement, sp_core_library_["Environment"].type);
        });
    };
    ClientSideWebPartMaintenanceModeManager = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], ClientSideWebPartMaintenanceModeManager);
    return ClientSideWebPartMaintenanceModeManager;
}(core_ClientSideWebPartManager));
/* harmony default export */ var core_ClientSideWebPartMaintenanceModeManager = (ClientSideWebPartMaintenanceModeManager_ClientSideWebPartMaintenanceModeManager);

// CONCATENATED MODULE: ./lib/core/ClientSideWebPartManagerFactory.js




var ClientSideWebPartManagerFactory_ClientSideWebPartManagerFactory = (function () {
    function ClientSideWebPartManagerFactory() {
    }
    ClientSideWebPartManagerFactory.create = function (host) {
        if (core_ClientSideWebPartManager.isMaintenanceMode) {
            return new core_ClientSideWebPartMaintenanceModeManager(host);
        }
        else {
            return new core_ClientSideWebPartManager(host);
        }
    };
    ClientSideWebPartManagerFactory = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], ClientSideWebPartManagerFactory);
    return ClientSideWebPartManagerFactory;
}());
/* harmony default export */ var core_ClientSideWebPartManagerFactory = (ClientSideWebPartManagerFactory_ClientSideWebPartManagerFactory);

// CONCATENATED MODULE: ./lib/core/WebPartDataConverter.js






var WebPartDataConverter_WebPartDataConverter = (function () {
    function WebPartDataConverter() {
    }
    WebPartDataConverter_1 = WebPartDataConverter;
    Object.defineProperty(WebPartDataConverter, "_parsingDocument", {
        get: function () {
            if (!this._tempDoc) {
                this._tempDoc = document.implementation.createHTMLDocument('tempDocument');
            }
            return this._tempDoc;
        },
        enumerable: true,
        configurable: true
    });
    WebPartDataConverter.isWebPartHtml = function (htmlString) {
        sp_core_library_["Validate"].isNonemptyString(htmlString, 'htmlString');
        return htmlString.indexOf('<div') === 0 && htmlString.indexOf(WebPartDataConverter_1._webPartDataAttribute) !== -1;
    };
    WebPartDataConverter.convertWebPartDataToHtml = function (webpartData) {
        sp_core_library_["Validate"].isNotNullOrUndefined(webpartData, 'web part data');
        var wpdata = sp_lodash_subset_["cloneDeep"](webpartData);
        WebPartDataConverter_1._initializeIfNeeded();
        var componentIdDiv = WebPartDataConverter_1._wpComponentIdDiv.cloneNode();
        componentIdDiv.textContent = wpdata.id;
        var htmlPropsDiv = WebPartDataConverter_1._wpHtmlPropsDiv.cloneNode();
        htmlPropsDiv.innerHTML = WebPartDataConverter_1.convertServerProcessedDataToHtml(wpdata.serverProcessedContent);
        wpdata.serverProcessedContent = undefined;
        var wpHtmlDiv = WebPartDataConverter_1._wpDiv.cloneNode();
        wpHtmlDiv.setAttribute(WebPartDataConverter_1._webPartDataAttribute, JSON.stringify(wpdata));
        wpHtmlDiv.appendChild(componentIdDiv);
        wpHtmlDiv.appendChild(htmlPropsDiv);
        var wrapper = WebPartDataConverter_1._parsingDocument.createElement('div');
        wrapper.appendChild(wpHtmlDiv);
        return wrapper.innerHTML;
    };
    WebPartDataConverter.convertHtmlToWebPartData = function (htmlString, links) {
        var wpdata;
        var wrapper = WebPartDataConverter_1._parsingDocument.createElement('div');
        wrapper.innerHTML = htmlString.trim();
        var wpHtmlDiv = wrapper.children[0];
        if (wpHtmlDiv && wpHtmlDiv.hasAttribute(WebPartDataConverter_1._webPartAttribute)) {
            var wpHtmlDivWebPartAttributeData = wpHtmlDiv.getAttribute(WebPartDataConverter_1._webPartDataAttribute);
            if (wpHtmlDivWebPartAttributeData) {
                wpdata = JSON.parse(wpHtmlDivWebPartAttributeData);
            }
            if (wpdata) {
                var htmlPropsDiv = wpHtmlDiv.querySelector("[" + WebPartDataConverter_1._htmlPropertiesAttribute + "]");
                wpdata.serverProcessedContent =
                    WebPartDataConverter_1.convertServerProcessedHtmlToData(htmlPropsDiv.innerHTML, links);
            }
        }
        return wpdata || undefined;
    };
    WebPartDataConverter.convertServerProcessedDataToHtml = function (serverContent) {
        var result = '';
        if (serverContent) {
            if (serverContent.htmlStrings) {
                result += WebPartDataConverter_1._convertServerProcessedDataToHtmlByType(serverContent.htmlStrings, 1 );
            }
            if (serverContent.searchablePlainTexts) {
                result += WebPartDataConverter_1._convertServerProcessedDataToHtmlByType(serverContent.searchablePlainTexts, 4 );
            }
            if (serverContent.links) {
                result += WebPartDataConverter_1._convertServerProcessedDataToHtmlByType(serverContent.links, 2 );
            }
            if (serverContent.imageSources) {
                result += WebPartDataConverter_1._convertServerProcessedDataToHtmlByType(serverContent.imageSources, 3 );
            }
        }
        return result;
    };
    WebPartDataConverter._convertServerProcessedDataToHtmlByType = function (properties, type) {
        var result = '';
        for (var propPath in properties) {
            var value = properties[propPath];
            result += WebPartDataConverter_1._getHtmlString(propPath, type, value);
        }
        return result;
    };
    WebPartDataConverter.convertServerProcessedHtmlToData = function (htmlString, links) {
        var serverContent = {
            htmlStrings: {},
            searchablePlainTexts: {},
            links: {},
            imageSources: {}
        };
        if (!htmlString || htmlString === '') {
            return serverContent;
        }
        var tempNode = WebPartDataConverter_1._parsingDocument.createElement('DIV');
        tempNode.innerHTML = htmlString;
        var nodes = tempNode.children;
        for (var i = 0; i < nodes.length; i++) {
            var node = nodes[i];
            var key = node.getAttribute(WebPartDataConverter_1._propNameAttribute);
            if (key) {
                switch (node.tagName) {
                    case 'DIV':
                        if (node.hasAttribute(WebPartDataConverter_1._searchablePlainTextAttribute) &&
                            serverContent.searchablePlainTexts) {
                            serverContent.searchablePlainTexts[key] = node.innerText;
                        }
                        else if (serverContent.htmlStrings) {
                            serverContent.htmlStrings[key] = node.innerHTML;
                        }
                        break;
                    case 'LINK':
                    case 'A':
                        if (links) {
                            WebPartDataConverter_1._extractSPLink(node, links, serverContent, key, false);
                        }
                        else {
                            var aTagAttribute = node.getAttribute('href');
                            if (aTagAttribute && serverContent.links) {
                                serverContent.links[key] = aTagAttribute;
                            }
                        }
                        break;
                    case 'IMG':
                    case 'SPIMG':
                        if (links) {
                            WebPartDataConverter_1._extractSPLink(node, links, serverContent, key, true);
                        }
                        else {
                            var srcAttribute = node.getAttribute('src');
                            if (serverContent.imageSources && srcAttribute) {
                                serverContent.imageSources[key] = srcAttribute;
                            }
                            var hrefAttribute = node.getAttribute('href');
                            if (hrefAttribute && serverContent && serverContent.imageSources &&
                                (serverContent.imageSources[key] === undefined || serverContent.imageSources[key] === null)) {
                                serverContent.imageSources[key] = hrefAttribute;
                            }
                        }
                        break;
                }
            }
        }
        return serverContent;
    };
    WebPartDataConverter._getHtmlString = function (propName, propType, propValue) {
        var htmlPropsString = '';
        if (propName && typeof propValue === 'string' && propValue) {
            switch (propType) {
                case 1 :
                    var htmlDiv = this._parsingDocument.createElement('DIV');
                    htmlDiv.setAttribute(WebPartDataConverter_1._propNameAttribute, propName);
                    var sanitizedValue = WebPartDataConverter_1._normalizeHTML(propValue);
                    htmlDiv.innerHTML = sanitizedValue;
                    htmlPropsString = htmlDiv.outerHTML;
                    break;
                case 4 :
                    var plainTextDiv = this._parsingDocument.createElement('DIV');
                    plainTextDiv.setAttribute(WebPartDataConverter_1._propNameAttribute, propName);
                    plainTextDiv.setAttribute(WebPartDataConverter_1._searchablePlainTextAttribute, 'true');
                    plainTextDiv.innerText = propValue;
                    htmlPropsString = plainTextDiv.outerHTML;
                    break;
                case 2 :
                    var anchorDiv = this._parsingDocument.createElement('A');
                    anchorDiv.setAttribute(WebPartDataConverter_1._propNameAttribute, propName);
                    anchorDiv.setAttribute('href', propValue);
                    htmlPropsString = anchorDiv.outerHTML;
                    break;
                case 3 :
                    var imgDiv = this._parsingDocument.createElement('IMG');
                    imgDiv.setAttribute(WebPartDataConverter_1._propNameAttribute, propName);
                    imgDiv.setAttribute('src', propValue);
                    htmlPropsString = imgDiv.outerHTML;
                    break;
            }
        }
        return htmlPropsString;
    };
    WebPartDataConverter._normalizeHTML = function (htmlString) {
        if (!htmlString || htmlString === '') {
            return htmlString;
        }
        var tempDiv = WebPartDataConverter_1._parsingDocument.createElement('DIV');
        tempDiv.innerHTML =
            "<div class='child1'></div>" +
                ("<div class='main'>" + htmlString + "</div>") +
                "<div class='child3'></div>";
        var children = tempDiv.children;
        if (!children[0] || children[0].className !== 'child1' ||
            !children[1] || children[1].className !== 'main' ||
            !children[2] || children[2].className !== 'child3') {
            return '';
        }
        var mainDiv = children[1];
        var scriptTags = mainDiv.querySelectorAll('script');
        for (var i = 0; i < scriptTags.length; i++) {
            var scriptTag = scriptTags[0];
            if (scriptTag && scriptTag.parentElement) {
                scriptTag.parentElement.removeChild(scriptTag);
            }
        }
        return mainDiv.innerHTML;
    };
    WebPartDataConverter._initializeIfNeeded = function () {
        if (!WebPartDataConverter_1._wpDiv) {
            WebPartDataConverter_1._wpDiv = WebPartDataConverter_1._parsingDocument.createElement('div');
            WebPartDataConverter_1._wpDiv.setAttribute(WebPartDataConverter_1._webPartAttribute, '');
            WebPartDataConverter_1._wpDiv.setAttribute(WebPartDataConverter_1._webPartDataVersionAttribute, '1.0');
            WebPartDataConverter_1._wpComponentIdDiv = WebPartDataConverter_1._parsingDocument.createElement('div');
            WebPartDataConverter_1._wpComponentIdDiv.setAttribute(WebPartDataConverter_1._componentIdAttribute, '');
            WebPartDataConverter_1._wpHtmlPropsDiv = WebPartDataConverter_1._parsingDocument.createElement('div');
            WebPartDataConverter_1._wpHtmlPropsDiv.setAttribute(WebPartDataConverter_1._htmlPropertiesAttribute, '');
        }
    };
    WebPartDataConverter._extractSPLink = function (node, links, serverContent, key, isImage) {
        if (links.length <= 0) {
            return;
        }
        var spLinkAttribute = node.getAttribute('data-sp-splink');
        if (spLinkAttribute) {
            var result = WebPartDataConverter_1._linkPlaceHolderRegex.exec(spLinkAttribute);
            if (result) {
                var index = parseInt(result[1], 10);
                if (!isNaN(index) && !!links[index]) {
                    if (isImage && serverContent.imageSources) {
                        serverContent.imageSources[key] = links[index];
                    }
                    else if (serverContent.links) {
                        serverContent.links[key] = links[index];
                    }
                }
                else {
                    throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.InvalidSPLinkIndex, result[1]);
                }
            }
            else {
                throw SPWebPartError_SPWebPartError.create(SPWebPartErrorCode.InvalidSPLinkAttributeFormat, spLinkAttribute);
            }
        }
    };
    WebPartDataConverter._componentIdAttribute = 'data-sp-componentid';
    WebPartDataConverter._htmlPropertiesAttribute = 'data-sp-htmlproperties';
    WebPartDataConverter._propNameAttribute = 'data-sp-prop-name';
    WebPartDataConverter._searchablePlainTextAttribute = 'data-sp-searchableplaintext';
    WebPartDataConverter._webPartAttribute = 'data-sp-webpart';
    WebPartDataConverter._webPartDataAttribute = 'data-sp-webpartdata';
    WebPartDataConverter._webPartDataVersionAttribute = 'data-sp-webpartdataversion';
    WebPartDataConverter._linkPlaceHolderRegex = /^__SPLINK__(\d+)__$/;
    WebPartDataConverter = WebPartDataConverter_1 = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], WebPartDataConverter);
    return WebPartDataConverter;
    var WebPartDataConverter_1;
}());

/* harmony default export */ var core_WebPartDataConverter = (WebPartDataConverter_WebPartDataConverter);

// CONCATENATED MODULE: ./lib/core/events/ScrollEventHandler.js




var ScrollEventHandler_ScrollEventHandler = (function () {
    function ScrollEventHandler() {
        this._eventListeners = new Set();
        this._isListeningWindow = false;
        this._lazyHandler = sp_lodash_subset_["throttle"](this._scrollEventHandler, 10).bind(this);
    }
    ScrollEventHandler._findScrollableParent = function (startingElement) {
        var DATA_IS_SCROLLABLE_ATTRIBUTE = 'data-is-scrollable';
        var el = startingElement;
        var body = document.body;
        while (el && el !== body) {
            if (el.getAttribute(DATA_IS_SCROLLABLE_ATTRIBUTE) === 'true') {
                return el;
            }
            el = el.parentElement;
        }
        el = startingElement;
        while (el && el !== body) {
            var styles = getComputedStyle(el);
            if (styles) {
                var overflowY = styles.getPropertyValue('overflow-y');
                if (overflowY && (overflowY === this.SCROLL || overflowY === 'auto')) {
                    return el;
                }
            }
            el = el.parentElement;
        }
        if (!el || el === body) {
            el = undefined;
        }
        return el;
    };
    Object.defineProperty(ScrollEventHandler, "instance", {
        get: function () {
            if (ScrollEventHandler._instance === undefined) {
                ScrollEventHandler._instance = new ScrollEventHandler();
            }
            return ScrollEventHandler._instance;
        },
        enumerable: true,
        configurable: true
    });
    ScrollEventHandler.prototype.reset = function () {
        var _this = this;
        this._eventListeners.forEach(function (callback) {
            _this.unregister(_this._scrollableParents[0], callback);
        });
        this._scrollableParents = [];
        this._cachedClientRect = undefined;
    };
    ScrollEventHandler.prototype.register = function (element, callbackFunction, scrollableParent) {
        var _this = this;
        if (!this._scrollableParents || !this._scrollableParents.length) {
            this._scrollableParents =
                scrollableParent ? [scrollableParent] : this._findScrollableParents(element);
        }
        this._scrollableParents.forEach(function (parent, index, allParents) {
            var totalRegisteredCount = _this._updateRegisteredChildren(parent, 1);
            if (totalRegisteredCount === 1) {
                _this._listenEvents(parent);
            }
        });
        this._listenEvents(window);
        this._eventListeners.add(callbackFunction);
    };
    ScrollEventHandler.prototype.unregister = function (element, callbackFunction) {
        var _this = this;
        sp_core_library_["Validate"].isNotNullOrUndefined(callbackFunction, 'unregister callback function');
        if (!this._eventListeners.has(callbackFunction)) {
            return;
        }
        this._eventListeners.delete(callbackFunction);
        var parents = this._scrollableParents && this._scrollableParents.length
            ? this._scrollableParents
            : this._findScrollableParents(element);
        parents.forEach(function (parent, index, allParents) {
            var count = _this._updateRegisteredChildren(parent, -1);
            if (count <= 0) {
                _this._unlistenEvents(parent);
            }
        });
        if (this._eventListeners.size === 0) {
            this._unlistenEvents(window);
        }
    };
    ScrollEventHandler.prototype._scrollEventHandler = function (event) {
        var _this = this;
        if (!this._cachedClientRect || this._cacheExpired) {
            this._cachedClientRect = this._scrollableParents[this._scrollableParents.length - 1].getBoundingClientRect();
            this._cachedClientRectAge = Date.now();
        }
        this._eventListeners.forEach(function (listener) {
            listener(event, _this._cachedClientRect);
        });
    };
    ScrollEventHandler.prototype._findScrollableParents = function (startingElement) {
        var parents = [];
        var parent = startingElement;
        while (parent) {
            parent = ScrollEventHandler._findScrollableParent(parent);
            if (parent) {
                parents.push(parent);
                parent = parent.parentElement;
            }
        }
        return parents.length ? parents : [document.body];
    };
    ScrollEventHandler.prototype._listenEvents = function (parent) {
        if (!parent) {
            return;
        }
        var isWindow = parent === window;
        if (!isWindow || (isWindow && !this._isListeningWindow)) {
            this._addEventListener(parent);
            if (isWindow) {
                this._isListeningWindow = true;
            }
        }
    };
    ScrollEventHandler.prototype._addEventListener = function (element) {
        element.addEventListener(ScrollEventHandler.SCROLL, this._lazyHandler, false);
        element.addEventListener(ScrollEventHandler.RESIZE, this._lazyHandler, false);
    };
    ScrollEventHandler.prototype._unlistenEvents = function (parent) {
        if (!parent) {
            return;
        }
        var isWindow = parent === window;
        if (!isWindow || (isWindow && this._isListeningWindow)) {
            this._removeEventListener(parent);
            if (isWindow) {
                this._isListeningWindow = false;
            }
        }
    };
    ScrollEventHandler.prototype._removeEventListener = function (element) {
        element.removeEventListener(ScrollEventHandler.SCROLL, this._lazyHandler);
        element.removeEventListener(ScrollEventHandler.RESIZE, this._lazyHandler);
    };
    ScrollEventHandler.prototype._updateRegisteredChildren = function (scrollableParent, count) {
        var lazyChildrenCount = count + Number(scrollableParent.getAttribute(ScrollEventHandler._eventTrackerAttribute));
        if (sp_core_library_["_SPKillSwitch"].isActivated(sp_core_library_["Guid"].parse('9be11127-2aff-4a55-b297-caee84a60ad2'), '8/7/2018', 'SOX_FixRegisteredChildrenCount')) {
            if (count !== 0) {
                scrollableParent.setAttribute(ScrollEventHandler._eventTrackerAttribute, lazyChildrenCount.toString());
            }
        }
        else {
            if (lazyChildrenCount > 0) {
                scrollableParent.setAttribute(ScrollEventHandler._eventTrackerAttribute, lazyChildrenCount.toString());
            }
            else {
                scrollableParent.removeAttribute(ScrollEventHandler._eventTrackerAttribute);
            }
        }
        return lazyChildrenCount;
    };
    Object.defineProperty(ScrollEventHandler.prototype, "_cacheExpired", {
        get: function () {
            return (Date.now() - this._cachedClientRectAge >= ScrollEventHandler.CACHE_EXPIRED);
        },
        enumerable: true,
        configurable: true
    });
    ScrollEventHandler._eventTrackerAttribute = 'data-sp-webpart-event-listener';
    ScrollEventHandler.SCROLL = 'scroll';
    ScrollEventHandler.RESIZE = 'resize';
    ScrollEventHandler.CACHE_EXPIRED = 100;
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], ScrollEventHandler.prototype, "register", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], ScrollEventHandler.prototype, "_findScrollableParents", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], ScrollEventHandler.prototype, "_unlistenEvents", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], ScrollEventHandler.prototype, "_updateRegisteredChildren", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], ScrollEventHandler, "_findScrollableParent", null);
    return ScrollEventHandler;
}());
/* harmony default export */ var events_ScrollEventHandler = (ScrollEventHandler_ScrollEventHandler);

// CONCATENATED MODULE: ./lib/components/webpartForm/WebPartForm.js




var WebPartForm_WebPartForm = (function (_super) {
    tslib_es6["c" /* __extends */](WebPartForm, _super);
    function WebPartForm(props) {
        var _this = _super.call(this, props) || this;
        _this._handleKeyDown = _this._handleKeyDown.bind(_this);
        _this._handleClick = _this._handleClick.bind(_this);
        return _this;
    }
    WebPartForm.prototype.render = function () {
        var _this = this;
        var nativeProps = Object(office_ui_fabric_react_bundle_["getNativeProps"])(this.props, office_ui_fabric_react_bundle_["divProperties"]);
        return (this.props.isClassicSharePointPage
            ? (external__react_["createElement"]("div", tslib_es6["a" /* __assign */]({ ref: function (ref) { return _this._webpartDiv = ref; }, role: 'form' }, nativeProps, { onKeyDown: this._handleKeyDown, onClick: this._handleClick }), this.props.children))
            : (external__react_["createElement"]("form", tslib_es6["a" /* __assign */]({}, nativeProps), this.props.children)));
    };
    WebPartForm.prototype._handleKeyDown = function (evt) {
        if (this.props.onKeyDown) {
            this.props.onKeyDown(evt);
        }
        if (evt.keyCode === 13  && this.props.onSubmit) {
            this.props.onSubmit(evt);
        }
    };
    WebPartForm.prototype._handleClick = function (event) {
        if (this.props.onSubmit && document.activeElement === this._submitElement) {
            this.props.onSubmit(event);
        }
    };
    Object.defineProperty(WebPartForm.prototype, "_submitElement", {
        get: function () {
            return this._webpartDiv.querySelector('input[type="submit"], button:not([type="reset"]):not([type="button"]):not([type="menu"])');
        },
        enumerable: true,
        configurable: true
    });
    WebPartForm = tslib_es6["b" /* __decorate */]([
        decorators_["sealed"]
    ], WebPartForm);
    return WebPartForm;
}(external__react_["Component"]));
/* harmony default export */ var webpartForm_WebPartForm = (WebPartForm_WebPartForm);

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneCustomField/PropertyPaneCustomField.js

function PropertyPaneCustomField(properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Custom,
        targetProperty: undefined,
        properties: properties
    };
}

// EXTERNAL MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneButton/IPropertyPaneButton.js
var IPropertyPaneButton = __webpack_require__(15);

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneButton/PropertyPaneButton.js

function PropertyPaneButton(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Button,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneCheckBox/PropertyPaneCheckbox.js

function PropertyPaneCheckbox(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].CheckBox,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneChoiceGroup/PropertyPaneChoiceGroup.js

function PropertyPaneChoiceGroup(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].ChoiceGroup,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneDropdown/IPropertyPaneDropdown.js
var PropertyPaneDropdownOptionType;
(function (PropertyPaneDropdownOptionType) {
    PropertyPaneDropdownOptionType[PropertyPaneDropdownOptionType["Normal"] = 0] = "Normal";
    PropertyPaneDropdownOptionType[PropertyPaneDropdownOptionType["Divider"] = 1] = "Divider";
    PropertyPaneDropdownOptionType[PropertyPaneDropdownOptionType["Header"] = 2] = "Header";
})(PropertyPaneDropdownOptionType = PropertyPaneDropdownOptionType || (PropertyPaneDropdownOptionType = {}));

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneDropdown/PropertyPaneDropdown.js

function PropertyPaneDropdown(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Dropdown,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneDynamicField/PropertyPaneDynamicField.js

function PropertyPaneDynamicField(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].DynamicField,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneDynamicFieldSet/PropertyPaneDynamicFieldSet.js

function PropertyPaneDynamicFieldSet(properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].DynamicFieldSet,
        targetProperty: '',
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneHorizontalRule/PropertyPaneHorizontalRule.js

function PropertyPaneHorizontalRule() {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].HorizontalRule,
        targetProperty: undefined,
        properties: undefined
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneLabel/PropertyPaneLabel.js

function PropertyPaneLabel(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Label,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneLink/PropertyPaneLink.js

function PropertyPaneLink(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Link,
        targetProperty: undefined,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneSlider/PropertyPaneSlider.js

function PropertyPaneSlider(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Slider,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneTextField/PropertyPaneTextField.js

function PropertyPaneTextField(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].TextField,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneDynamicTextField/PropertyPaneDynamicTextField.js

function PropertyPaneDynamicTextField(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].DynamicTextField,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneFields/propertyPaneToggle/PropertyPaneToggle.js

function PropertyPaneToggle(targetProperty, properties) {
    return {
        type: IPropertyPaneField["a" /* PropertyPaneFieldType */].Toggle,
        targetProperty: targetProperty,
        properties: properties
    };
}

// CONCATENATED MODULE: ./lib/propertyPane/propertyPaneConsumer/BasePropertyPaneConsumer.js
var BasePropertyPaneConsumer = (function () {
    function BasePropertyPaneConsumer() {
    }
    BasePropertyPaneConsumer.prototype._isPropertyPaneReactive = function () { return true; };
    BasePropertyPaneConsumer.prototype._loadPropertyPaneResources = function () {
    };
    BasePropertyPaneConsumer.prototype._onPropertyPaneLifeCycleEvent = function (propertyPaneLifeCycleEvent) {
    };
    BasePropertyPaneConsumer.prototype._internalDispose = function () { };
    BasePropertyPaneConsumer.prototype._internalOnAfterResize = function () { };
    BasePropertyPaneConsumer.prototype._internalSerialize = function () { return undefined; };
    return BasePropertyPaneConsumer;
}());
/* harmony default export */ var propertyPaneConsumer_BasePropertyPaneConsumer = (BasePropertyPaneConsumer);

// CONCATENATED MODULE: ./lib/components/deferredComponent/DeferredComponent.js



var DeferredComponent_DeferredComponent = (function (_super) {
    tslib_es6["c" /* __extends */](DeferredComponent, _super);
    function DeferredComponent(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            component: _this.constructor._loadedComponent
        };
        return _this;
    }
    Object.defineProperty(DeferredComponent.prototype, "_shouldLoad", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    DeferredComponent.prototype.componentWillMount = function () {
        this._asyncSetState = this._setState;
        if (!this.state.component && this.constructor._loadedComponent) {
            this.setState({ component: this.constructor._loadedComponent });
        }
    };
    DeferredComponent.prototype.componentDidMount = function () {
        if (this.state.component) {
            return;
        }
        var duration = this.props.duration || 0;
        if (duration < 0) {
            return;
        }
        if (duration) {
            this._loadTimeoutId = setTimeout(this.load, this.props.duration);
        }
        else {
            this.load();
        }
    };
    DeferredComponent.prototype.componentWillUnmount = function () {
        this._asyncSetState = undefined;
    };
    DeferredComponent.prototype.componentWillReceiveProps = function (nextProps) {
        if (!this.constructor._loadPromise &&
            !this._loadTimeoutId) {
            var duration = nextProps.duration || 0;
            if (duration < 0) {
                return;
            }
            if (duration) {
                this._loadTimeoutId = setTimeout(this.load, this.props.duration);
            }
            else {
                this.load();
            }
        }
    };
    DeferredComponent.prototype.render = function () {
        if (!this.state.component) {
            return this._renderPlaceHolder();
        }
        return (external__react_["createElement"](this.state.component, tslib_es6["a" /* __assign */]({}, (this.props.deferredProps || {})), this.props.children));
    };
    DeferredComponent.prototype.load = function () {
        if (!this.constructor._loadPromise) {
            if (this._shouldLoad) {
                this.constructor._loadPromise = this._internalLoad();
                this.constructor._loadPromise.then(this._handleComponentLoaded);
            }
            else {
                this.constructor._loadPromise = Promise.reject(new Error('_shouldLoad returns false'));
            }
        }
        else {
            this.constructor._loadPromise.then(this._handleComponentLoaded);
        }
        return this.constructor._loadPromise;
    };
    DeferredComponent.prototype._renderPlaceHolder = function () {
        return false;
    };
    DeferredComponent.prototype._handleComponentLoaded = function (component) {
        var onAfterLoad = this.props.onAfterLoad;
        this.constructor._loadedComponent = component;
        if (this._asyncSetState) {
            this._asyncSetState({ component: component });
        }
        if (onAfterLoad) {
            onAfterLoad.forEach(function (fn) { return fn(); });
        }
    };
    DeferredComponent.prototype._setState = function (state) {
        this.setState(state);
    };
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], DeferredComponent.prototype, "load", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], DeferredComponent.prototype, "_handleComponentLoaded", null);
    tslib_es6["b" /* __decorate */]([
        office_ui_fabric_react_bundle_["autobind"]
    ], DeferredComponent.prototype, "_setState", null);
    return DeferredComponent;
}(external__react_["Component"]));
/* harmony default export */ var deferredComponent_DeferredComponent = (DeferredComponent_DeferredComponent);

// CONCATENATED MODULE: ./lib/index.js
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "BaseWebPartContext", function() { return core_BaseWebPartContext; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "WebPartContext", function() { return core_WebPartContext; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "WebPartIsolationLevel", function() { return WebPartIsolationLevel; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "BaseWebPart", function() { return core_BaseWebPart; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "BaseClientSideWebPart", function() { return core_BaseClientSideWebPart; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "ClientSideWebPartManager", function() { return core_ClientSideWebPartManager; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "ClientSideWebPartManagerFactory", function() { return core_ClientSideWebPartManagerFactory; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "ReservedEventNames", function() { return events_ReservedEventNames; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "WebPartDataConverter", function() { return core_WebPartDataConverter; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "EventAggregator", function() { return events_EventAggregator; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_ScrollEventHandler", function() { return events_ScrollEventHandler; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PlaceholderSpinner", function() { return placeHolder_PlaceholderSpinner; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "WebPartForm", function() { return webpartForm_WebPartForm; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_PropertyPaneController", function() { return propertyPaneController_PropertyPaneController; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneFieldType", function() { return IPropertyPaneField["a" /* PropertyPaneFieldType */]; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneCustomField", function() { return PropertyPaneCustomField; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneButtonType", function() { return IPropertyPaneButton["a" /* PropertyPaneButtonType */]; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneButton", function() { return PropertyPaneButton; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneCheckbox", function() { return PropertyPaneCheckbox; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneChoiceGroup", function() { return PropertyPaneChoiceGroup; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneDropdownOptionType", function() { return PropertyPaneDropdownOptionType; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneDropdown", function() { return PropertyPaneDropdown; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneDynamicField", function() { return PropertyPaneDynamicField; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneDynamicFieldSet", function() { return PropertyPaneDynamicFieldSet; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneHorizontalRule", function() { return PropertyPaneHorizontalRule; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneLabel", function() { return PropertyPaneLabel; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneLink", function() { return PropertyPaneLink; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneSlider", function() { return PropertyPaneSlider; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneTextField", function() { return PropertyPaneTextField; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneDynamicTextField", function() { return PropertyPaneDynamicTextField; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "PropertyPaneToggle", function() { return PropertyPaneToggle; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "BasePropertyPaneConsumer", function() { return propertyPaneConsumer_BasePropertyPaneConsumer; });
/* concated harmony reexport */__webpack_require__.d(__webpack_exports__, "_DeferredComponent", function() { return deferredComponent_DeferredComponent; });



































/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var content = __webpack_require__(18);
var loader = __webpack_require__(8);

if(typeof content === "string") content = [[module.i, content]];

// add the styles to the DOM
for (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], true);

if(content.locals) module.exports = content.locals;

/***/ }),
/* 18 */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(9)(false);
// imports


// module
exports.push([module.i, ".errorBox_f6e55647{padding:12px 0;overflow:hidden;position:relative;top:0;left:0;right:0;z-index:1;display:inline-block}[dir=ltr] .errorBox_f6e55647{text-align:left}[dir=rtl] .errorBox_f6e55647{text-align:right}.errorBoxText_f6e55647{position:relative;display:inline-block;white-space:pre-wrap;color:#666;font-weight:700}.detailsButton_f6e55647{text-transform:uppercase;color:#0078d4;border:none;background:0 0;margin-top:20px}[dir=ltr] .detailsButton_f6e55647{padding-left:0}[dir=rtl] .detailsButton_f6e55647{padding-right:0}.somethingWentWrongText_f6e55647{font-weight:400;color:#0078d4}.siteAdminText_f6e55647{font-weight:700;color:#0078d4}.screenReaderOnly_f6e55647{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}", ""]);

// exports


/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_20__;

/***/ }),
/* 21 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_21__;

/***/ }),
/* 22 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_22__;

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(24);


/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var content = __webpack_require__(25);
var loader = __webpack_require__(8);

if(typeof content === "string") content = [[module.i, content]];

// add the styles to the DOM
for (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], true);

if(content.locals) module.exports = content.locals;

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(9)(false);
// imports


// module
exports.push([module.i, ".Placeholder{display:-ms-flexbox;display:flex}.Placeholder .Placeholder-container{-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;color:\"[theme:neutralSecondary, default: #666666]\";background-color:\"[theme:neutralLighter, default: #f4f4f4]\";width:100%;padding:80px 0}.Placeholder .Placeholder-container .Placeholder-head{color:\"[theme:neutralPrimary, default: #333333]\"}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-headContainer{height:100%;white-space:nowrap;text-align:center}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-icon,.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{display:inline-block;vertical-align:middle;white-space:normal}[dir=ltr] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-left:20px}[dir=rtl] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-right:20px}.Placeholder .Placeholder-container .Placeholder-description{width:65%;vertical-align:middle;margin:0 auto;text-align:center}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText{color:\"[theme:neutralSecondary, default: #666666]\";font-size:17px;display:inline-block;margin:24px 0;font-weight:100}.Placeholder-overlay{position:relative;height:100%;z-index:1}.Placeholder-overlay .Placeholder-spinnerContainer{position:relative;width:100%;margin:164px 0}", ""]);

// exports


/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var content = __webpack_require__(27);
var loader = __webpack_require__(8);

if(typeof content === "string") content = [[module.i, content]];

// add the styles to the DOM
for (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1], true);

if(content.locals) module.exports = content.locals;

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(9)(false);
// imports


// module
exports.push([module.i, "[id^=spPropertyPaneContainer].showPane_60798c51{width:340px}[id^=spPropertyPaneContainerNoFlexbox].spPropertyPaneContainer_60798c51{position:absolute;top:50px;bottom:0;z-index:999}[dir=ltr] [id^=spPropertyPaneContainerNoFlexbox].spPropertyPaneContainer_60798c51{right:-340px}[dir=rtl] [id^=spPropertyPaneContainerNoFlexbox].spPropertyPaneContainer_60798c51{left:-340px}[dir=ltr] [id^=spPropertyPaneContainerNoFlexbox].showPane_60798c51{right:0}[dir=rtl] [id^=spPropertyPaneContainerNoFlexbox].showPane_60798c51{left:0}[dir=ltr] [id^=spPageChromeAppDiv].shrinkContent_60798c51{right:340px}[dir=rtl] [id^=spPageChromeAppDiv].shrinkContent_60798c51{left:340px}[dir=ltr] [id^=workbenchPageContent].shrinkContent_60798c51{right:340px}[dir=rtl] [id^=workbenchPageContent].shrinkContent_60798c51{left:340px}[dir=ltr] [id^=workbenchCommandBar].shrinkContent_60798c51{padding-right:340px}[dir=rtl] [id^=workbenchCommandBar].shrinkContent_60798c51{padding-left:340px}", ""]);

// exports


/***/ })
/******/ ])});;
//# sourceMappingURL=sp-webpart-base.js.map