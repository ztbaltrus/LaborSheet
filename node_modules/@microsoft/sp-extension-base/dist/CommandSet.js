var CommandSet = (function () {
    function CommandSet(serverURL) {
        this._serverURL = serverURL;
        this._listName = 'TABTestFieldCustomizerList';
        this._commandItems = [];
    }
    CommandSet.prototype.TestName = function () {
        return 'CommandSet Test';
    };
    CommandSet.prototype.TestOwner = function () {
        return 'dagaeta';
    };
    CommandSet.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    CommandSet.prototype.TestSetup = function () {
        var azurePath = TAB.Settings.Get('AzurePath');
        var loaderUrl = azurePath + "/listview-host-assembly_default.js";
        SPTaskLib.PageUtil.SetDebugManifests({ loaderUrl: loaderUrl });
        TAB.Log.Comment('CommandSet test start');
        SPTaskLib.ExtensionUtil.loadList(this._listName);
    };
    CommandSet.prototype.TestRun = function () {
        var customListPagePath = "/Lists/" + this._listName + "/AllItems.aspx";
        var customActionParams = '{"1516565a-1785-4cb4-b339-79f104f88d22":' +
            '{"location":"ClientSideExtension.ListViewCommandSet.CommandBar"}}';
        var spQueryParams = {
            loadSPFX: true,
            customActions: customActionParams,
            params: 'disableFeatures=802,851,858'
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(customListPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        TAB.AddTask(TAB.MakeTask(function () {
            SPTaskLib.Utilities.ClientFeatures.SetOverrideFeature(802, false);
            SPTaskLib.Utilities.ClientFeatures.SetOverrideFeature(851, false); 
            SPTaskLib.Utilities.ClientFeatures.SetOverrideFeature(858, false);
        }), SPTaskLib.Controls.CommandBar.WaitForCommandBar({ area: 'primary' }));
        TAB.AddTask(TAB.MakeTask(function () {
            var cb = new SPTaskLib.Controls.CommandBar({ area: 'primary' });
            cb.AddTaskEnsureCommandBarItem('Command One');
            cb.AddTaskEnsureCommandBarItem('Command Two');
        }));
        TAB.Log.AddTaskComment('Validating CommandSet items are set by the ' +
            'CommandSet extension (should be \'Command One\' and \'Command Two\').');
        SPTaskLib.Controls.CommandBar.AddItemVerificationTask({
            area: 'primary',
            expectedItems: [{ title: 'Command One' }, { title: 'Command Two' }],
            requireExactMatch: false,
            checkOverflow: true
        });
        TAB.AddTask(TAB.MakeTask(function () {
            var commandBar = new SPTaskLib.Controls.CommandBar({ area: 'primary' });
            SPTaskLib.ExtensionUtil.testCommandBarItem(commandBar.GetItemByTitle('Command One'), 'CommandOneDiv');
            SPTaskLib.ExtensionUtil.testCommandBarItem(commandBar.GetItemByTitle('Command Two'), 'CommandTwoDiv');
        }));
        TAB.Log.AddTaskPass('Test complete');
    };
    return CommandSet;
}());
TabTest = CommandSet;
