import { IDisposable } from '@microsoft/sp-core-library';
import { IDynamicDataSource } from '@microsoft/sp-dynamic-data';
import DynamicDataProvider from './DynamicDataProvider';
/**
 * Serializable object that simplifies usage of Dynamic Data.
 *
 * @remarks
 * This is built for usage in Web Part properties, and modified through the property pane.
 * Can be initialized with a default callback.
 * Web parts initialize with the render method so if the 3rd party developer does nothing, a change in the
 * dynamic data will re-render the web part automatically.
 *
 * @beta
 */
export default class DynamicProperty<TValue> implements IDisposable {
    /**
     * Constant with the type name of the Dynamic Data.
     * @internal
     */
    static readonly _TYPE_NAME: string;
    private _reference;
    private _value;
    private _hasValue;
    private _sourceId;
    private _provider;
    private _isDisposed;
    /**
     * Set to store all callback assigned in order to unregister them when the object gets disposed.
     */
    private _callbacks;
    /**
     * Default callback. Can be undefined if another callback has been set up.
     */
    private _defaultCallback;
    private _pendingCallbacks;
    private _onSourcesChanged;
    /**
     * Create a new Dynamic Property object.
     * @param provider - Dynamic Data Provider.
     * @param callback - Optional. Default callback to be registered for updates in the Dynamic Data source.
     */
    constructor(provider: DynamicDataProvider, callback?: () => void);
    /**
     * Sets a Dynamic data id in the Dynamic Data object.
     * @param reference - Id of the Dynamic Data.
     */
    setReference(reference: string): void;
    /**
     * Sets a static value in the Dynamic Data object.
     * @param value - Value for the Dynamic Data.
     */
    setValue(value: TValue): void;
    /**
     * {@inheritdoc @microsoft/sp-core-library:IDisposable.isDisposed}
     */
    readonly isDisposed: boolean;
    /**
     * {@inheritdoc @microsoft/sp-core-library:IDisposable.dispose}
     */
    dispose(): void;
    /**
     * Returns a serializable version of the object.
     * To be used when JSON.stringify() is called on the object (i.e. during Web Part serialization)
     *
     * @remarks
     * This doesn't follow the naming rule for internal methods because the JavaScript engine needs this exact name.
     *
     * @internal
     */
    toJSON(): Object;
    /**
     * DynamicDataReference string that the Dynamic Data object points to.
     * The reference is of the form \<source>:\<property>:\<path>.
     *
     * @remarks
     * If the Dynamic Data object is set up with static data, this returns undefined.
     *
     * @internalremarks
     * Above, the "\" before the "<" characters is an AEDoc escape, not part of the documentation itself.
     */
    readonly reference: string | undefined;
    /**
     * Returns the value of the Dynamic Data object, if it has a non-dynamic value.
     * Used for serialization purposes. The proper API to access the value of the object is tryGetValue()
     *
     * @internal
     */
    readonly value: TValue | undefined;
    /**
     * Returns the value of the Dynamic Data object.
     * Returns undefined if the source or the data doesn't exist.
     */
    tryGetValue(): TValue | undefined;
    /**
     * Returns the Dynamic Data Source that the Dynamic Data object refers to.
     * Returns undefined if the source doesn't exist.
     */
    tryGetSource(): IDynamicDataSource | undefined;
    /**
     * Registers a callback function for updates on the associated Dynamic Data Source.
     * @param callback - Callback function to register.
     */
    register(callback: () => void): void;
    /**
     * Unregisters a callback function for updates on the associated Dynamic Data Source.
     * The callback function must be the same it was registered with.
     * @param callback - Callback function to unregister.
     */
    unregister(callback: () => void): void;
    /**
     * Returns true if the object has a default callback.
     */
    hasDefaultCallback(): boolean;
    /**
     * Removes the registration for the default callback.
     *
     * @remarks
     * This can be useful for advanced users who only want their custom callbacks.
     */
    removeDefaultCallback(): void;
    /**
     * Returns the id of the Dynamic Data Source.
     *
     * @internal
     */
    _getSourceId(): string;
    /**
     * Returns the property name of the Dynamic Data that the object points to.
     *
     * @internal
     */
    _getProperty(): string;
    /**
     * Returns the path from the property that the object points to, if applicable.
     * If not applicable, returns an empty string.
     *
     * @internal
     */
    _getPropertyPath(): string;
    /**
     * Since the dynamic property is maintaining an instance of the DynamicDataProvider,
     * which which when serialized will result in 'Maximum call stack size exceeded' based
     * on what kind of sources they hold references to.
     *
     * For example, if the dynamicDataProvider is holding PageContext source, which internally
     * has serviceScope in its state. Deep cloning this source would result in the above mentioned
     * error.
     *
     * Hence we would want to just clone the dynamicDataProvider not deep clone it.
     *
     * @returns {*} - Custom deep Cloned version of the current instance.
     *
     * @internal
     */
    _cloneDeep(instance: DynamicProperty<any>): any;
    /**
     * Callback when the Dynamic Data sources list changes.
     * It registers the pending callbacks into the Dynamic Data source.
     */
    private _onSourcesChangedCallback();
}
