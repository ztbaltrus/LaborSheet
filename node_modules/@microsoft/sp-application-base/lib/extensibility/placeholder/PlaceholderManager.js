import { ServiceKey, Validate } from '@microsoft/sp-core-library';
import { SPEvent, SPEventArgs, _SPEventManager } from '@microsoft/sp-core-library';
import Placeholder from './Placeholder';
var PlaceholderManager = (function () {
    function PlaceholderManager(serviceScope) {
        this._isEnabled = false;
        this._changedEvent = new SPEvent(PlaceholderManager.placeholdersChangedEventName);
        this._placeholders = new Map();
    }
    Object.defineProperty(PlaceholderManager.prototype, "changedEvent", {
        get: function () {
            return this._changedEvent;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.prototype.initializePlaceholders = function (definitions) {
        var _this = this;
        Validate.isNotNullOrUndefined(definitions, 'definitions');
        definitions.forEach(function (def) { return _this.addPlaceholder(def); });
    };
    PlaceholderManager.prototype.addPlaceholder = function (definition) {
        Validate.isNotNullOrUndefined(definition, 'definition');
        var existing = this._placeholders.get(definition.name);
        var placeholder = new Placeholder(definition, this);
        this._placeholders.set(placeholder.name, placeholder);
        if (!!existing) {
            placeholder.importEntries(existing);
        }
        _SPEventManager.instance.raiseStickyEvent(PlaceholderManager.placeholdersChangedEventName, new SPEventArgs());
    };
    PlaceholderManager.prototype.removePlaceholder = function (name) {
        this._placeholders.delete(name);
        _SPEventManager.instance.raiseStickyEvent(PlaceholderManager.placeholdersChangedEventName, new SPEventArgs());
    };
    Object.defineProperty(PlaceholderManager.prototype, "isEnabled", {
        get: function () {
            return this._isEnabled;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.prototype._enable = function () {
        this._isEnabled = true;
    };
    Object.defineProperty(PlaceholderManager.prototype, "placeholders", {
        get: function () {
            return this._placeholders;
        },
        enumerable: true,
        configurable: true
    });
    PlaceholderManager.serviceKey = ServiceKey.create('sp-application-base:PlaceholderManager', PlaceholderManager);
    PlaceholderManager.placeholdersChangedEventName = 'placeholders.changedEvent';
    return PlaceholderManager;
}());
export default PlaceholderManager;
