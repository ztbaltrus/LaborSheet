{"version":3,"sources":["cli/actions/CommandLineMigrationAdvisor.ts"],"names":[],"mappings":";AAAA,4FAA4F;AAC5F,2DAA2D;;AAE3D,iCAAiC;AACjC,qCAAqC;AAErC,uDAAoD;AACpD,yDAAsD;AAEtD;IAEE,wDAAwD;IACxD,mFAAmF;IAC5E,MAAM,CAAC,SAAS,CAAC,IAAc;QACpC,4BAA4B;QAC5B,MAAM,IAAI,GAAa,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE7C,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAEpB,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,CAAC,CAAC,CAAC;gBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,wEAAwE,CAAC,CAAC;gBAC5E,MAAM,CAAC,KAAK,CAAC;YACf,CAAC;YAED,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,CAAC,CAAC,CAAC;gBAC1B,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAK,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAClE,2BAA2B,CAAC,iBAAiB,CAC3C,oEAAoE,CAAC,CAAC;oBACxE,MAAM,CAAC,KAAK,CAAC;gBACf,CAAC;gBACD,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAK,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAC7D,2BAA2B,CAAC,iBAAiB,CAC3C,gEAAgE,CAAC,CAAC;oBACpE,MAAM,CAAC,KAAK,CAAC;gBACf,CAAC;YACH,CAAC;QACH,CAAC;QAED,qBAAqB;QACrB,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAEO,MAAM,CAAC,iBAAiB,CAAC,OAAe;QAC9C,MAAM,IAAI,GAAmC,QAAQ,CAAC,IAAI,CAAC,qBAAS,CAAC,eAAe,EAAE,CAAC,CAAC;QAExF,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAC5B,oGAAoG,CACpG,CAAC,CAAC,CAAC;QACJ,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC5C,OAAO,CAAC,KAAK,EAAE,CAAC;QAChB,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,qEAAqE;cACpF,iBAAiB,6BAAa,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;IACxD,CAAC;CAEF;AA9CD,kEA8CC","file":"CommandLineMigrationAdvisor.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport * as colors from 'colors';\r\nimport * as wordwrap from 'wordwrap';\r\n\r\nimport { RushConstants } from '../../RushConstants';\r\nimport { Utilities } from '../../utilities/Utilities';\r\n\r\nexport class CommandLineMigrationAdvisor {\r\n\r\n  // NOTE: THIS RUNS BEFORE THE REAL COMMAND-LINE PARSING.\r\n  // TAKE EXTREME CARE THAT THE HEURISTICS CANNOT FALSELY MATCH A VALID COMMAND LINE.\r\n  public static checkArgv(argv: string[]): boolean {\r\n    // 0=node.exe, 1=script name\r\n    const args: string[] = process.argv.slice(2);\r\n\r\n    if (args.length > 0) {\r\n\r\n      if (args[0] === 'generate') {\r\n        CommandLineMigrationAdvisor._reportDeprecated(\r\n          'Instead of \"rush generate\", use \"rush update\" or \"rush update --full\".');\r\n        return false;\r\n      }\r\n\r\n      if (args[0] === 'install') {\r\n        if (args.indexOf('-C') >= 0  || args.indexOf('--full-clean') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install --full-clean\", use \"rush purge --unsafe\".');\r\n          return false;\r\n        }\r\n        if (args.indexOf('-c') >= 0  || args.indexOf('--clean') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install --clean\", use \"rush install --purge\".');\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Everything is okay\r\n    return true;\r\n  }\r\n\r\n  private static _reportDeprecated(message: string): void {\r\n    const wrap: (textToWrap: string) => string = wordwrap.soft(Utilities.getConsoleWidth());\r\n\r\n    console.error(colors.red(wrap(\r\n     'ERROR: You specified an outdated command-line that is no longer supported by this version of Rush:'\r\n    )));\r\n    console.error(colors.yellow(wrap(message)));\r\n    console.error();\r\n    console.error(wrap(`For command-line help, type \"rush -h\".  For migration instructions,`\r\n      + ` please visit ${RushConstants.rushWebSiteUrl}`));\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"../../../../../src"}