/// <reference types="node" />
import * as child_process from 'child_process';
export interface IEnvironment {
    [environmentVariableName: string]: string | undefined;
}
/**
 * @public
 */
export declare class Utilities {
    /**
     * Get the user's home directory. On windows this looks something like "C:\users\username\" and on UNIX
     * this looks something like "/usr/username/"
     */
    static getHomeDirectory(): string;
    /**
     * NodeJS equivalent of performance.now().
     */
    static getTimeInMs(): number;
    /**
     * Returns the values from a Set<T>
     */
    static getSetAsArray<T>(set: Set<T>): T[];
    /**
     * Retries a function until a timeout is reached. The function is expected to throw if it failed and
     *  should be retried.
     */
    static retryUntilTimeout<TResult>(fn: () => TResult, maxWaitTimeMs: number, getTimeoutError: (innerError: Error) => Error, fnName: string): TResult;
    /**
     * Creates the specified folder by calling fsx.mkdirsSync(), but using a
     * retry loop to recover from temporary locks that may be held by other processes.
     * If the folder already exists, no error occurs.
     */
    static createFolderWithRetry(folderName: string): void;
    /**
     * Determines if the path points to a file and that it exists.
     */
    static fileExists(filePath: string): boolean;
    /**
     * Determines if a path points to a directory and that it exists.
     */
    static directoryExists(directoryPath: string): boolean;
    /**
     * BE VERY CAREFUL CALLING THIS FUNCTION!
     * If you specify the wrong folderPath (e.g. "/"), it could potentially delete your entire
     * hard disk.
     */
    static dangerouslyDeletePath(folderPath: string): void;
    /**
     * Attempts to delete a file. If it does not exist, or the path is not a file, it no-ops.
     */
    static deleteFile(filePath: string): void;
    static isFileTimestampCurrent(outputFilename: string, inputFilenames: string[]): boolean;
    /**
     * Returns the width of the console, measured in columns
     */
    static getConsoleWidth(): number;
    /**
     * Executes the command with the specified command-line parameters, and waits for it to complete.
     * The current directory will be set to the specified workingDirectory.
     */
    static executeCommand(command: string, args: string[], workingDirectory: string, environment?: IEnvironment, suppressOutput?: boolean, keepEnvironment?: boolean): void;
    /**
     * Executes the command with the specified command-line parameters, and waits for it to complete.
     * The current directory will be set to the specified workingDirectory.
     */
    static executeCommandAndCaptureOutput(command: string, args: string[], workingDirectory: string, environment?: IEnvironment, keepEnvironment?: boolean): string;
    /**
     * Attempts to run Utilities.executeCommand() up to maxAttempts times before giving up.
     */
    static executeCommandWithRetry(maxAttempts: number, command: string, args: string[], workingDirectory: string, environment?: IEnvironment, suppressOutput?: boolean, retryCallback?: () => void): void;
    /**
     * Executes the command with the specified command-line parameters, and waits for it to complete.
     * The current directory will be set to the specified workingDirectory.
     */
    static executeCommandAsync(command: string, args: string[], workingDirectory: string, environment?: IEnvironment): child_process.ChildProcess;
    /**
     * Executes the command using cmd if running on windows, or using sh if running on a non-windows OS.
     * @param command - the command to run on shell
     * @param workingDirectory - working directory for running this command
     * @param initCwd = the folder containing a local .npmrc, which will be used
     *        for the INIT_CWD environment variable
     * @param environment - environment variables for running this command
     * @beta
     */
    static executeLifecycleCommand(command: string, workingDirectory: string, initCwd: string, captureOutput?: boolean): child_process.SpawnSyncReturns<Buffer>;
    /**
     * Executes the command using cmd if running on windows, or using sh if running on a non-windows OS.
     * @param command - the command to run on shell
     * @param workingDirectory - working directory for running this command
     * @param initCwd = the folder containing a local .npmrc, which will be used
     *        for the INIT_CWD environment variable
     * @param environment - environment variables for running this command
     * @beta
     */
    static executeLifecycleCommandAsync(command: string, workingDirectory: string, initCwd: string, captureOutput?: boolean): child_process.ChildProcess;
    /**
     * For strings passed to a shell command, this adds appropriate escaping
     * to avoid misinterpretation of spaces or special characters.
     *
     * Example: 'hello there' --> '"hello there"'
     */
    static escapeShellParameter(parameter: string): string;
    /**
     * Installs a package by name and version in the specified directory.
     */
    static installPackageInDirectory(directory: string, packageName: string, version: string, tempPackageTitle: string, maxInstallAttempts: number, suppressOutput?: boolean): void;
    static withFinally<T>(options: {
        promise: Promise<T>;
        finally: () => void;
    }): Promise<T>;
    /**
     * Returns a process.env environment suitable for executing lifecycle scripts.
     * @param initCwd - The INIT_CWD environment variable
     * @param initialEnvironment - an existing environment to copy instead of process.env
     */
    private static _createEnvironmentForRushCommand(initCwd, initialEnvironment?);
    /**
     * Executes the command with the specified command-line parameters, and waits for it to complete.
     * The current directory will be set to the specified workingDirectory.
     */
    private static _executeCommandInternal(command, args, workingDirectory, stdio, environment?, keepEnvironment?);
    private static _processResult(result);
}
