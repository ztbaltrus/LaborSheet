{"version":3,"file":"ExtendedPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/examples/ExtendedPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\r\nimport * as React from 'react';\r\n/* tslint:enable */\r\nimport {\r\n  BaseComponent,\r\n  assign\r\n} from 'office-ui-fabric-react/lib/Utilities';\r\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\r\nimport { ExtendedPeoplePicker } from '../PeoplePicker/ExtendedPeoplePicker';\r\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { IPersonaWithMenu } from 'office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItem.types';\r\nimport { people, mru, groupOne, groupTwo } from './PeopleExampleData';\r\nimport { SuggestionsStore, FloatingPeoplePicker, IBaseFloatingPickerProps, IBaseFloatingPickerSuggestionProps } from '../../FloatingPicker';\r\nimport { IBaseSelectedItemsListProps, ISelectedPeopleProps, SelectedPeopleList, IExtendedPersonaProps } from '../../SelectedItemsList';\r\n\r\nimport * as stylesImport from './ExtendedPeoplePicker.Basic.Example.scss';\r\n// tslint:disable-next-line:no-any\r\nconst styles: any = stylesImport;\r\n\r\nexport interface IPeoplePickerExampleState {\r\n  peopleList: IPersonaProps[];\r\n  mostRecentlyUsed: IPersonaProps[];\r\n  searchMoreAvailable: boolean;\r\n}\r\n\r\n// tslint:disable-next-line:no-any\r\nexport class ExtendedPeoplePickerTypesExample extends BaseComponent<{}, IPeoplePickerExampleState> {\r\n  private _picker: ExtendedPeoplePicker;\r\n  private _floatingPickerProps: IBaseFloatingPickerProps<IPersonaProps>;\r\n  private _selectedItemsListProps: ISelectedPeopleProps;\r\n  private _suggestionProps: IBaseFloatingPickerSuggestionProps;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n    const peopleList: IPersonaWithMenu[] = [];\r\n    people.forEach((persona: IPersonaProps) => {\r\n      const target: IPersonaWithMenu = {};\r\n\r\n      assign(target, persona);\r\n      peopleList.push(target);\r\n    });\r\n\r\n    this.state = {\r\n      peopleList: peopleList,\r\n      mostRecentlyUsed: mru,\r\n      searchMoreAvailable: true,\r\n    };\r\n\r\n    this._suggestionProps = {\r\n      headerItemsProps: [{\r\n        renderItem: () => {\r\n          return (\r\n            <div className={ styles.headerItem }>Use this address: { this._picker\r\n              && this._picker.inputElement\r\n              && this._picker.inputElement ? this._picker.inputElement.value : '' }</div>\r\n          );\r\n        },\r\n        shouldShow: () => {\r\n          return this._picker !== undefined\r\n            && this._picker.inputElement !== null\r\n            && this._picker.inputElement.value.indexOf('@') > -1;\r\n        },\r\n        onExecute: () => {\r\n          if (this._picker.floatingPicker.current !== null) {\r\n            this._picker.floatingPicker.current.forceResolveSuggestion();\r\n          }\r\n        }\r\n      },\r\n      {\r\n        renderItem: () => {\r\n          return (\r\n            <div className={ styles.headerItem }>Suggested Contacts</div>\r\n          );\r\n        },\r\n        shouldShow: this._shouldShowSuggestedContacts,\r\n      }\r\n      ],\r\n      footerItemsProps: [{\r\n        renderItem: () => {\r\n          return (\r\n            <div className={ styles.footerItem }>No results</div>\r\n          );\r\n        },\r\n        shouldShow: () => {\r\n          return this._picker !== undefined\r\n            && this._picker.floatingPicker !== undefined\r\n            && this._picker.floatingPicker.current !== null\r\n            && this._picker.floatingPicker.current.suggestions.length === 0;\r\n        }\r\n      },\r\n      {\r\n        renderItem: () => { return (<div className={ styles.footerItem }>Search for more</div>); },\r\n        onExecute: () => { this.setState({ searchMoreAvailable: false }); },\r\n        shouldShow: () => { return this.state.searchMoreAvailable && !this._shouldShowSuggestedContacts(); }\r\n      }],\r\n      shouldSelectFirstItem: () => { return !this._shouldShowSuggestedContacts(); },\r\n    };\r\n\r\n    this._floatingPickerProps = {\r\n      suggestionsStore: new SuggestionsStore<IPersonaProps>(),\r\n      onResolveSuggestions: this._onFilterChanged,\r\n      getTextFromItem: this._getTextFromItem,\r\n      pickerSuggestionsProps: this._suggestionProps,\r\n      key: 'normal',\r\n      onRemoveSuggestion: this._onRemoveSuggestion,\r\n      onValidateInput: this._validateInput,\r\n      onZeroQuerySuggestion: this._returnMostRecentlyUsed,\r\n      showForceResolve: this._shouldShowForceResolve,\r\n      onInputChanged: this._onInputChanged,\r\n      onSuggestionsHidden: () => { console.log('FLOATINGPICKER: hidden'); },\r\n      onSuggestionsShown: () => { console.log('FLOATINGPICKER: shown'); },\r\n    };\r\n\r\n    this._selectedItemsListProps = {\r\n      onCopyItems: this._onCopyItems,\r\n      onExpandGroup: this._onExpandItem,\r\n      removeMenuItemText: 'Remove',\r\n      copyMenuItemText: 'Copy name',\r\n      editMenuItemText: 'Edit',\r\n      getEditingItemText: this._getEditingItemText,\r\n      onRenderFloatingPicker: this._onRenderFloatingPicker,\r\n      floatingPickerProps: this._floatingPickerProps,\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <div>\r\n        { this._renderExtendedPicker() }\r\n        <PrimaryButton\r\n          text='Set focus'\r\n          onClick={ this._onSetFocusButtonClicked }\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _renderExtendedPicker(): JSX.Element {\r\n    return (\r\n      <ExtendedPeoplePicker\r\n        floatingPickerProps={ this._floatingPickerProps }\r\n        selectedItemsListProps={ this._selectedItemsListProps }\r\n        onRenderFloatingPicker={ this._onRenderFloatingPicker }\r\n        onRenderSelectedItems={ this._onRenderSelectedItems }\r\n        className={ 'ms-PeoplePicker' }\r\n        key={ 'normal' }\r\n        inputProps={ {\r\n          onBlur: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onBlur called'),\r\n          onFocus: (ev: React.FocusEvent<HTMLInputElement>) => console.log('onFocus called'),\r\n          'aria-label': 'People Picker'\r\n        } }\r\n        componentRef={ this._setComponentRef }\r\n        headerComponent={ this._renderHeader() }\r\n      />\r\n    );\r\n  }\r\n\r\n  private _renderHeader(): JSX.Element {\r\n    return <div>TO:</div>;\r\n  }\r\n\r\n  private _onRenderFloatingPicker(props: IBaseFloatingPickerProps<IPersonaProps>): JSX.Element {\r\n    return (<FloatingPeoplePicker { ...props } />);\r\n  }\r\n\r\n  private _onRenderSelectedItems(props: IBaseSelectedItemsListProps<IExtendedPersonaProps>): JSX.Element {\r\n    return (<SelectedPeopleList { ...props } />);\r\n  }\r\n\r\n  private _getEditingItemText(item: IExtendedPersonaProps): string {\r\n    return item.text as string;\r\n  }\r\n\r\n  private _setComponentRef = (component: ExtendedPeoplePicker): void => {\r\n    this._picker = component;\r\n  }\r\n\r\n  private _onSetFocusButtonClicked = (): void => {\r\n    if (this._picker) {\r\n      this._picker.focus();\r\n    }\r\n  }\r\n\r\n  private _onExpandItem = (item: IExtendedPersonaProps): void => {\r\n    if (this._picker.selectedItemsList.current) {\r\n      // tslint:disable-next-line:no-any\r\n      (this._picker.selectedItemsList.current as SelectedPeopleList).replaceItem(item, this._getExpandedGroupItems(item as any));\r\n    }\r\n  }\r\n\r\n  private _onRemoveSuggestion = (item: IPersonaProps): void => {\r\n    const { peopleList, mostRecentlyUsed: mruState } = this.state;\r\n    const indexPeopleList: number = peopleList.indexOf(item);\r\n    const indexMostRecentlyUsed: number = mruState.indexOf(item);\r\n\r\n    if (indexPeopleList >= 0) {\r\n      const newPeople: IPersonaProps[] = peopleList.slice(0, indexPeopleList).concat(peopleList.slice(indexPeopleList + 1));\r\n      this.setState({ peopleList: newPeople });\r\n    }\r\n\r\n    if (indexMostRecentlyUsed >= 0) {\r\n      const newSuggestedPeople: IPersonaProps[]\r\n        = mruState.slice(0, indexMostRecentlyUsed).concat(mruState.slice(indexMostRecentlyUsed + 1));\r\n      this.setState({ mostRecentlyUsed: newSuggestedPeople });\r\n    }\r\n  }\r\n\r\n  private _onFilterChanged = (filterText: string, currentPersonas: IPersonaProps[], limitResults?: number):\r\n    Promise<IPersonaProps[]> | null => {\r\n    if (filterText) {\r\n      let filteredPersonas: IPersonaProps[] = this._filterPersonasByText(filterText);\r\n\r\n      filteredPersonas = this._removeDuplicates(filteredPersonas, currentPersonas);\r\n      filteredPersonas = limitResults ? filteredPersonas.splice(0, limitResults) : filteredPersonas;\r\n      return this._convertResultsToPromise(filteredPersonas);\r\n    } else {\r\n      return this._convertResultsToPromise([]);\r\n    }\r\n  }\r\n\r\n  private _returnMostRecentlyUsed = (currentPersonas: IPersonaProps[]): IPersonaProps[] | Promise<IPersonaProps[]> => {\r\n    let { mostRecentlyUsed } = this.state;\r\n    mostRecentlyUsed = this._removeDuplicates(mostRecentlyUsed, this._picker.items);\r\n    return this._convertResultsToPromise(mostRecentlyUsed);\r\n  }\r\n\r\n  private _onCopyItems(items: IExtendedPersonaProps[]): string {\r\n    let copyText = '';\r\n    items.forEach((item: IExtendedPersonaProps, index: number) => {\r\n      copyText += item.text;\r\n\r\n      if (index < items.length - 1) {\r\n        copyText += ', ';\r\n      }\r\n    });\r\n\r\n    return copyText;\r\n  }\r\n\r\n  private _shouldShowForceResolve = (): boolean => {\r\n    return Boolean(\r\n      this._picker.floatingPicker.current &&\r\n      this._validateInput(this._picker.floatingPicker.current.inputText) &&\r\n      this._picker.floatingPicker.current.suggestions.length === 0\r\n    );\r\n  }\r\n\r\n  private _shouldShowSuggestedContacts = (): boolean => {\r\n    return this._picker !== undefined\r\n      && this._picker.inputElement !== null\r\n      && this._picker.inputElement.value === '';\r\n  }\r\n\r\n  private _listContainsPersona(persona: IPersonaProps, personas: IPersonaProps[]): boolean {\r\n    if (!personas || !personas.length || personas.length === 0) {\r\n      return false;\r\n    }\r\n    return personas.filter((item: IPersonaProps) => item.text === persona.text).length > 0;\r\n  }\r\n\r\n  private _filterPersonasByText(filterText: string): IPersonaProps[] {\r\n    return this.state.peopleList.filter((item: IPersonaProps) => this._doesTextStartWith(item.text as string, filterText));\r\n  }\r\n\r\n  private _doesTextStartWith(text: string, filterText: string): boolean {\r\n    return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\r\n  }\r\n\r\n  private _removeDuplicates(personas: IPersonaProps[], possibleDupes: IPersonaProps[]): IPersonaProps[] {\r\n    return personas.filter((persona: IPersonaProps) => !this._listContainsPersona(persona, possibleDupes));\r\n  }\r\n\r\n  private _onInputChanged = (): void => {\r\n    this.setState({ searchMoreAvailable: true });\r\n  }\r\n\r\n  private _getTextFromItem(persona: IPersonaProps): string {\r\n    return persona.text as string;\r\n  }\r\n\r\n  private _convertResultsToPromise(results: IPersonaProps[]): Promise<IPersonaProps[]> {\r\n    // tslint:disable-next-line:no-any\r\n    return new Promise<IPersonaProps[]>((resolve: any, reject: any) => setTimeout(() => resolve(results), 150));\r\n  }\r\n\r\n  private _validateInput = (input: string): boolean => {\r\n    if (input.indexOf('@') !== -1) {\r\n      return true;\r\n    } else if (input.length > 1) {\r\n      return false;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private _getExpandedGroupItems(item: IExtendedPersonaProps): IExtendedPersonaProps[] {\r\n    switch (item.text) {\r\n      case 'Group One':\r\n        return groupOne;\r\n      case 'Group Two':\r\n        return groupTwo;\r\n      default:\r\n        return [];\r\n    }\r\n  }\r\n}"]}