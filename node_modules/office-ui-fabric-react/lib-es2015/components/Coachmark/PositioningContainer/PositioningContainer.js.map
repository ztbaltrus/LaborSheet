{"version":3,"file":"PositioningContainer.js","sourceRoot":"../src/","sources":["components/Coachmark/PositioningContainer/PositioningContainer.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { IPositioningContainerTypes } from './PositioningContainer.types';\r\nimport { getClassNames } from './PositioningContainer.styles';\r\nimport { Layer } from '../../Layer';\r\n\r\n// Utilites/Helpers\r\nimport { DirectionalHint } from '../../../common/DirectionalHint';\r\nimport {\r\n  BaseComponent,\r\n  IPoint,\r\n  IRectangle,\r\n  assign,\r\n  css,\r\n  elementContains,\r\n  focusFirstChild,\r\n  getWindow,\r\n  getDocument,\r\n  createRef\r\n} from '../../../Utilities';\r\n\r\nimport {\r\n  getMaxHeight,\r\n  ICalloutPositon,\r\n  positionElement,\r\n  IPositionedData,\r\n  IPositionProps,\r\n  RectangleEdge\r\n} from '../../../utilities/positioning';\r\n\r\nimport { AnimationClassNames, mergeStyles } from '../../../Styling';\r\n\r\nconst OFF_SCREEN_STYLE = { opacity: 0 };\r\n\r\n// In order for some of the max height logic to work\r\n// properly we need to set the border.\r\n// The value is abitrary.\r\nconst BORDER_WIDTH = 1;\r\nconst SLIDE_ANIMATIONS: { [key: number]: string; } = {\r\n  [RectangleEdge.top]: 'slideUpIn20',\r\n  [RectangleEdge.bottom]: 'slideDownIn20',\r\n  [RectangleEdge.left]: 'slideLeftIn20',\r\n  [RectangleEdge.right]: 'slideRightIn20'\r\n};\r\n\r\nexport interface IPositioningContainerState {\r\n  /**\r\n   * Current set of calcualted positions for the outermost parent container.\r\n   */\r\n  positions?: IPositionedData;\r\n\r\n  /**\r\n   * Tracks the current height offset and updates during\r\n   * the height animation when props.finalHeight is specified.\r\n   */\r\n  heightOffset?: number;\r\n}\r\n\r\nexport class PositioningContainer\r\n  extends BaseComponent<IPositioningContainerTypes, IPositioningContainerState>\r\n  implements PositioningContainer {\r\n\r\n  public static defaultProps: IPositioningContainerTypes = {\r\n    preventDismissOnScroll: false,\r\n    offsetFromTarget: 0,\r\n    minPagePadding: 8,\r\n    directionalHint: DirectionalHint.bottomAutoEdge\r\n  };\r\n\r\n  private _didSetInitialFocus: boolean;\r\n\r\n  /**\r\n   * The primary positioned div.\r\n   */\r\n  private _positionedHost = createRef<HTMLDivElement>();\r\n\r\n  // @TODO rename to reflect the name of this class\r\n  private _contentHost = createRef<HTMLDivElement>();\r\n\r\n  /**\r\n   * Stores an instance of Window, used to check\r\n   * for server side rendering and if focus was lost.\r\n   */\r\n  private _targetWindow: Window;\r\n\r\n  /**\r\n   * The bounds used when determing if and where the\r\n   * PositioningContainer should be placed.\r\n   */\r\n  private _positioningBounds: IRectangle;\r\n\r\n  /**\r\n   * The maximum height the PositioningContainer can grow to\r\n   * without going being the window or target bounds\r\n   */\r\n  private _maxHeight: number | undefined;\r\n  private _positionAttempts: number;\r\n  private _target: HTMLElement | MouseEvent | IPoint | null;\r\n  private _setHeightOffsetTimer: number;\r\n\r\n  constructor(props: IPositioningContainerTypes) {\r\n    super(props);\r\n    this._didSetInitialFocus = false;\r\n    this.state = {\r\n      positions: undefined,\r\n      heightOffset: 0\r\n    };\r\n    this._positionAttempts = 0;\r\n  }\r\n\r\n  public componentWillMount(): void {\r\n    this._setTargetWindowAndElement(this._getTarget());\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    this._onComponentDidMount();\r\n  }\r\n\r\n  public componentDidUpdate(): void {\r\n    this._setInitialFocus();\r\n    this._updateAsyncPosition();\r\n  }\r\n\r\n  public componentWillUpdate(newProps: IPositioningContainerTypes): void {\r\n    // If the target element changed, find the new one. If we are tracking\r\n    // target with class name, always find element because we do not know if\r\n    // fabric has rendered a new element and disposed the old element.\r\n    const newTarget = this._getTarget(newProps);\r\n    const oldTarget = this._getTarget();\r\n    if (newTarget !== oldTarget || typeof (newTarget) === 'string' || newTarget instanceof String) {\r\n      this._maxHeight = undefined;\r\n      this._setTargetWindowAndElement(newTarget!);\r\n    }\r\n\r\n    if (newProps.offsetFromTarget !== this.props.offsetFromTarget) {\r\n      this._maxHeight = undefined;\r\n    }\r\n\r\n    if (newProps.finalHeight !== this.props.finalHeight) {\r\n      this._setHeightOffsetEveryFrame();\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element | null {\r\n    // If there is no target window then we are likely in server side rendering and we should not render anything.\r\n    if (!this._targetWindow) {\r\n      return null;\r\n    }\r\n\r\n    const {\r\n      className,\r\n      positioningContainerWidth,\r\n      positioningContainerMaxHeight,\r\n      children } = this.props;\r\n    const { positions } = this.state;\r\n\r\n    const styles = getClassNames();\r\n\r\n    const directionalClassName = (positions && positions.targetEdge)\r\n      ? (AnimationClassNames as any)[SLIDE_ANIMATIONS[positions.targetEdge]]\r\n      : '';\r\n\r\n    const getContentMaxHeight: number = this._getMaxHeight() + this.state.heightOffset!;\r\n    const contentMaxHeight: number = positioningContainerMaxHeight!\r\n      && (positioningContainerMaxHeight! > getContentMaxHeight) ? getContentMaxHeight : positioningContainerMaxHeight!;\r\n    const content = (\r\n      <div\r\n        ref={ this._positionedHost }\r\n        className={ css('ms-PositioningContainer', styles.container) }\r\n      >\r\n        <div\r\n          className={\r\n            mergeStyles(\r\n              'ms-PositioningContainer-layerHost',\r\n              styles.root,\r\n              className,\r\n              directionalClassName,\r\n              !!positioningContainerWidth && { width: positioningContainerWidth }\r\n            ) }\r\n          // tslint:disable-next-line:jsx-ban-props\r\n          style={ positions ? positions.elementPosition : OFF_SCREEN_STYLE }\r\n          tabIndex={ -1 } // Safari and Firefox on Mac OS requires this to back-stop click events so focus remains in the Callout.\r\n          // See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#Clicking_and_focus\r\n          ref={ this._contentHost }\r\n        >\r\n          { children }\r\n          { // @TODO apply to the content container\r\n            contentMaxHeight\r\n          }\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n    return this.props.doNotLayer ? content : (\r\n      <Layer>\r\n        { content }\r\n      </Layer>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Deprecated. Use onResize instead.\r\n   * @deprecated\r\n   */\r\n  public dismiss = (ev?: Event | React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>): void => {\r\n    this.onResize(ev);\r\n  }\r\n\r\n  public onResize = (ev?: Event | React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>): void => {\r\n    const { onDismiss } = this.props;\r\n    if (onDismiss) {\r\n      onDismiss(ev);\r\n    } else {\r\n      this._updateAsyncPosition();\r\n    }\r\n  }\r\n\r\n  protected _dismissOnScroll(ev: Event): void {\r\n    const { preventDismissOnScroll } = this.props;\r\n    if (this.state.positions && !preventDismissOnScroll) {\r\n      this._dismissOnLostFocus(ev);\r\n    }\r\n  }\r\n\r\n  protected _dismissOnLostFocus(ev: Event): void {\r\n    const target = ev.target as HTMLElement;\r\n    const clickedOutsideCallout = this._positionedHost.current && !elementContains(this._positionedHost.current, target);\r\n\r\n    if (\r\n      (!this._target && clickedOutsideCallout) ||\r\n      ev.target !== this._targetWindow &&\r\n      clickedOutsideCallout &&\r\n      ((this._target as MouseEvent).stopPropagation ||\r\n        (!this._target || (target !== this._target && !elementContains(this._target as HTMLElement, target))))) {\r\n      this.onResize(ev);\r\n    }\r\n  }\r\n\r\n  protected _setInitialFocus = (): void => {\r\n    if (this._contentHost.current && this.props.setInitialFocus && !this._didSetInitialFocus && this.state.positions) {\r\n      this._didSetInitialFocus = true;\r\n      focusFirstChild(this._contentHost.current);\r\n    }\r\n  }\r\n\r\n  protected _onComponentDidMount = (): void => {\r\n    // This is added so the positioningContainer will dismiss when the window is scrolled\r\n    // but not when something inside the positioningContainer is scrolled. The delay seems\r\n    // to be required to avoid React firing an async focus event in IE from\r\n    // the target changing focus quickly prior to rendering the positioningContainer.\r\n    this._async.setTimeout(() => {\r\n      this._events.on(this._targetWindow, 'scroll', this._async.throttle(this._dismissOnScroll, 10), true);\r\n      this._events.on(this._targetWindow, 'resize', this._async.throttle(this.onResize, 10), true);\r\n      this._events.on(this._targetWindow.document.body, 'focus', this._dismissOnLostFocus, true);\r\n      this._events.on(this._targetWindow.document.body, 'click', this._dismissOnLostFocus, true);\r\n    }, 0);\r\n\r\n    if (this.props.onLayerMounted) {\r\n      this.props.onLayerMounted();\r\n    }\r\n\r\n    this._updateAsyncPosition();\r\n    this._setHeightOffsetEveryFrame();\r\n  }\r\n\r\n  private _updateAsyncPosition(): void {\r\n    this._async.requestAnimationFrame(() => this._updatePosition());\r\n  }\r\n\r\n  private _updatePosition(): void {\r\n    const { positions } = this.state;\r\n    const {\r\n      offsetFromTarget,\r\n      onPositioned\r\n    } = this.props;\r\n\r\n    const hostElement = this._positionedHost.current;\r\n    const positioningContainerElement = this._contentHost.current;\r\n\r\n    if (hostElement && positioningContainerElement) {\r\n      let currentProps: IPositionProps | undefined;\r\n      currentProps = assign(currentProps, this.props);\r\n      currentProps!.bounds = this._getBounds();\r\n      currentProps!.target = this._target!;\r\n      if (document.body.contains(currentProps!.target as Node)) {\r\n        currentProps!.gapSpace = offsetFromTarget;\r\n        const newPositions: IPositionedData = positionElement(currentProps!, hostElement, positioningContainerElement);\r\n        // Set the new position only when the positions are not exists or one of the new positioningContainer positions are different.\r\n        // The position should not change if the position is within 2 decimal places.\r\n        if ((!positions && newPositions) ||\r\n          (positions && newPositions && !this._arePositionsEqual(positions, newPositions)\r\n            && this._positionAttempts < 5)) {\r\n          // We should not reposition the positioningContainer more than a few times, if it is then the content is likely resizing\r\n          // and we should stop trying to reposition to prevent a stack overflow.\r\n          this._positionAttempts++;\r\n          this.setState({\r\n            positions: newPositions\r\n          }, () => {\r\n            if (onPositioned) {\r\n              onPositioned(newPositions);\r\n            }\r\n          });\r\n        } else {\r\n          this._positionAttempts = 0;\r\n          if (onPositioned) {\r\n            onPositioned(newPositions);\r\n          }\r\n        }\r\n      } else if (positions !== undefined) {\r\n        this.setState({\r\n          positions: undefined\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  private _getBounds(): IRectangle {\r\n    if (!this._positioningBounds) {\r\n      let currentBounds = this.props.bounds;\r\n\r\n      if (!currentBounds) {\r\n        currentBounds = {\r\n          top: 0 + this.props.minPagePadding!,\r\n          left: 0 + this.props.minPagePadding!,\r\n          right: this._targetWindow.innerWidth - this.props.minPagePadding!,\r\n          bottom: this._targetWindow.innerHeight - this.props.minPagePadding!,\r\n          width: this._targetWindow.innerWidth - this.props.minPagePadding! * 2,\r\n          height: this._targetWindow.innerHeight - this.props.minPagePadding! * 2\r\n        };\r\n      }\r\n      this._positioningBounds = currentBounds;\r\n    }\r\n    return this._positioningBounds;\r\n  }\r\n\r\n  /**\r\n   * Return the maximum height the container can grow to\r\n   * without going out of the specified bounds\r\n   */\r\n  private _getMaxHeight(): number {\r\n    const {\r\n      directionalHintFixed,\r\n      offsetFromTarget,\r\n      directionalHint\r\n    } = this.props;\r\n\r\n    if (!this._maxHeight) {\r\n      if (directionalHintFixed && this._target) {\r\n        const gapSpace = offsetFromTarget ? offsetFromTarget : 0;\r\n        this._maxHeight = getMaxHeight(this._target, directionalHint!, gapSpace, this._getBounds());\r\n      } else {\r\n        this._maxHeight = this._getBounds().height! - BORDER_WIDTH * 2;\r\n      }\r\n    }\r\n    return this._maxHeight!;\r\n  }\r\n\r\n  private _arePositionsEqual(positions: IPositionedData, newPosition: IPositionedData): boolean {\r\n    return this._comparePositions(positions.elementPosition, newPosition.elementPosition);\r\n  }\r\n\r\n  private _comparePositions(oldPositions: ICalloutPositon, newPositions: ICalloutPositon): boolean {\r\n    for (const key in newPositions) {\r\n      // This needs to be checked here and below because there is a linting error if for in does not immediately have an if statement\r\n      if (newPositions.hasOwnProperty(key)) {\r\n        const oldPositionEdge = oldPositions[key];\r\n        const newPositionEdge = newPositions[key];\r\n\r\n        if (oldPositionEdge && newPositionEdge) {\r\n          if (oldPositionEdge.toFixed(2) !== newPositionEdge.toFixed(2)) {\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private _setTargetWindowAndElement(target: HTMLElement | string | MouseEvent | IPoint | null): void {\r\n    if (target) {\r\n      if (typeof target === 'string') {\r\n        const currentDoc: Document = getDocument()!;\r\n        this._target = currentDoc ? currentDoc.querySelector(target) as HTMLElement : null;\r\n        this._targetWindow = getWindow()!;\r\n      } else if ((target as MouseEvent).stopPropagation) {\r\n        this._targetWindow = getWindow((target as MouseEvent).toElement as HTMLElement)!;\r\n        this._target = target;\r\n      } else if ((target as IPoint).x !== undefined && (target as IPoint).y !== undefined) {\r\n        this._targetWindow = getWindow()!;\r\n        this._target = target;\r\n      } else {\r\n        const targetElement: HTMLElement = target as HTMLElement;\r\n        this._targetWindow = getWindow(targetElement)!;\r\n        this._target = target;\r\n      }\r\n    } else {\r\n      this._targetWindow = getWindow()!;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Animates the height if finalHeight was given.\r\n   */\r\n  private _setHeightOffsetEveryFrame(): void {\r\n    if (this._contentHost && this.props.finalHeight) {\r\n      this._setHeightOffsetTimer = this._async.requestAnimationFrame(() => {\r\n        if (!this._contentHost.current) {\r\n          return;\r\n        }\r\n\r\n        const positioningContainerMainElem = this._contentHost.current.lastChild as HTMLElement;\r\n        const cardScrollHeight: number = positioningContainerMainElem.scrollHeight;\r\n        const cardCurrHeight: number = positioningContainerMainElem.offsetHeight;\r\n        const scrollDiff: number = cardScrollHeight - cardCurrHeight;\r\n\r\n        this.setState({\r\n          heightOffset: this.state.heightOffset! + scrollDiff\r\n        });\r\n\r\n        if (positioningContainerMainElem.offsetHeight < this.props.finalHeight!) {\r\n          this._setHeightOffsetEveryFrame();\r\n        } else {\r\n          this._async.cancelAnimationFrame(this._setHeightOffsetTimer);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private _getTarget(props: IPositioningContainerTypes = this.props): HTMLElement | string | MouseEvent | IPoint | null {\r\n    const { target } = props;\r\n    return target!;\r\n  }\r\n}"]}