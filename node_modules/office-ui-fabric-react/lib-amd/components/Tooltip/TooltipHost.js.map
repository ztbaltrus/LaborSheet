{"version":3,"file":"TooltipHost.js","sourceRoot":"../src/","sources":["components/Tooltip/TooltipHost.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport {\r\n  BaseComponent,\r\n  css,\r\n  divProperties,\r\n  getNativeProps,\r\n  getId,\r\n  assign,\r\n  hasOverflow,\r\n  createRef\r\n} from '../../Utilities';\r\nimport { ITooltipHostProps, TooltipOverflowMode } from './TooltipHost.types';\r\nimport { Tooltip } from './Tooltip';\r\nimport { TooltipDelay } from './Tooltip.types';\r\n\r\nimport * as stylesImport from './TooltipHost.scss';\r\nconst styles: any = stylesImport;\r\n\r\nexport interface ITooltipHostState {\r\n  isTooltipVisible: boolean;\r\n}\r\n\r\nexport class TooltipHost extends BaseComponent<ITooltipHostProps, ITooltipHostState> {\r\n  public static defaultProps = {\r\n    delay: TooltipDelay.medium\r\n  };\r\n\r\n  // The wrapping div that gets the hover events\r\n  private _tooltipHost = createRef<HTMLDivElement>();\r\n\r\n  // The ID of the setTimeout that will eventually close the tooltip if the\r\n  // the tooltip isn't hovered over.\r\n  private _closingTimer = -1;\r\n\r\n  // Constructor\r\n  constructor(props: ITooltipHostProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isTooltipVisible: false\r\n    };\r\n  }\r\n\r\n  // Render\r\n  public render(): JSX.Element {\r\n    const {\r\n      calloutProps,\r\n      children,\r\n      content,\r\n      delay,\r\n      directionalHint,\r\n      directionalHintForRTL,\r\n      hostClassName,\r\n      id,\r\n      setAriaDescribedBy = true,\r\n      tooltipProps\r\n    } = this.props;\r\n    const { isTooltipVisible } = this.state;\r\n    const tooltipId = id || getId('tooltip');\r\n    const isContentPresent = !!(content || (tooltipProps && tooltipProps.onRenderContent && tooltipProps.onRenderContent()));\r\n    const showTooltip = isTooltipVisible && isContentPresent;\r\n\r\n    return (\r\n      <div\r\n        className={ css('ms-TooltipHost',\r\n          styles.host,\r\n          hostClassName\r\n        ) }\r\n        ref={ this._tooltipHost }\r\n        { ...{ onFocusCapture: this._onTooltipMouseEnter } }\r\n        { ...{ onBlurCapture: this._hideTooltip } }\r\n        onMouseEnter={ this._onTooltipMouseEnter }\r\n        onMouseLeave={ this._onTooltipMouseLeave }\r\n        aria-describedby={ setAriaDescribedBy && isTooltipVisible && content ? tooltipId : undefined }\r\n      >\r\n        { children }\r\n        { showTooltip && (\r\n          <Tooltip\r\n            id={ tooltipId }\r\n            delay={ delay }\r\n            content={ content }\r\n            targetElement={ this._getTargetElement() }\r\n            directionalHint={ directionalHint }\r\n            directionalHintForRTL={ directionalHintForRTL }\r\n            calloutProps={ assign({},\r\n              calloutProps, {\r\n                onMouseEnter: this._onTooltipMouseEnter,\r\n                onMouseLeave: this._onTooltipMouseLeave\r\n              }) }\r\n            onMouseEnter={ this._onTooltipMouseEnter }\r\n            onMouseLeave={ this._onTooltipMouseLeave }\r\n            { ...getNativeProps(this.props, divProperties) }\r\n            { ...tooltipProps }\r\n          />\r\n        ) }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _getTargetElement(): HTMLElement | undefined {\r\n    if (!this._tooltipHost.current) {\r\n      return undefined;\r\n    }\r\n\r\n    const { overflowMode } = this.props;\r\n\r\n    // Select target element based on overflow mode. For parent mode, you want to position the tooltip relative\r\n    // to the parent element, otherwise it might look off.\r\n    if (overflowMode !== undefined) {\r\n      switch (overflowMode) {\r\n        case TooltipOverflowMode.Parent:\r\n          return this._tooltipHost.current.parentElement!;\r\n\r\n        case TooltipOverflowMode.Self:\r\n          return this._tooltipHost.current;\r\n      }\r\n    }\r\n\r\n    return this._tooltipHost.current;\r\n  }\r\n\r\n  // Show Tooltip\r\n  private _onTooltipMouseEnter = (ev: any): void => {\r\n    const { overflowMode } = this.props;\r\n\r\n    if (overflowMode !== undefined) {\r\n      const overflowElement = this._getTargetElement();\r\n      if (overflowElement && !hasOverflow(overflowElement)) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    this._toggleTooltip(true);\r\n    this._clearDismissTimer();\r\n  }\r\n\r\n  // Hide Tooltip\r\n  private _onTooltipMouseLeave = (ev: any): void => {\r\n    if (this.props.closeDelay) {\r\n      this._clearDismissTimer();\r\n\r\n      this._closingTimer = this._async.setTimeout(() => {\r\n        this._toggleTooltip(false);\r\n      }, this.props.closeDelay);\r\n    } else {\r\n      this._toggleTooltip(false);\r\n    }\r\n  }\r\n\r\n  private _clearDismissTimer = (): void => {\r\n    this._async.clearTimeout(this._closingTimer);\r\n  }\r\n\r\n  // Hide Tooltip\r\n  private _hideTooltip = (): void => {\r\n    this._toggleTooltip(false);\r\n  }\r\n\r\n  private _toggleTooltip(isTooltipVisible: boolean): void {\r\n    if (this.state.isTooltipVisible !== isTooltipVisible) {\r\n      this.setState(\r\n        { isTooltipVisible },\r\n        () => this.props.onTooltipToggle &&\r\n          this.props.onTooltipToggle(this.state.isTooltipVisible));\r\n    }\r\n  }\r\n}\r\n"]}