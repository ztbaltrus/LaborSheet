{"version":3,"file":"SelectedPeopleList.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/SelectedPeopleList.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\r\nimport * as React from 'react';\r\n/* tslint:enable */\r\nimport { BaseSelectedItemsList } from '../BaseSelectedItemsList';\r\nimport { IBaseSelectedItemsListProps, ISelectedItemProps } from '../BaseSelectedItemsList.types';\r\nimport { IPersonaProps } from '../../../Persona';\r\nimport { ExtendedSelectedItem } from './Items/ExtendedSelectedItem';\r\nimport { SelectedItemWithContextMenu } from './Items/SelectedItemWithContextMenu';\r\nimport { IRenderFunction } from '../../../Utilities';\r\nimport { IContextualMenuItem } from '../../../ContextualMenu';\r\nimport { IBaseFloatingPickerProps } from '../../../FloatingPicker';\r\nimport { EditingItem } from './Items/EditingItem';\r\n\r\nexport interface IExtendedPersonaProps extends IPersonaProps {\r\n  isValid: boolean;\r\n  blockRecipientRemoval?: boolean;\r\n  shouldBlockSelection?: boolean;\r\n  canExpand?: boolean;\r\n  isEditing?: boolean;\r\n}\r\n\r\nexport interface ISelectedPeopleItemProps extends ISelectedItemProps<IExtendedPersonaProps> {\r\n  onExpandItem?: () => void;\r\n  renderPersonaCoin?: IRenderFunction<IPersonaProps>;\r\n  renderPrimaryText?: IRenderFunction<IPersonaProps>;\r\n}\r\n\r\nexport interface ISelectedPeopleProps extends IBaseSelectedItemsListProps<IExtendedPersonaProps> {\r\n  onExpandGroup?: (item: IExtendedPersonaProps) => void;\r\n  removeMenuItemText?: string;\r\n  copyMenuItemText?: string;\r\n  editMenuItemText?: string;\r\n  getEditingItemText?: (item: IExtendedPersonaProps) => string;\r\n  onRenderFloatingPicker?: (props: IBaseFloatingPickerProps<IPersonaProps>) => JSX.Element;\r\n  floatingPickerProps?: IBaseFloatingPickerProps<IPersonaProps>;\r\n}\r\n\r\nexport class BasePeopleSelectedItemsList extends BaseSelectedItemsList<IExtendedPersonaProps, ISelectedPeopleProps> {\r\n}\r\n\r\n/**\r\n * Standard People Picker.\r\n */\r\nexport class SelectedPeopleList extends BasePeopleSelectedItemsList {\r\n\r\n  // tslint:disable-next-line:no-any\r\n  public static defaultProps: any = {\r\n    onRenderItem: (props: ISelectedPeopleItemProps) => <ExtendedSelectedItem { ...props } />,\r\n  };\r\n\r\n  public replaceItem = (itemToReplace: IExtendedPersonaProps, itemsToReplaceWith: IExtendedPersonaProps[]): void => {\r\n    const { items } = this.state;\r\n    const index: number = items.indexOf(itemToReplace);\r\n    if (index > -1) {\r\n      const newItems = items.slice(0, index).concat(itemsToReplaceWith).concat(items.slice(index + 1));\r\n      this.updateItems(newItems);\r\n    }\r\n  }\r\n\r\n  protected renderItems = (): JSX.Element[] => {\r\n    const { items } = this.state;\r\n    // tslint:disable-next-line:no-any\r\n    return items.map((item: any, index: number) => this._renderItem(item, index));\r\n  }\r\n\r\n  // tslint:disable-next-line:no-any\r\n  private _renderItem(item: any, index: number): JSX.Element {\r\n    const { removeButtonAriaLabel } = this.props;\r\n    const props = {\r\n      item,\r\n      index,\r\n      key: item.key ? item.key : index,\r\n      selected: this.selection.isIndexSelected(index),\r\n      onRemoveItem: () => this.removeItem(item),\r\n      onItemChange: this.onItemChange,\r\n      removeButtonAriaLabel: removeButtonAriaLabel,\r\n      onCopyItem: (itemToCopy: IExtendedPersonaProps) => this.copyItems([itemToCopy]),\r\n      onExpandItem: this.props.onExpandGroup ? () => (this.props.onExpandGroup as (item: IExtendedPersonaProps) => void)(item) : undefined,\r\n      menuItems: this._createMenuItems(item),\r\n    };\r\n\r\n    if ((item as IExtendedPersonaProps).isEditing) {\r\n      return (\r\n        <EditingItem\r\n          { ...props }\r\n          onRenderFloatingPicker={ this.props.onRenderFloatingPicker }\r\n          floatingPickerProps={ this.props.floatingPickerProps }\r\n          onEditingComplete={ this._completeEditing }\r\n          getEditingItemText={ this.props.getEditingItemText }\r\n        />\r\n      );\r\n    } else {\r\n      const onRenderItem = this.props.onRenderItem as (props: ISelectedPeopleItemProps) => JSX.Element;\r\n      const renderedItem = onRenderItem(props);\r\n      return (\r\n        props.menuItems.length > 0 ?\r\n          (\r\n            <SelectedItemWithContextMenu\r\n              renderedItem={ renderedItem }\r\n              beginEditing={ this._beginEditing }\r\n              menuItems={ this._createMenuItems(props.item) }\r\n              item={ props.item }\r\n            />\r\n          )\r\n          : renderedItem\r\n      );\r\n    }\r\n  }\r\n\r\n  private _beginEditing = (item: IExtendedPersonaProps): void => {\r\n    item.isEditing = true;\r\n    this.forceUpdate();\r\n  }\r\n\r\n  // tslint:disable-next-line:no-any\r\n  private _completeEditing = (oldItem: any, newItem: any): void => {\r\n    oldItem.isEditing = false;\r\n    this.replaceItem(oldItem, newItem);\r\n  }\r\n\r\n  // tslint:disable-next-line:no-any\r\n  private _createMenuItems(item: any): IContextualMenuItem[] {\r\n    const menuItems: IContextualMenuItem[] = [];\r\n\r\n    if (this.props.editMenuItemText && this.props.getEditingItemText) {\r\n      menuItems.push({\r\n        key: 'Edit',\r\n        name: this.props.editMenuItemText,\r\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\r\n          this._beginEditing(menuItem.data);\r\n        },\r\n        data: item,\r\n      });\r\n    }\r\n\r\n    if (this.props.removeMenuItemText) {\r\n      menuItems.push(\r\n        {\r\n          key: 'Remove',\r\n          name: this.props.removeMenuItemText,\r\n          onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\r\n            this.removeItem(menuItem.data as ISelectedItemProps<IExtendedPersonaProps>);\r\n          },\r\n          data: item,\r\n        });\r\n    }\r\n\r\n    if (this.props.copyMenuItemText) {\r\n      menuItems.push({\r\n        key: 'Copy',\r\n        name: this.props.copyMenuItemText,\r\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\r\n          if (this.props.onCopyItems) {\r\n            (this.copyItems as (items: IExtendedPersonaProps[]) => void)([menuItem.data] as IExtendedPersonaProps[]);\r\n          }\r\n        },\r\n        data: item,\r\n      });\r\n    }\r\n\r\n    return menuItems;\r\n  }\r\n}"]}